<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>悲伤的橘子树</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="不相信自己的人没有努力的价值。   -- 迈特凯">
<meta name="keywords" content="悲伤的橘子树">
<meta property="og:type" content="website">
<meta property="og:title" content="悲伤的橘子树">
<meta property="og:url" content="http://fankekeke.club/page/5/index.html">
<meta property="og:site_name" content="悲伤的橘子树">
<meta property="og:description" content="不相信自己的人没有努力的价值。   -- 迈特凯">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="悲伤的橘子树">
<meta name="twitter:description" content="不相信自己的人没有努力的价值。   -- 迈特凯">
  
    <link rel="alternate" href="/atom.xml" title="悲伤的橘子树" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">悲伤的橘子树</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://fankekeke.club"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-SSH框架搭建" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/24/SSH框架搭建/" class="article-date">
  <time datetime="2018-11-24T01:01:49.000Z" itemprop="datePublished">2018-11-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SSH/">SSH</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/24/SSH框架搭建/">SSH框架搭建</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>SSH架构</p>
<blockquote>
<ul>
<li>Struts2 + Spring + Hibernate<br>以Spring作为框架核心，数据持久化使用Hibernate完成，表现层使用Struts2</li>
<li>Spring提供对象管理，面向切面等使用功能</li>
<li>通过Spring提供的服务简化编码，降低开发难度，提高开发效率</li>
</ul>
</blockquote>
</blockquote>
<h3 id="ssh框架搭建"><a href="#ssh框架搭建" class="headerlink" title="ssh框架搭建"></a>ssh框架搭建</h3><blockquote>
<ul>
<li>添加所需的jar文件</li>
<li>在Spring中配置数据源和会话工厂</li>
<li>实现并配置dao</li>
<li>实现并配置service</li>
<li>为业务层添加事务管理</li>
<li>实现并配置action</li>
<li>创建jsp测试页面</li>
</ul>
</blockquote>
<h3 id="pojo持久化类的映射"><a href="#pojo持久化类的映射" class="headerlink" title="pojo持久化类的映射"></a>pojo持久化类的映射</h3><blockquote>
<p>略</p>
</blockquote>
<hr>
<h3 id="一个普通的log4j文件"><a href="#一个普通的log4j文件" class="headerlink" title="一个普通的log4j文件"></a>一个普通的log4j文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Log4J Settings for log4j 1.2.x (via jakarta-commons-logging)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The five logging levels used by Log are (in order):</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   1. DEBUG (the least serious)</span></span><br><span class="line"><span class="comment">#   2. INFO</span></span><br><span class="line"><span class="comment">#   3. WARN</span></span><br><span class="line"><span class="comment">#   4. ERROR</span></span><br><span class="line"><span class="comment">#   5. FATAL (the most serious)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set root logger level to WARN and append to stdout</span></span><br><span class="line">log4j.rootLogger=DEBUG, stdout</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.Target=System.out</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pattern to output the caller's file name and line number.</span></span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%d %5p (%c:%L) - %m%n</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print only messages of level ERROR or above in the package noModule.</span></span><br><span class="line">log4j.logger.noModule=FATAL</span><br><span class="line"></span><br><span class="line">log4j.logger.com.opensymphony.xwork2=ERROR</span><br><span class="line">log4j.logger.org.apache.struts2=ERROR</span><br><span class="line">log4j.logger.freemarker=ERROR</span><br><span class="line"></span><br><span class="line"><span class="comment">### log HQL query parser activity</span></span><br><span class="line"><span class="comment">#log4j.logger.org.hibernate.hql.ast.AST=debug</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### log just the SQL</span></span><br><span class="line"><span class="comment">#log4j.logger.org.hibernate.SQL=debug</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### log JDBC bind parameters ###</span></span><br><span class="line"><span class="comment">#log4j.logger.org.hibernate.type=info</span></span><br><span class="line"><span class="comment">#log4j.logger.org.hibernate.type=debug</span></span><br><span class="line">log4j.logger.org.hibernate.type.descriptor.sql.BasicBinder=TRACE</span><br></pre></td></tr></table></figure>
<h3 id="hibernate-cfg-xml"><a href="#hibernate-cfg-xml" class="headerlink" title="hibernate.cfg.xml"></a>hibernate.cfg.xml</h3><blockquote>
<p><strong>此文件可以在Spring文件中集中配置</strong></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE hibernate-configuration PUBLIC</span><br><span class="line">	<span class="string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span><br><span class="line">	<span class="string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;hibernate-configuration&gt;</span><br><span class="line">	&lt;session-factory&gt;</span><br><span class="line">		&lt;!-- 数据库连接 --&gt;</span><br><span class="line">		&lt;property name=<span class="string">"connection.driver_class"</span>&gt;</span><br><span class="line">			oracle.jdbc.OracleDriver</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"connection.url"</span>&gt;</span><br><span class="line">			jdbc:oracle:thin:@localhost:1521:orcl</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"connection.username"</span>&gt;martin&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"connection.password"</span>&gt;mpwd&lt;/property&gt;</span><br><span class="line">		&lt;!-- 辅助参数 --&gt;</span><br><span class="line">		&lt;!-- &lt;property name=<span class="string">"show_sql"</span>&gt;<span class="literal">true</span>&lt;/property&gt; --&gt;</span><br><span class="line">		&lt;property name=<span class="string">"format_sql"</span>&gt;<span class="literal">true</span>&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"dialect"</span>&gt;</span><br><span class="line">			org.hibernate.dialect.Oracle10gDialect</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"current_session_context_class"</span>&gt;thread&lt;/property&gt;</span><br><span class="line">		&lt;!-- 映射信息 --&gt;</span><br><span class="line">		&lt;mapping resource=<span class="string">"cn/hate/pojo/CusCustomer.hbm.xml"</span> /&gt;</span><br><span class="line">		&lt;mapping resource=<span class="string">"cn/hate/pojo/SaleOrderLine.hbm.xml"</span> /&gt;</span><br><span class="line">		&lt;mapping resource=<span class="string">"cn/hate/pojo/SaleOrder.hbm.xml"</span> /&gt;</span><br><span class="line">		&lt;mapping resource=<span class="string">"cn/hate/pojo/SaleProduct.hbm.xml"</span> /&gt;</span><br><span class="line">	&lt;/session-factory&gt;</span><br><span class="line">&lt;/hibernate-configuration&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Dao层"><a href="#Dao层" class="headerlink" title="Dao层"></a>Dao层</h3><blockquote>
<p><strong>通过继承HibernateDaoSupport类来继续setter注入sessionFactory</strong></p>
</blockquote>
<hr>
<blockquote>
<p>使用Spring模板能简化编码过程，并不在依赖hibernate session，直接使用hibernate session 需要使用HibernateCallback接口</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">package cn.hate.dao.impl;</span><br><span class="line"></span><br><span class="line">import java.io.Serializable;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.hibernate.HibernateException;</span><br><span class="line">import org.hibernate.Query;</span><br><span class="line">import org.hibernate.Session;</span><br><span class="line">import org.hibernate.Transaction;</span><br><span class="line">import org.springframework.orm.hibernate3.HibernateCallback;</span><br><span class="line">import org.springframework.orm.hibernate3.support.HibernateDaoSupport;</span><br><span class="line"></span><br><span class="line">import cn.hate.dao.commonDao;</span><br><span class="line">import cn.hate.pojo.SaleOrder;</span><br><span class="line">import cn.hate.pojo.SaleOrderLine;</span><br><span class="line">public class commonDaoImpl extends HibernateDaoSupport implements commonDao &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	/**</span><br><span class="line">	 * 根据主键获取一条数据</span><br><span class="line">	 */</span><br><span class="line">	public Object get(Class clazz, Serializable id) &#123; </span><br><span class="line">		Object ret=super.getHibernateTemplate().get(clazz, id);</span><br><span class="line">		<span class="built_in">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	/**</span><br><span class="line">	 * 添加数据</span><br><span class="line">	 */</span><br><span class="line">	public Serializable add(Object o) &#123;</span><br><span class="line">		Serializable ret = super.getHibernateTemplate().save(o);</span><br><span class="line">		<span class="built_in">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	/**</span><br><span class="line">	 * 删除数据</span><br><span class="line">	 */</span><br><span class="line">	public void delete(Class clazz, Serializable id) &#123;</span><br><span class="line">		super.getHibernateTemplate().delete(this.get(clazz, id));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	/**</span><br><span class="line">	 * 更新数据</span><br><span class="line">	 */</span><br><span class="line">	public void update(Object o) &#123;</span><br><span class="line">		super.getHibernateTemplate().update(o);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	/**</span><br><span class="line">	 * 查找数据</span><br><span class="line">	 */</span><br><span class="line">	public List find(String hql) &#123;</span><br><span class="line">		List ret = super.getHibernateTemplate().find(hql);</span><br><span class="line">		<span class="built_in">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	/**</span><br><span class="line">	 * 分页查询</span><br><span class="line">	 */</span><br><span class="line">	public List findFenYe(final int pageNo, final int pageSize) &#123;</span><br><span class="line">		<span class="built_in">return</span> this.getHibernateTemplate().execute(new HibernateCallback&lt;List&gt;() &#123;</span><br><span class="line"></span><br><span class="line">			@Override</span><br><span class="line">			public List doInHibernate(Session session) throws HibernateException, SQLException &#123;</span><br><span class="line">				Query query=session.createQuery(<span class="string">"select o from SaleOrder o"</span>);</span><br><span class="line">				query.setFirstResult((pageNo-1)*pageSize);</span><br><span class="line">				query.setMaxResults(pageSize);</span><br><span class="line">				<span class="built_in">return</span> query.list();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void addOrderLine(int id, SaleOrderLine saleOrderLine) &#123;</span><br><span class="line">			SaleOrder saleOrder=(SaleOrder) this.get(SaleOrder.class, id);</span><br><span class="line">			saleOrder.getSaleOrderLines().add(saleOrderLine);</span><br><span class="line">			saleOrderLine.setSaleOrder(saleOrder);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="applicationContext-xml"><a href="#applicationContext-xml" class="headerlink" title="applicationContext.xml"></a>applicationContext.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">"http://www.springframework.org/schema/beans"</span></span><br><span class="line">	xmlns:aop=<span class="string">"http://www.springframework.org/schema/aop"</span> xmlns:context=<span class="string">"http://www.springframework.org/schema/context"</span></span><br><span class="line">	xmlns:tx=<span class="string">"http://www.springframework.org/schema/tx"</span> xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">	xsi:schemaLocation=<span class="string">"http://www.springframework.org/schema/beans </span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/beans/spring-beans-3.2.xsd </span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/aop </span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/aop/spring-aop-3.2.xsd </span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/context </span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/context/spring-context-3.2.xsd </span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/tx </span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/tx/spring-tx-3.2.xsd "</span>&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;!-- 扫描注解 --&gt;</span><br><span class="line">	&lt;!-- &lt;context:component-scan base-package=<span class="string">"cn.hate"</span>&gt;&lt;/context:component-scan&gt; --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 由spring配置文件进行集中配置 --&gt;</span><br><span class="line">	&lt;bean id=<span class="string">"dataSource"</span> class=<span class="string">"org.apache.commons.dbcp.BasicDataSource"</span>&gt;</span><br><span class="line">		&lt;!-- 数据库连接 --&gt;</span><br><span class="line">		&lt;property name=<span class="string">"driverClassName"</span> value=<span class="string">"oracle.jdbc.driver.OracleDriver"</span>&gt;&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"url"</span> value=<span class="string">"jdbc:oracle:thin:@localhost:1521:orcl"</span>&gt;&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"username"</span> value=<span class="string">"martin"</span>&gt;&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"password"</span> value=<span class="string">"mpwd"</span>&gt;&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- 定义独立的hibernate配置文件，由Spring导入并创建会话工厂Bean --&gt;</span><br><span class="line">	&lt;bean id=<span class="string">"sessionFactory"</span></span><br><span class="line">		class=<span class="string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span>&gt;</span><br><span class="line">		&lt;!-- spring集中配置 --&gt;</span><br><span class="line">		&lt;property name=<span class="string">"dataSource"</span> ref=<span class="string">"dataSource"</span>&gt;&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"hibernateProperties"</span>&gt;</span><br><span class="line">			&lt;props&gt;</span><br><span class="line">				&lt;prop key=<span class="string">"hibernate.dialect"</span>&gt;org.hibernate.dialect.Oracle10gDialect&lt;/prop&gt;</span><br><span class="line">				&lt;prop key=<span class="string">"show_sql"</span>&gt;<span class="literal">true</span>&lt;/prop&gt;</span><br><span class="line">				&lt;prop key=<span class="string">"format_sql"</span>&gt;<span class="literal">true</span>&lt;/prop&gt;</span><br><span class="line">				&lt;prop key=<span class="string">"javax.persistence.validation.mode"</span>&gt;none&lt;/prop&gt;</span><br><span class="line">			&lt;/props&gt;</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"mappingResources"</span>&gt;</span><br><span class="line">			&lt;list&gt;</span><br><span class="line">				&lt;value&gt;cn/hate/pojo/CusCustomer.hbm.xml&lt;/value&gt;</span><br><span class="line">				&lt;value&gt;cn/hate/pojo/SaleOrder.hbm.xml&lt;/value&gt;</span><br><span class="line">				&lt;value&gt;cn/hate/pojo/SaleOrderLine.hbm.xml&lt;/value&gt;</span><br><span class="line">				&lt;value&gt;cn/hate/pojo/SaleProduct.hbm.xml&lt;/value&gt;</span><br><span class="line">			&lt;/list&gt;</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">		&lt;!-- 创建hibernate配置文件 --&gt;</span><br><span class="line">		&lt;!-- &lt;property name=<span class="string">"configLocation"</span>&gt; &lt;value&gt; classpath:hibernate.cfg.xml </span><br><span class="line">			&lt;/value&gt; &lt;/property&gt; --&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;!-- 注解 --&gt;</span><br><span class="line">	&lt;!-- &lt;bean id=<span class="string">"sessionFactory"</span></span><br><span class="line">		class=<span class="string">"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean"</span>&gt;</span><br><span class="line">		spring集中配置</span><br><span class="line">		&lt;property name=<span class="string">"dataSource"</span> ref=<span class="string">"dataSource"</span>&gt;&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"hibernateProperties"</span>&gt;</span><br><span class="line">			&lt;props&gt;</span><br><span class="line">				&lt;prop key=<span class="string">"hibernate.dialect"</span>&gt;org.hibernate.dialect.Oracle10gDialect&lt;/prop&gt;</span><br><span class="line">				&lt;prop key=<span class="string">"show_sql"</span>&gt;<span class="literal">true</span>&lt;/prop&gt;</span><br><span class="line">				&lt;prop key=<span class="string">"format_sql"</span>&gt;<span class="literal">true</span>&lt;/prop&gt;</span><br><span class="line">				&lt;prop key=<span class="string">"javax.persistence.validation.mode"</span>&gt;none&lt;/prop&gt;</span><br><span class="line">			&lt;/props&gt;</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;property name=<span class="string">"packagesToScan"</span> value=<span class="string">"cn.hate.pojo"</span>&gt;&lt;/property&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/bean&gt; --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- commonDao --&gt;</span><br><span class="line">	&lt;bean id=<span class="string">"commonDao"</span> class=<span class="string">"cn.hate.dao.impl.commonDaoImpl"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"sessionFactory"</span> ref=<span class="string">"sessionFactory"</span>&gt;&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;!-- orderService --&gt;</span><br><span class="line">	&lt;bean id=<span class="string">"orderService"</span> class=<span class="string">"cn.hate.service.impl.orderServiceImpl"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"comDao"</span> ref=<span class="string">"commonDao"</span>&gt;&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;!-- Action --&gt;	</span><br><span class="line">	&lt;bean id=<span class="string">"cusAction"</span> class=<span class="string">"cn.hate.action.CusCustomerAction"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"oService"</span> ref=<span class="string">"orderService"</span>&gt;&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	&lt;!-- 事务管理器 --&gt;</span><br><span class="line">	&lt;bean id=<span class="string">"txManager"</span> class=<span class="string">"org.springframework.orm.hibernate3.HibernateTransactionManager"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"sessionFactory"</span> ref=<span class="string">"sessionFactory"</span>&gt;&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	&lt;!-- 事务增强 --&gt;</span><br><span class="line">	&lt;tx:advice id=<span class="string">"txAdvice"</span> transaction-manager=<span class="string">"txManager"</span>&gt;</span><br><span class="line">		&lt;tx:attributes&gt;</span><br><span class="line">			&lt;tx:method name=<span class="string">"find*"</span> propagation=<span class="string">"SUPPORTS"</span> <span class="built_in">read</span>-only=<span class="string">"true"</span> /&gt;</span><br><span class="line">			&lt;tx:method name=<span class="string">"add*"</span> /&gt;</span><br><span class="line">			&lt;tx:method name=<span class="string">"update*"</span> /&gt;</span><br><span class="line">			&lt;tx:method name=<span class="string">"delete*"</span> /&gt;</span><br><span class="line">		&lt;/tx:attributes&gt;</span><br><span class="line">	&lt;/tx:advice&gt;</span><br><span class="line">	&lt;!-- 定义切面 --&gt;</span><br><span class="line">	&lt;aop:config&gt;</span><br><span class="line">		&lt;!-- 定义切入点 --&gt;</span><br><span class="line">		&lt;aop:pointcut expression=<span class="string">"execution(* cn.hate.service..*.*(..))"</span> id=<span class="string">"serviceeMethod"</span>/&gt;</span><br><span class="line">		&lt;!-- 织入 --&gt;</span><br><span class="line">		&lt;aop:advisor advice-ref=<span class="string">"txAdvice"</span> pointcut-ref=<span class="string">"serviceeMethod"</span>/&gt;</span><br><span class="line">	&lt;/aop:config&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<h3 id="struts-xml"><a href="#struts-xml" class="headerlink" title="struts.xml"></a>struts.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE struts PUBLIC</span><br><span class="line">	<span class="string">"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"</span></span><br><span class="line">	<span class="string">"http://struts.apache.org/dtds/struts-2.3.dtd"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;struts&gt;</span><br><span class="line">	&lt;!-- 设置action动态方法调用 --&gt;</span><br><span class="line">	&lt;constant name=<span class="string">"struts.enable.DynamicMethodInvocation"</span> value=<span class="string">"true"</span> /&gt;</span><br><span class="line">	&lt;!-- 启动开发模式 --&gt;</span><br><span class="line">	&lt;constant name=<span class="string">"struts.devMode"</span> value=<span class="string">"true"</span> /&gt;</span><br><span class="line">	&lt;!-- 处理中文乱码 --&gt;</span><br><span class="line">	&lt;constant name=<span class="string">"struts.i18n.encoding"</span> value=<span class="string">"utf-8"</span> /&gt;</span><br><span class="line">	&lt;!-- 处理所有文件大小 --&gt;</span><br><span class="line">	&lt;constant name=<span class="string">"struts.multipart.maxSize"</span> value=<span class="string">"5000000"</span> /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;package name=<span class="string">"default"</span> namespace=<span class="string">"/"</span> extends=<span class="string">"struts-default"</span>&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;global-results&gt;</span><br><span class="line">    		&lt;result name=<span class="string">"input"</span>&gt;/error.jsp&lt;/result&gt;</span><br><span class="line">    	&lt;/global-results&gt;</span><br><span class="line">    	</span><br><span class="line">    	&lt;action name=<span class="string">"defaultAction"</span>&gt;</span><br><span class="line">    		&lt;result&gt;/error.jsp&lt;/result&gt;</span><br><span class="line">    	&lt;/action&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;!-- 分页查询 --&gt;</span><br><span class="line">		&lt;action name=<span class="string">"orderList"</span> class=<span class="string">"cusAction"</span> method=<span class="string">"orderList"</span>&gt;</span><br><span class="line">			&lt;result name=<span class="string">"success"</span>&gt;/index.jsp&lt;/result&gt;</span><br><span class="line">		&lt;/action&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- 添加订单 --&gt;</span><br><span class="line">		&lt;action name=<span class="string">"addOrder"</span> class=<span class="string">"cusAction"</span> method=<span class="string">"addOrder"</span>&gt;</span><br><span class="line">			&lt;result name=<span class="string">"success"</span> <span class="built_in">type</span>=<span class="string">"redirectAction"</span>&gt;orderList&lt;/result&gt;</span><br><span class="line">			&lt;result name=<span class="string">"input"</span>&gt;/addOrder.jsp&lt;/result&gt;</span><br><span class="line">		&lt;/action&gt;</span><br><span class="line">	   	</span><br><span class="line">	   	&lt;!-- 添加订单明细 --&gt;</span><br><span class="line">		&lt;action name=<span class="string">"addOrderLines"</span> class=<span class="string">"cusAction"</span> method=<span class="string">"addOrderLines"</span>&gt;</span><br><span class="line">			&lt;result name=<span class="string">"success"</span> <span class="built_in">type</span>=<span class="string">"redirectAction"</span>&gt;findOrderById&lt;/result&gt;</span><br><span class="line">			&lt;result name=<span class="string">"input"</span>&gt;/addOrderLine.jsp&lt;/result&gt;</span><br><span class="line">		&lt;/action&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- 根据id查询订单 --&gt;</span><br><span class="line">		&lt;action name=<span class="string">"findOrderById"</span> class=<span class="string">"cusAction"</span> method=<span class="string">"findOrderById"</span>&gt;</span><br><span class="line">			&lt;result name=<span class="string">"success"</span>&gt;/addOrderLine.jsp&lt;/result&gt;</span><br><span class="line">		&lt;/action&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- 删除订单明细--&gt;</span><br><span class="line">		&lt;action name=<span class="string">"deleteOrderLine"</span> class=<span class="string">"cusAction"</span> method=<span class="string">"deleteOrderLine"</span>&gt;</span><br><span class="line">			&lt;result name=<span class="string">"success"</span> <span class="built_in">type</span>=<span class="string">"redirectAction"</span>&gt;findOrderById&lt;/result&gt;</span><br><span class="line">		&lt;/action&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- 模糊查询订单--&gt;</span><br><span class="line">		&lt;action name=<span class="string">"findOrderByLike"</span> class=<span class="string">"cusAction"</span> method=<span class="string">"findOrderByLike"</span>&gt;</span><br><span class="line">			&lt;result name=<span class="string">"success"</span>&gt;/index.jsp&lt;/result&gt;</span><br><span class="line">		&lt;/action&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- 查询所有用户--&gt;</span><br><span class="line">		&lt;action name=<span class="string">"findAllCust"</span> class=<span class="string">"cusAction"</span> method=<span class="string">"findAllCust"</span>&gt;</span><br><span class="line">			&lt;result name=<span class="string">"success"</span>&gt;/addOrder.jsp&lt;/result&gt;</span><br><span class="line">		&lt;/action&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- 查询所有商品--&gt;</span><br><span class="line">		&lt;!-- &lt;action name=<span class="string">"findAllPro"</span> class=<span class="string">"cusAction"</span> method=<span class="string">"findAllPro"</span>&gt;</span><br><span class="line">			&lt;result name=<span class="string">"success"</span>&gt;/addOrderLine.jsp&lt;/result&gt;</span><br><span class="line">		&lt;/action&gt; --&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- Ajax --&gt;</span><br><span class="line">		&lt;action name=<span class="string">"getStreamResult"</span> class=<span class="string">"cusAction"</span>&gt;</span><br><span class="line">			&lt;result name=<span class="string">"success"</span> <span class="built_in">type</span>=<span class="string">"stream"</span>&gt;</span><br><span class="line">				&lt;param name=<span class="string">"contentType"</span>&gt;text/html&lt;/param&gt;</span><br><span class="line">				&lt;param name=<span class="string">"inputName"</span>&gt;inputStream&lt;/param&gt;</span><br><span class="line">			&lt;/result&gt;</span><br><span class="line">		&lt;/action&gt;</span><br><span class="line">	&lt;/package&gt;</span><br><span class="line">&lt;/struts&gt;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/24/SSH框架搭建/" data-id="cjrabl6o1001fvkdqmhhv8pea" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Struts2配置详解" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/22/Struts2配置详解/" class="article-date">
  <time datetime="2018-11-22T14:59:05.000Z" itemprop="datePublished">2018-11-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SSH/">SSH</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/22/Struts2配置详解/">Struts2配置详解</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="回忆用户登录过程"><a href="#回忆用户登录过程" class="headerlink" title="回忆用户登录过程"></a>回忆用户登录过程</h3><blockquote>
<p>JSP页面请求👇<br>核心控制器👇<br>Action👇<br>Result👇<br>JSP页面显示</p>
</blockquote>
<h4 id="核心控制器"><a href="#核心控制器" class="headerlink" title="核心控制器"></a>核心控制器</h4><blockquote>
<p>在web.xml中配置，对框架进行初始化，以及处理所有的请求</p>
</blockquote>
<h4 id="Action-业务控制器"><a href="#Action-业务控制器" class="headerlink" title="Action 业务控制器"></a>Action 业务控制器</h4><blockquote>
<p>创建Action,实现Action接口，继承ActionSupport类<br>name属性不能重名，class属性为Action的路径</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;action name=<span class="string">"Login"</span> class=<span class="string">"cn.ssh.LoginAction"</span>&gt;</span><br><span class="line">           &lt;result name=<span class="string">"success"</span>&gt;/success.jsp&lt;/result&gt;</span><br><span class="line">           &lt;result name=<span class="string">"fail"</span>&gt;/fail.jsp&lt;/result&gt;</span><br><span class="line">           &lt;result name=<span class="string">"input"</span>&gt;/login.jsp&lt;/result&gt;</span><br><span class="line">&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<h4 id="Result-实现对结果的处理"><a href="#Result-实现对结果的处理" class="headerlink" title="Result 实现对结果的处理"></a>Result 实现对结果的处理</h4><blockquote>
<p>实现对结果的调用<br>result元素的值指定对应的实际资源位置<br>name属性表示result的逻辑名，Action返回的字符串</p>
</blockquote>
<h4 id="Struts-xml"><a href="#Struts-xml" class="headerlink" title="Struts.xml"></a>Struts.xml</h4><blockquote>
<p>constant元素，可以改变struts2框架的一些行为<br>name表示常量名称，value表示常量值</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 处理中文乱码 --&gt;</span><br><span class="line">&lt;constant name=<span class="string">"struts.i18n.encoding"</span> value=<span class="string">"UTF-8"</span>&gt;&lt;/constant&gt;</span><br><span class="line">	</span><br><span class="line">&lt;!-- 设置action动态方法调用 --&gt;</span><br><span class="line">&lt;constant name=<span class="string">"struts.enable.DynamicMethodInvocation"</span> value=<span class="string">"true"</span>&gt;&lt;/constant&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>package元素 –简化维护工作，提高重用性<br>包可以继承已定义的包<br>name属性必须且唯一，用于指定包的名称<br>extends属性指定要扩展的包，总是扩展struts-default包<br>namespace属性定义该包action的命名空间，可选</p>
</blockquote>
<h3 id="配置Action"><a href="#配置Action" class="headerlink" title="配置Action"></a>配置Action</h3><blockquote>
<p>Action,封装工作单元，数据转移的场所，返回结果字符串</p>
</blockquote>
<h4 id="method属性"><a href="#method属性" class="headerlink" title="method属性"></a>method属性</h4><blockquote>
<p>属于action属性，默认值：execute，可以更改属性值实现Action中不同方法的调用</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> //登录</span><br><span class="line">	public String <span class="function"><span class="title">login</span></span>()&#123;</span><br><span class="line">		</span><br><span class="line">		//<span class="built_in">return</span> <span class="string">"success"</span>;</span><br><span class="line">		<span class="built_in">return</span> <span class="string">"dologin"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//注册</span><br><span class="line">	public String <span class="function"><span class="title">register</span></span>()&#123;</span><br><span class="line">		</span><br><span class="line">		//<span class="built_in">return</span> <span class="string">"success"</span>;</span><br><span class="line">		<span class="built_in">return</span> <span class="string">"doregister"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> &lt;action name=<span class="string">"login"</span> class=<span class="string">"cn.ssh.UserAction"</span> method=<span class="string">"login"</span>&gt;</span><br><span class="line">    		&lt;result&gt;/login.jsp&lt;/result&gt;</span><br><span class="line">    	&lt;/action&gt;</span><br><span class="line">&lt;action name=<span class="string">"register"</span> class=<span class="string">"cn.ssh.UserAction"</span> method=<span class="string">"register"</span>&gt;</span><br><span class="line">    		&lt;result&gt;/register.jsp&lt;/result&gt;</span><br><span class="line">        &lt;/action</span><br></pre></td></tr></table></figure>
<h4 id="配置默认action"><a href="#配置默认action" class="headerlink" title="配置默认action"></a>配置默认action</h4><blockquote>
<p>没有Action匹配请求时，默认Action将被执行</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 指定默认的action ，/user/a.action会跳转error --&gt;</span><br><span class="line">&lt;default-action-ref name=<span class="string">"defaultAction"</span>&gt;&lt;/default-action-ref&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 全局结果 --&gt;</span><br><span class="line">&lt;global-results&gt;</span><br><span class="line">	&lt;result name=<span class="string">"error"</span>&gt;/error.jsp&lt;/result&gt;</span><br><span class="line">&lt;/global-results&gt;</span><br><span class="line">&lt;!-- 省略class，直接使用ActionSupport类 --&gt;</span><br><span class="line">&lt;action name=<span class="string">"defaultAction"</span>&gt;</span><br><span class="line">	&lt;result&gt;/error.jsp&lt;/result&gt;</span><br><span class="line">&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<h3 id="简化Action的配置，调用方式"><a href="#简化Action的配置，调用方式" class="headerlink" title="简化Action的配置，调用方式"></a>简化Action的配置，调用方式</h3><blockquote>
<p>对于用一个action类的每一个方法都陪着了一次，造成action元素数量太多</p>
</blockquote>
<h4 id="动态方法调用"><a href="#动态方法调用" class="headerlink" title="动态方法调用"></a>动态方法调用</h4><blockquote>
<p>使用：actionName!methodName.action<br>禁用：将属性Struts.enable.DynmicMethodInvocation设置为false</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 设置action动态方法调用 --&gt;</span><br><span class="line">&lt;constant name=<span class="string">"struts.enable.DynamicMethodInvocation"</span> value=<span class="string">"true"</span>&gt;&lt;/constant&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 简化action 动态方法调用  struts2-core-2.3.16.3.jar的default.properties设置 struts.enable.DynamicMethodInvocation = <span class="literal">true</span> --&gt;</span><br><span class="line">    	&lt;action name=<span class="string">"user"</span> class=<span class="string">"cn.ssh.UserAction"</span>&gt;</span><br><span class="line">    		&lt;result name=<span class="string">"dologin"</span>&gt;/login.jsp&lt;/result&gt;</span><br><span class="line">    		&lt;result name=<span class="string">"doregister"</span>&gt;/register.jsp&lt;/result&gt;</span><br><span class="line">    		&lt;!-- 调用 action name ! action方法name.action --&gt;</span><br><span class="line">    	&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<h4 id="使用通配符"><a href="#使用通配符" class="headerlink" title="使用通配符"></a>使用通配符</h4><blockquote>
<p>简化相同方法</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//添加用户</span><br><span class="line">	public String <span class="function"><span class="title">add</span></span>()&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">return</span> <span class="string">"input"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//删除用户</span><br><span class="line">	public String <span class="function"><span class="title">delete</span></span>()&#123;</span><br><span class="line">		<span class="keyword">if</span>(id.length()==0)&#123;</span><br><span class="line">			this.message=<span class="string">"删除失败"</span>;</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"input"</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			this.message=<span class="string">"删除成功"</span>;</span><br><span class="line">			System.out.println(<span class="string">"删除-----"</span>);</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"success"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;action name=<span class="string">"*User"</span> class=<span class="string">"cn.ssh.UserAction"</span> method=<span class="string">"&#123;1&#125;"</span>&gt;</span><br><span class="line">    		&lt;result name=<span class="string">"input"</span>&gt;/page/&#123;1&#125;.jsp&lt;/result&gt;</span><br><span class="line">    		&lt;result name=<span class="string">"success"</span> <span class="built_in">type</span>=<span class="string">"redirect"</span>&gt;/page/&#123;1&#125;_success.jsp&lt;/result&gt;</span><br><span class="line">    	&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>调用：[你要输入的字符]User.action</p>
</blockquote>
<h3 id="Result常用结果类型"><a href="#Result常用结果类型" class="headerlink" title="Result常用结果类型"></a>Result常用结果类型</h3><blockquote>
<p>dispatcher：默认结果类型，后台使用RequestDispatcher转发请求<br>redirect：后台使用sendRedirect()将请求重定向至指定的url<br>redirectAction：主要用于重定向到action</p>
</blockquote>
<h3 id="动态结果"><a href="#动态结果" class="headerlink" title="动态结果"></a>动态结果</h3><blockquote>
<p>配置时不知道执行后结果是哪一个，运行时才知道哪个结果作为视图显示给用户</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">private String nextDispose=<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">public String <span class="function"><span class="title">doLogin</span></span>()&#123;</span><br><span class="line">		System.out.println(<span class="string">"判断-----"</span>);</span><br><span class="line">		<span class="keyword">if</span>(isManager())&#123;</span><br><span class="line">			nextDispose=<span class="string">"manager"</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			nextDispose=<span class="string">"common"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> <span class="string">"success"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> &lt;action name=<span class="string">"doLogins"</span> class=<span class="string">"cn.ssh.UserAction"</span> method=<span class="string">"doLogin"</span>&gt;</span><br><span class="line">    		&lt;result <span class="built_in">type</span>=<span class="string">"redirectAction"</span>&gt;<span class="variable">$&#123;nextDispose&#125;</span>&lt;/result&gt;</span><br><span class="line">    		&lt;result name=<span class="string">"error"</span>&gt;.page/error.jsp&lt;/result&gt;</span><br><span class="line">    	&lt;/action&gt;</span><br><span class="line">    	&lt;action name=<span class="string">"manager"</span>&gt;</span><br><span class="line">    		&lt;result&gt;/page/manager.jsp&lt;/result&gt;</span><br><span class="line">    	&lt;/action&gt;</span><br><span class="line">    	&lt;action name=<span class="string">"common"</span>&gt;</span><br><span class="line">    		&lt;result&gt;/page/common.jsp&lt;/result&gt;</span><br><span class="line">    	&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<h3 id="全局结果"><a href="#全局结果" class="headerlink" title="全局结果"></a>全局结果</h3><blockquote>
<p>实现同一个包中多个action共享一个结果<br>如果返回error，但是action并没有配置，会去找global-results</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 全局结果 --&gt;</span><br><span class="line">    	&lt;global-results&gt;</span><br><span class="line">    		&lt;result name=<span class="string">"error"</span>&gt;/error.jsp&lt;/result&gt;</span><br><span class="line">    	&lt;/global-results&gt;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/22/Struts2配置详解/" data-id="cjrabl6r50032vkdq4p75irhs" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Struts2入门" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/21/Struts2入门/" class="article-date">
  <time datetime="2018-11-21T01:33:20.000Z" itemprop="datePublished">2018-11-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SSH/">SSH</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/21/Struts2入门/">Struts2入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Struts2的前身是Opensymphony的Webwork2，实际上Strut和Webwork2合并后形成Struts2</p>
</blockquote>
<h3 id="Struts2的优势"><a href="#Struts2的优势" class="headerlink" title="Struts2的优势"></a>Struts2的优势</h3><blockquote>
<p>1.实现mvc模式，层次结构清晰，是开发者专注业务逻辑实现<br>2.丰富的标签库提高开发效率<br>3.基于aop思想的拦截器机制降低业务见的耦合<br>4.通过配置文件既可掌握系统间各部分的关系<br>5.更方便的异常处理机制<br>6.高扩展性</p>
</blockquote>
<h3 id="配置Struts2环境"><a href="#配置Struts2环境" class="headerlink" title="配置Struts2环境"></a>配置Struts2环境</h3><h4 id="jar包"><a href="#jar包" class="headerlink" title="jar包"></a>jar包</h4><blockquote>
<p>asm-3.3.jar<br>asm-commons-3.3.jar<br>asm-tree-3.3.jar<br>commons-fileupload-1.3.1.jar<br>commons-io-2.2.jar<br>commons-lang3-3.1.jar<br>commons-logging-1.1.3.jar<br>freemarker-2.3.19.jar<br>javassist-3.11.0.GA.jar<br>log4j-1.2.17.jar<br>ognl-3.0.6.jar<br>struts2-core-2.3.16.3.jar<br>xwork-core-2.3.16.3.jar</p>
</blockquote>
<h4 id="web-xml配置"><a href="#web-xml配置" class="headerlink" title="web.xml配置"></a>web.xml配置</h4><blockquote>
<p>这个文件为每个web应用程序提供接入点。在部署描述符（web.xml）中，Struts2 应用程序的接入点将会定义为一个过滤器。因此我们将在web.xml里定义一个FilterDispatcher类的接入点</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;web-app id=<span class="string">"WebApp_9"</span> version=<span class="string">"2.4"</span> xmlns=<span class="string">"http://java.sun.com/xml/ns/j2ee"</span></span><br><span class="line">	xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">	xsi:schemaLocation=<span class="string">"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</span>&gt;</span><br><span class="line"></span><br><span class="line">	&lt;display-name&gt;Struts Blank&lt;/display-name&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- 过滤器 --&gt;</span><br><span class="line">	&lt;filter&gt;</span><br><span class="line">		&lt;filter-name&gt;struts2&lt;/filter-name&gt;</span><br><span class="line">		&lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;</span><br><span class="line">	&lt;/filter&gt;</span><br><span class="line"></span><br><span class="line">	&lt;filter-mapping&gt;</span><br><span class="line">		&lt;filter-name&gt;struts2&lt;/filter-name&gt;</span><br><span class="line">        &lt;!-- 将全部请求定位到指定的Struts2过滤器中--&gt;</span><br><span class="line">		&lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">	&lt;/filter-mapping&gt;</span><br><span class="line"></span><br><span class="line">	&lt;welcome-file-list&gt;</span><br><span class="line">		&lt;welcome-file&gt;index.html&lt;/welcome-file&gt;</span><br><span class="line">	&lt;/welcome-file-list&gt;</span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>我们将Struts2 过滤器映射到 /<em> ，而不是 /</em>.action ，这意味着所有的url都会被Struts过滤器解析</p>
</blockquote>
<h4 id="在src目录下创建Struts2核心文件-struts-xml"><a href="#在src目录下创建Struts2核心文件-struts-xml" class="headerlink" title="在src目录下创建Struts2核心文件(struts.xml)"></a>在src目录下创建Struts2核心文件(struts.xml)</h4><blockquote>
<p>struts.xml文件包含有随着Actions的开发你将要修改的配置信息。它可用于覆盖应用程序的默认设置<br>这个文件可在WEB-INF/classes文件夹下创建<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE struts PUBLIC</span><br><span class="line">	<span class="string">"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"</span></span><br><span class="line">	<span class="string">"http://struts.apache.org/dtds/struts-2.3.dtd"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;struts&gt;    </span><br><span class="line">	&lt;!-- 处理中文乱码 --&gt;</span><br><span class="line">	&lt;constant name=<span class="string">"struts.i18n.encoding"</span> value=<span class="string">"UTF-8"</span>&gt;&lt;/constant&gt;</span><br><span class="line">	&lt;!-- 创建一个default包，继承struts2的struts-default namespace为 action指定了一个访问路径的前缀--&gt;</span><br><span class="line">    &lt;package name=<span class="string">"default"</span> namespace=<span class="string">"/"</span> extends=<span class="string">"struts-default"</span>&gt;</span><br><span class="line">        &lt;!-- 接收HelloWorldAction的请求,helloWorld对应form表单--&gt;</span><br><span class="line">        &lt;action name=<span class="string">"helloWorld"</span> class=<span class="string">"cn.ssh.HelloWorldAction"</span>&gt;</span><br><span class="line">           &lt;result name=<span class="string">"success"</span>&gt;/helloWorld.jsp&lt;/result&gt;</span><br><span class="line">        &lt;/action&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;!-- result的name对应action返回的字符串，可以有多个result 对应视图--&gt;</span><br><span class="line">        &lt;action name=<span class="string">"Login"</span> class=<span class="string">"cn.ssh.LoginAction"</span>&gt;</span><br><span class="line">           &lt;result name=<span class="string">"success"</span>&gt;/success.jsp&lt;/result&gt; //成功返回</span><br><span class="line">           &lt;result name=<span class="string">"fail"</span>&gt;/fail.jsp&lt;/result&gt; //失败返回</span><br><span class="line">           &lt;result name=<span class="string">"input"</span>&gt;/login.jsp&lt;/result&gt; //其他返回</span><br><span class="line">        &lt;/action&gt;</span><br><span class="line">    &lt;/package&gt; </span><br><span class="line">&lt;/struts&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name（必需）</td>
<td>为package的唯一标识</td>
</tr>
<tr>
<td>extends</td>
<td>指定package继承另一package的所有配置。通常情况下，我们使用struts-default作为package的基础。</td>
</tr>
<tr>
<td>abstract</td>
<td>定义package为抽象的。如果标记为true，则package不能被最终用户使用。</td>
</tr>
<tr>
<td>namespace</td>
<td>Actions的唯一命名空间</td>
</tr>
</tbody>
</table>
<h4 id="创建Action文件"><a href="#创建Action文件" class="headerlink" title="创建Action文件"></a>创建Action文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">package cn.ssh;</span><br><span class="line">import com.opensymphony.xwork2.ActionSupport;</span><br><span class="line">public class HelloWorld extends ActionSupport &#123;</span><br><span class="line">    private String message;</span><br><span class="line">    private String name;</span><br><span class="line">    @Override</span><br><span class="line">    public String execute() throws Exception &#123;</span><br><span class="line">        message = <span class="string">"Hello World,Struts2"</span>;</span><br><span class="line">        <span class="built_in">return</span> SUCCESS;</span><br><span class="line">    &#125;</span><br><span class="line">    public String <span class="function"><span class="title">getMessage</span></span>()&#123;</span><br><span class="line">        <span class="built_in">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="创建-jsp文件"><a href="#创建-jsp文件" class="headerlink" title="创建.jsp文件"></a>创建.jsp文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> %&gt;</span><br><span class="line">&lt;!-- 引用Struts2的标签库--&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;s:property value=<span class="string">"message"</span>/&gt;&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">        输出显示语句：&lt;s:property value=<span class="string">"message"</span>/&gt; 来自action的属性</span><br><span class="line">        </span><br><span class="line">        helloWorld为 &lt;package&gt;  namespace=<span class="string">"/"</span> action为helloWorld，.action默认，name=“name”来自action的属性</span><br><span class="line">        &lt;form action=<span class="string">"helloWorld.action"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    		请输入您的名字:&lt;input <span class="built_in">type</span>=<span class="string">"text"</span> name=<span class="string">"name"</span>&gt;</span><br><span class="line">    		&lt;input <span class="built_in">type</span>=<span class="string">"submit"</span> value=<span class="string">"提交"</span>&gt;</span><br><span class="line">    	&lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Struts2的执行流程"><a href="#Struts2的执行流程" class="headerlink" title="Struts2的执行流程"></a>Struts2的执行流程</h3><blockquote>
<p>1.P helloWorld.action发送请求<br>2.web.xml进行过滤<br>3.在srruts.xml 中找到相对的action<br>4.找到helloWorldAction<br>5.helloWorldAction返回字符串到struts.xml 进行Result跳转</p>
</blockquote>
<h3 id="Struts2登录过程分析"><a href="#Struts2登录过程分析" class="headerlink" title="Struts2登录过程分析"></a>Struts2登录过程分析</h3><h4 id="创建-LoginAction"><a href="#创建-LoginAction" class="headerlink" title="创建 LoginAction"></a>创建 LoginAction</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">....</span><br><span class="line">public String execute() throws Exception &#123;</span><br><span class="line">		<span class="keyword">if</span>(name.equals(<span class="string">"憨八龟"</span>)&amp;&amp;password.equals(<span class="string">"123456"</span>))&#123;</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"success"</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"fail"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="struts-xml"><a href="#struts-xml" class="headerlink" title="struts.xml"></a>struts.xml</h4><blockquote>
<p>进行Result返回视图</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;package name=<span class="string">"default"</span> namespace=<span class="string">"/"</span> extends=<span class="string">"struts-default"</span>&gt;</span><br><span class="line">        &lt;action name=<span class="string">"helloWorld"</span> class=<span class="string">"cn.ssh.HelloWorldAction"</span>&gt;</span><br><span class="line">           &lt;result name=<span class="string">"success"</span>&gt;/helloWorld.jsp&lt;/result&gt;</span><br><span class="line">        &lt;/action&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;action name=<span class="string">"Login"</span> class=<span class="string">"cn.ssh.LoginAction"</span>&gt;</span><br><span class="line">           &lt;result name=<span class="string">"success"</span>&gt;/success.jsp&lt;/result&gt;</span><br><span class="line">           &lt;result name=<span class="string">"fail"</span>&gt;/fail.jsp&lt;/result&gt;</span><br><span class="line">           &lt;result name=<span class="string">"input"</span>&gt;/login.jsp&lt;/result&gt;</span><br><span class="line">        &lt;/action&gt;</span><br><span class="line">    &lt;/package&gt;</span><br></pre></td></tr></table></figure>
<h4 id="JSP-login-jsp"><a href="#JSP-login-jsp" class="headerlink" title="JSP login.jsp"></a>JSP login.jsp</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"Login.action"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    		请输入您的名字:&lt;input <span class="built_in">type</span>=<span class="string">"text"</span> name=<span class="string">"name"</span>&gt;</span><br><span class="line">    		请输入您的密码:&lt;input <span class="built_in">type</span>=<span class="string">"password"</span> name=<span class="string">"password"</span>&gt;</span><br><span class="line">    		&lt;input <span class="built_in">type</span>=<span class="string">"submit"</span> value=<span class="string">"提交"</span>&gt;</span><br><span class="line">    	&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Struts2访问Servlet-API"><a href="#Struts2访问Servlet-API" class="headerlink" title="Struts2访问Servlet API"></a>Struts2访问Servlet API</h3><h4 id="解耦方式访问"><a href="#解耦方式访问" class="headerlink" title="解耦方式访问"></a>解耦方式访问</h4><blockquote>
<p>提供了三个map对象访问，request，session和application<br>在通过ActionContext类获取这三个map对象</p>
<blockquote>
<p>object get(“request”)<br>map getSession()<br>map getApplication()</p>
</blockquote>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//解耦方式获取session,key/value方式存储</span><br><span class="line">Map&lt;String, Object&gt;session=null;</span><br><span class="line">session=ActionContext.getContext().getSession();</span><br><span class="line">session.put(<span class="string">"current_user"</span>, name);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>JSP显示session信息</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;sessionScope.current_user &#125;</span> //获取key值</span><br></pre></td></tr></table></figure>
<h4 id="与Servlet耦合的访问"><a href="#与Servlet耦合的访问" class="headerlink" title="与Servlet耦合的访问"></a>与Servlet耦合的访问</h4><blockquote>
<p>通过ServletActionContext类获取Servlet API对象</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//耦合方式获取session</span><br><span class="line">HttpSession ssion=null;</span><br><span class="line">session=ServletActionContext.getRequest().getSession();</span><br><span class="line">session.setAttribute(<span class="string">"current_user"</span>, name);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>建议使用ActionContext类解耦和的方式，因为所有一次请求的数据都包括在ActionContext类</p>
</blockquote>
<h3 id="Struts数据校验"><a href="#Struts数据校验" class="headerlink" title="Struts数据校验"></a>Struts数据校验</h3><blockquote>
<p>通过在服务器端校验可防止用户绕过客户端脚本验证</p>
<blockquote>
<p>ctionSupport类,不仅对Action接口进行了简单实现，同时增加了数据校验，本地化等支持</p>
</blockquote>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">	public void <span class="function"><span class="title">validate</span></span>() &#123;</span><br><span class="line">		<span class="keyword">if</span>(name.length()==0)&#123;</span><br><span class="line">			this.addFieldError(<span class="string">"name"</span>, <span class="string">"姓名不能为空"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(password.length()==0)&#123;</span><br><span class="line">			this.addFieldError(<span class="string">"password"</span>, <span class="string">"密码不能为空"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		//如果发现错误,会返回”input“，否则继续执行后续方法</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>将校验错误信息输出在页面</p>
<blockquote>
<p>使用Struts2提供的标签<br>fielderror只针对字段<br>actionerror针对当前的action<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;s:fielderror fieldName=<span class="string">"name"</span>/&gt;</span><br><span class="line">&lt;s:fielderror fieldName=<span class="string">"password"</span>/&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
</blockquote>
<h3 id="Struts2-UI标签"><a href="#Struts2-UI标签" class="headerlink" title="Struts2 UI标签"></a>Struts2 UI标签</h3><h4 id="表单标签"><a href="#表单标签" class="headerlink" title="表单标签"></a>表单标签</h4><blockquote>
<p>与ognl表达式结合使用发挥最大实力</p>
</blockquote>
<table>
<thead>
<tr>
<th>标签</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;s:form&gt;…&lt;/s:form&gt;</td>
<td>表单标签</td>
</tr>
<tr>
<td>&lt;s:textfield&gt;…&lt;/s: textfield&gt;</td>
<td>输入框</td>
</tr>
<tr>
<td>&lt;s:password&gt;…&lt;/s: password &gt;</td>
<td>密码输入框</td>
</tr>
<tr>
<td>&lt;s:textarea&gt;…&lt;/s: textarea &gt;</td>
<td>文本域输入框</td>
</tr>
<tr>
<td>&lt;s:radio&gt;…&lt;/s: radio &gt;</td>
<td>单选按钮</td>
</tr>
<tr>
<td>&lt;s:checkbox&gt;…&lt;/s: checkbox &gt;</td>
<td>多选框</td>
</tr>
<tr>
<td>&lt;s:submit/&gt;</td>
<td>提交标签</td>
</tr>
<tr>
<td>&lt;s:reset/&gt;</td>
<td>重置标签</td>
</tr>
<tr>
<td>&lt;s:hidden/&gt;</td>
<td>隐藏域标签</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;s:form action=<span class="string">"Login.action"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    		&lt;s:textfield name=<span class="string">"name"</span> value=<span class="string">""</span> label=<span class="string">"用户名"</span>&gt;&lt;/s:textfield&gt;</span><br><span class="line">    		&lt;s:password name=<span class="string">"password"</span> value=<span class="string">""</span> label=<span class="string">"密码"</span>&gt;&lt;/s:password&gt;</span><br><span class="line">    		&lt;s:submit value=<span class="string">"登录"</span>&gt;&lt;/s:submit&gt;</span><br><span class="line">    	&lt;/s:form&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>label属性更简洁，方便</p>
</blockquote>
<h4 id="非表单标签"><a href="#非表单标签" class="headerlink" title="非表单标签"></a>非表单标签</h4><table>
<thead>
<tr>
<th>标签</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;s:actionerror/s:actionerror&gt;</td>
<td>显示action错误</td>
</tr>
<tr>
<td>&lt;s:actionmessage&gt;…&lt;/s: actionmessage&gt;</td>
<td>显示error消息</td>
</tr>
<tr>
<td>&lt;s:fielderror&gt;…&lt;/s: fielderror &gt;</td>
<td>显示字段错误</td>
</tr>
</tbody>
</table>
<h3 id="Struts2通用标签"><a href="#Struts2通用标签" class="headerlink" title="Struts2通用标签"></a>Struts2通用标签</h3><blockquote>
<p>控制标签</p>
</blockquote>
<table>
<thead>
<tr>
<th>名称</th>
<th>标签</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>条件标签</td>
<td>&lt;s:if&gt;&lt;/s:if&gt;</td>
<td>根据表达式的值判断执行的内容</td>
</tr>
<tr>
<td>条件标签</td>
<td>&lt;s:elseif&gt;&lt;/s:elseif&gt;</td>
<td>根据表达式的值判断执行的内容</td>
</tr>
<tr>
<td>条件标签</td>
<td>&lt;s:else&gt;&lt;/s:else&gt;</td>
<td>根据表达式的值判断执行的内容</td>
</tr>
<tr>
<td>循环标签</td>
<td>&lt;s:iterator&gt;&lt;/s:iterator&gt;</td>
<td>用于便利集合</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;input <span class="built_in">type</span>=<span class="string">"radio"</span> name=<span class="string">"sex"</span> value=<span class="string">"1"</span>&gt;男</span><br><span class="line">&lt;input <span class="built_in">type</span>=<span class="string">"radio"</span> name=<span class="string">"sex"</span> value=<span class="string">"0"</span>&gt;女</span><br><span class="line"></span><br><span class="line">&lt;s:<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"sex==1"</span>&gt;男人&lt;/s:<span class="keyword">if</span>&gt;</span><br><span class="line">&lt;s:elseif <span class="built_in">test</span>=<span class="string">"sex==0"</span>&gt;女人&lt;/s:elseif&gt;</span><br><span class="line">&lt;s:<span class="keyword">else</span>&gt;!&lt;/s:<span class="keyword">else</span>&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">private List&lt;String&gt;users=new ArrayList&lt;String&gt;();</span><br><span class="line">users.add(<span class="string">"樊可"</span>);</span><br><span class="line">users.add(<span class="string">"李钰洋"</span>);</span><br><span class="line">users.add(<span class="string">"fankekeke"</span>);</span><br><span class="line"></span><br><span class="line">//value属性：进行遍历的集合对象</span><br><span class="line">//status属性：当前循环元素的IteratorStatus实例</span><br><span class="line">//id属性：当前循环元素的id，可直接访问元素</span><br><span class="line">&lt;s:iterator value=<span class="string">"users"</span> status=<span class="string">"st"</span> id=<span class="string">"user"</span>&gt;</span><br><span class="line">&lt;s:property value=<span class="string">"user"</span>/&gt;&lt;br/&gt;</span><br><span class="line">&lt;/s:iterator&gt;</span><br><span class="line"></span><br><span class="line">&lt;s:iterator value=<span class="string">"users"</span> status=<span class="string">"st"</span>&gt;</span><br><span class="line">&lt;s:property/&gt;&lt;br/&gt;</span><br><span class="line">&lt;/s:iterator&gt;</span><br><span class="line"></span><br><span class="line">&lt;s:iterator value=<span class="string">"userList"</span> status=<span class="string">"user"</span>&gt;</span><br><span class="line">姓名：&lt;s:property value=<span class="string">"user.userName"</span> /&gt;</span><br><span class="line">年龄：&lt;s:property value=<span class="string">"user.age"</span> /&gt;</span><br><span class="line">&lt;/s:iterator&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>用的数据标签</p>
</blockquote>
<table>
<thead>
<tr>
<th>标签</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>action标签：</td>
<td>于在视图页面跳转到一个Action</td>
</tr>
<tr>
<td>bean标签：</td>
<td>用于创建一个Javabean实例，按需保存到context中</td>
</tr>
<tr>
<td>date标签：</td>
<td>用于格式化输出一个日期</td>
</tr>
<tr>
<td>debug标签：</td>
<td>用于调试查看ognl上下文中内容</td>
</tr>
<tr>
<td>include标签：</td>
<td>用于包含其他的jsp或者servlet页面资源</td>
</tr>
<tr>
<td>param标签：</td>
<td>主要配合别的标签作为子标签使用</td>
</tr>
<tr>
<td>push标签：</td>
<td>用于将某个值放入到root栈顶</td>
</tr>
<tr>
<td>set标签：</td>
<td>设置一个新变量，放入指定范围</td>
</tr>
<tr>
<td>url标签：</td>
<td>用于生成一个URL地址</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/21/Struts2入门/" data-id="cjrabl6r0002uvkdq2h6d82y0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-HQL连接查询和注解" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/19/HQL连接查询和注解/" class="article-date">
  <time datetime="2018-11-19T13:04:32.000Z" itemprop="datePublished">2018-11-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SSH/">SSH</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/19/HQL连接查询和注解/">HQL连接查询和注解</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="HQL连接查询类型"><a href="#HQL连接查询类型" class="headerlink" title="HQL连接查询类型"></a>HQL连接查询类型</h3><h4 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h4><blockquote>
<p>INNER JOIN 关键字表示内连接, 也可以省略 INNER 关键字<br> list() 方法的集合中存放的每个元素对应查询结果的一条记录, 每个元素都是对象数组类型，  如果希望 list() 方法的返回的集合仅包含 Department  对象, 可以在 HQL 查询语句中使用 SELECT 关键字</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public void <span class="function"><span class="title">testInnerJoin</span></span>()&#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			Session session=HibernateUtil.currentSession();</span><br><span class="line">			tx=session.beginTransaction();</span><br><span class="line">			String hql = <span class="string">"from Depts d join d.emps"</span>;	//d.emps为Depts表中的emps属性</span><br><span class="line">			List&lt;Object[]&gt; result=session.createQuery(hql).list();</span><br><span class="line">			<span class="keyword">for</span> (Object[] object : result) &#123;</span><br><span class="line">				System.out.println(((Depts)object[0]).getDeptName());</span><br><span class="line">				System.out.println(<span class="string">"\t"</span>+((Emps)object[1]).getUserName());</span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>(tx!=null)&#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public void <span class="function"><span class="title">testLeftJoin</span></span>()&#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			Session session=HibernateUtil.currentSession();</span><br><span class="line">			tx=session.beginTransaction();</span><br><span class="line">			String hql = <span class="string">"from Depts d left join d.emps"</span>; //from Emps e left join e.depts			</span><br><span class="line">			List&lt;Object[]&gt; result=session.createQuery(hql).list();</span><br><span class="line">			<span class="keyword">for</span> (Object[] object : result) &#123;</span><br><span class="line">				System.out.println(((Depts)object[0]).getDeptName());</span><br><span class="line">				System.out.println(<span class="string">"\t"</span>+((Emps)object[1]).getUserName());</span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>(tx!=null)&#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="迫切连接"><a href="#迫切连接" class="headerlink" title="迫切连接"></a>迫切连接</h4><p>迫切连接必须用属性接受</p>
<blockquote>
<p>INNER JOIN FETCH 关键字表示迫切内连接, 也可以省略 INNER 关键字<br>list() 方法返回的集合中存放Department对象的引用, 每个Department对象的 Employee 集合都被初始化, 存放所有关联的 Employee 对象<br>LEFT JOIN FETCH 关键字表示迫切左外连接检索策略.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">	 * 迫切左连接和迫切内连接，封装为最左边的属性，已经建立了关系</span><br><span class="line">	 * 普通连接和迫切连接的区别：关联属性的初始化状态</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void <span class="function"><span class="title">testLeftJoinFetch</span></span>()&#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			Session session=HibernateUtil.currentSession();</span><br><span class="line">			tx=session.beginTransaction();</span><br><span class="line">			String hql = <span class="string">"from Depts d left join fetch d.emps"</span>; 		</span><br><span class="line">			List&lt;Depts&gt; result=session.createQuery(hql).list();</span><br><span class="line">			<span class="keyword">for</span> (Depts depts : result) &#123;</span><br><span class="line">				System.out.println(depts.getDeptName());</span><br><span class="line">				<span class="keyword">for</span> (Emps emps : depts.getEmps()) &#123;</span><br><span class="line">					System.out.println(<span class="string">"\t"</span>+emps.getUserName());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>(tx!=null)&#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    @Test</span><br><span class="line">	public void <span class="function"><span class="title">testLeftJoinFetch1</span></span>()&#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			Session session=HibernateUtil.currentSession();</span><br><span class="line">			tx=session.beginTransaction();</span><br><span class="line">			String hql = <span class="string">"from Emps e left join fetch e.depts"</span>; 		</span><br><span class="line">			List&lt;Emps&gt; result=session.createQuery(hql).list();</span><br><span class="line">			<span class="keyword">for</span> (Emps emps : result) &#123;</span><br><span class="line">				System.out.println(emps.getUserName());</span><br><span class="line">				System.out.println(<span class="string">"\t"</span>+emps.getDepts().getDeptName());</span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>(tx!=null)&#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="等值连接-和普通内连接差不多"><a href="#等值连接-和普通内连接差不多" class="headerlink" title="等值连接(和普通内连接差不多)"></a>等值连接(和普通内连接差不多)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">	public void <span class="function"><span class="title">testLeftJoinFetch2</span></span>()&#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			Session session=HibernateUtil.currentSession();</span><br><span class="line">			tx=session.beginTransaction();</span><br><span class="line">			String hql = <span class="string">"from Depts d,Emps e where d=e.depts"</span>; 		</span><br><span class="line">			List&lt;Object[]&gt; result=session.createQuery(hql).list();</span><br><span class="line">			<span class="keyword">for</span> (Object[] object : result) &#123;</span><br><span class="line">				System.out.println(((Depts)object[0]).getDeptName());</span><br><span class="line">				System.out.println(<span class="string">"\t"</span>+((Emps)object[1]).getUserName());</span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>(tx!=null)&#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="隐式内连接"><a href="#隐式内连接" class="headerlink" title="隐式内连接"></a>隐式内连接</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">	 * 隐式内连接</span><br><span class="line">	 * from Emp e <span class="built_in">where</span> e.depts.deptName=<span class="string">''</span>  --用于<span class="built_in">where</span>子句</span><br><span class="line">	 * select empNo,empName,depts.deptName from Emps  --用于select子句</span><br><span class="line">	 * 根据关联关系自动使用等值连接，直接已对象的方式考虑条件</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void <span class="function"><span class="title">testLeftJoinFetch3</span></span>()&#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			Session session=HibernateUtil.currentSession();</span><br><span class="line">			tx=session.beginTransaction();</span><br><span class="line">			String hql = <span class="string">"from Emps e where e.depts.deptNo=1"</span>; 		</span><br><span class="line">			List result=session.createQuery(hql).list();</span><br><span class="line">			<span class="keyword">for</span> (Object object : result) &#123;</span><br><span class="line">				System.out.println(((Emps)object).getUserName()+<span class="string">"\t"</span>+((Emps)object).getDepts().getDeptName());</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>(tx!=null)&#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">     /**</span><br><span class="line">	 * 隐式内链接 select</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void <span class="function"><span class="title">testLeftJoinFetch4</span></span>()&#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			Session session=HibernateUtil.currentSession();</span><br><span class="line">			tx=session.beginTransaction();</span><br><span class="line">			String hql = <span class="string">"select userId,userName,depts.deptName from Emps"</span>; 		</span><br><span class="line">			List&lt;Object[]&gt; result=session.createQuery(hql).list();</span><br><span class="line">			<span class="keyword">for</span> (Object[] object : result) &#123;</span><br><span class="line">				System.out.println(object[0]+<span class="string">"\t"</span>+object[1]+<span class="string">"\t"</span>+object[2]);</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>(tx!=null)&#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><blockquote>
<p>count(),avg(),max(),min()<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">	 * hql聚合函数 count(),avg(),max(),min()</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void <span class="function"><span class="title">testLeftJoinFetch5</span></span>()&#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			Session session=HibernateUtil.currentSession();</span><br><span class="line">			tx=session.beginTransaction();</span><br><span class="line">			/*String hql = <span class="string">"select count(userId),e.deptId from Emps e group by e.deptId"</span>;*/</span><br><span class="line">			/*String hql = <span class="string">"select max(userId),min(userId) from Emps"</span>; */</span><br><span class="line">			/*String hql = <span class="string">"select max(userId),min(userId),e.deptNo  from Emps e group by e.deptNo"</span>; */</span><br><span class="line">			/*String hql = <span class="string">"select max(e.userId),d.deptName from Emps e,Depts d where e.depts=d group by d.deptName"</span>;*/</span><br><span class="line">			/*String hql = <span class="string">"select max(e.userId),depts.deptName from Emps e group by depts.deptName"</span>;*/</span><br><span class="line">			String hql = <span class="string">"select max(e.userId),depts.deptName from Emps e group by depts.deptName having depts.deptName='暗-部'"</span>;</span><br><span class="line">			List&lt;Object[]&gt; list=session.createQuery(hql).list();</span><br><span class="line">			<span class="keyword">for</span> (Object[] objects : list) &#123;</span><br><span class="line">				System.out.println(objects[0]+<span class="string">"\t"</span>+objects[1]);</span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>(tx!=null)&#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><blockquote>
<p>如果子查询返回多条记录，则可以使用下面关键字：</p>
<blockquote>
<p>all:表示子查询语句返回的所有记录<br>        any:表示子查询语句返回的任意一条结果<br>        some:与”any”等价<br>        in:与”=any”等价<br>        exists:表示子查询语句至少返回一条记录</p>
</blockquote>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">	 * 子查询</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void <span class="function"><span class="title">testLeftJoinFetch6</span></span>()&#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			Session session=HibernateUtil.currentSession();</span><br><span class="line">			tx=session.beginTransaction();</span><br><span class="line">			/*String hql = <span class="string">"select userId,userName,depts.deptName from Emps where userId &lt; (select max(userId) from Emps)"</span>; */</span><br><span class="line">			//any 任意一条</span><br><span class="line">			/*String hql = <span class="string">"select d.deptNo,d.deptName from Depts d where 5 &gt; any(select userId from Emps e where e.depts=d)"</span>;*/</span><br><span class="line">			//all 全部</span><br><span class="line">			/*String hql = <span class="string">"select d.deptNo,d.deptName from Depts d where 5 &gt; all(select userId from Emps e where e.depts=d)"</span>;*/</span><br><span class="line">			//<span class="keyword">in</span></span><br><span class="line">			/*String hql = <span class="string">"select d.deptNo,d.deptName from Depts d where 5 in(select userId from Emps e where e.depts=d)"</span>;*/</span><br><span class="line">			//size() 或.size</span><br><span class="line">			String hql = <span class="string">"select d.deptNo,d.deptName from Depts d where 5 &gt; all(select userId from Emps e where e.depts=d) and size(d.emps)&gt;0"</span>;</span><br><span class="line">			List&lt;Object[]&gt; result=session.createQuery(hql).list();</span><br><span class="line">			<span class="keyword">for</span> (Object[] object : result) &#123;</span><br><span class="line">				System.out.println(object[0]+<span class="string">"\t"</span>+object[1]+<span class="string">"\t"</span>);</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="keyword">if</span>(tx!=null)&#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="操作集合的函数属性或属性"><a href="#操作集合的函数属性或属性" class="headerlink" title="操作集合的函数属性或属性"></a>操作集合的函数属性或属性</h3><blockquote>
<p>size()或size:获取集合中的元素数目。<br>minIndex()或minIndex:对于建立索引的集合，获取最小的索引<br>maxIndex()或maxIndex:对于建立索引的集合，获取最大的索引。<br>minElement()或minElement:对于包含基本类型的元素集合，获得集合中取值最小的元素。<br>maxElement()或maxElement: 对于包含基本类型的元素集合，获得集合中取值最大的元素。<br>Elements();获取集合中的所有元素。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String hql = <span class="string">"select d.deptNo,d.deptName from Depts d where 5 &gt; all(select userId from Emps e where e.depts=d) and size(d.emps)&gt;0"</span>;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="查询性能优化"><a href="#查询性能优化" class="headerlink" title="查询性能优化"></a>查询性能优化</h3><blockquote>
<p><strong>hibernate查询优化策略</strong><br>（1.）使用迫切左外连接，或迫切连接查询策略，配置二级缓存和查询等方式，减少select语句数目，降低访问数据库的频率。<br>（2.）使用延迟加载等方式避免加载多余不需要访问的数据。<br>（3.）使用Query接口的iterate（）方法减少select语句的字段，降低访问数据库的数据量，并结合缓存等机制减少数据库的访问次数，提高查询效率。</p>
</blockquote>
<blockquote>
<p><strong>HQL优化</strong><br>（1.）避免使用or操作的不当。<br>（2.）避免使用not。<br>（3.）避免使用like的特殊形式。<br>（4.）避免使用having子句。<br>（5.）避免使用distinct。<br>（6.）索引在以下情况下失效，使用时注意。<br>                   对字段使用函数，该字段的索引将不起作用。如：substring（aa,1,2）=’xxx’<br>                   对字段进行计算，该字段的索引将不起作用。如：price+10。</p>
</blockquote>
<h3 id="hibernate注解"><a href="#hibernate注解" class="headerlink" title="hibernate注解"></a>hibernate注解</h3><h4 id="单对象操作"><a href="#单对象操作" class="headerlink" title="单对象操作"></a>单对象操作</h4><blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@Entity　　---&gt;　　如果我们当前这个bean要设置成实体对象，就需要加上Entity这个注解</span><br><span class="line">@Table(name=<span class="string">"t_user"</span>)　　----&gt;　　设置数据库的表名</span><br><span class="line">public class User</span><br><span class="line">&#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String username;</span><br><span class="line">    private String password;</span><br><span class="line">    private Date born;</span><br><span class="line">    private Date registerDate;</span><br><span class="line"></span><br><span class="line">    @Column(name=<span class="string">"register_date"</span>)　　---&gt;　　Column中的name属性对应了数据库的该字段名字，里面还有其他属性，例如length，nullable等等</span><br><span class="line">    public Date getRegisterDate()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> registerDate;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setRegisterDate(Date registerDate)</span><br><span class="line">    &#123;</span><br><span class="line">        this.registerDate = registerDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Id　　---&gt;　　定义为数据库的主键ID　　(建议不要在属性上引入注解，因为属性是private的，如果引入注解会破坏其封装特性，所以建议在getter方法上加入注解)</span><br><span class="line">    @GeneratedValue　　----&gt;　　ID的生成策略为自动生成　　</span><br><span class="line">    public int getId()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setId(int id)</span><br><span class="line">    &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"> 　　............</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="一对多的映射-one-to-many"><a href="#一对多的映射-one-to-many" class="headerlink" title="一对多的映射(one-to-many)"></a>一对多的映射(one-to-many)</h4><blockquote>
<p>ClassRoom类：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">@Table(name=<span class="string">"t_classroom"</span>)</span><br><span class="line">public class ClassRoom</span><br><span class="line">&#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String className;</span><br><span class="line">    private Set&lt;Student&gt; students;</span><br><span class="line">    </span><br><span class="line">    public ClassRoom()</span><br><span class="line">    &#123;</span><br><span class="line">        students = new HashSet&lt;Student&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void addStudent(Student student)</span><br><span class="line">    &#123;</span><br><span class="line">        students.add(student);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    public int getId()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(int id)</span><br><span class="line">    &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getClassName()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> className;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setClassName(String className)</span><br><span class="line">    &#123;</span><br><span class="line">        this.className = className;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @OneToMany(mappedBy=<span class="string">"room"</span>)　　---&gt;　　OneToMany指定了一对多的关系，mappedBy=<span class="string">"room"</span>指定了由多的那一方来维护关联关系，mappedBy指的是多的一方对1的这一方的依赖的属性，(注意：如果没有指定由谁来维护关联关系，则系统会给我们创建一张中间表)</span><br><span class="line">    @LazyCollection(LazyCollectionOption.EXTRA)　　---&gt;　　LazyCollection属性设置成EXTRA指定了当如果查询数据的个数时候，只会发出一条 count(*)的语句，提高性能</span><br><span class="line">    public Set&lt;Student&gt; getStudents()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> students;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setStudents(Set&lt;Student&gt; students)</span><br><span class="line">    &#123;</span><br><span class="line">        this.students = students;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Student类</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">@Table(name=<span class="string">"t_student"</span>)</span><br><span class="line">public class Student</span><br><span class="line">&#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line">    private ClassRoom room;</span><br><span class="line">    </span><br><span class="line">    @ManyToOne(fetch=FetchType.LAZY)　　---&gt; ManyToOne指定了多对一的关系，fetch=FetchType.LAZY属性表示在多的那一方通过延迟加载的方式加载对象(默认不是延迟加载)</span><br><span class="line">    @JoinColumn(name=<span class="string">"rid"</span>)　　---&gt;　　通过 JoinColumn 的name属性指定了外键的名称 rid　(注意：如果我们不通过JoinColum来指定外键的名称，系统会给我们声明一个名称)</span><br><span class="line">    public ClassRoom getRoom()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> room;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setRoom(ClassRoom room)</span><br><span class="line">    &#123;</span><br><span class="line">        this.room = room;</span><br><span class="line">    &#125;</span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    public int getId()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setId(int id)</span><br><span class="line">    &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getName()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setName(String name)</span><br><span class="line">    &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    public int getAge()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setAge(int age)</span><br><span class="line">    &#123;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="一对一映射-One-to-One"><a href="#一对一映射-One-to-One" class="headerlink" title="一对一映射(One-to-One)"></a>一对一映射(One-to-One)</h4><p>一对一关系这里定义了一个Person对象以及一个IDCard对象</p>
<blockquote>
<p>Person类</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">@Table(name=<span class="string">"t_person"</span>)</span><br><span class="line">public class Person</span><br><span class="line">&#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private IDCard card;</span><br><span class="line">    </span><br><span class="line">    @OneToOne(mappedBy=<span class="string">"person"</span>)　　---&gt;　　指定了OneToOne的关联关系，mappedBy同样指定由对方来进行维护关联关系</span><br><span class="line">    public IDCard getCard()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> card;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setCard(IDCard card)</span><br><span class="line">    &#123;</span><br><span class="line">        this.card = card;</span><br><span class="line">    &#125;</span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    public int getId()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setId(int id)</span><br><span class="line">    &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getName()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setName(String name)</span><br><span class="line">    &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>IDCard类</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">@Table(name=<span class="string">"t_id_card"</span>)</span><br><span class="line">public class IDCard</span><br><span class="line">&#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String no;</span><br><span class="line">    private Person person;</span><br><span class="line">    </span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    public int getId()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setId(int id)</span><br><span class="line">    &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getNo()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> no;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setNo(String no)</span><br><span class="line">    &#123;</span><br><span class="line">        this.no = no;</span><br><span class="line">    &#125;</span><br><span class="line">    @OneToOne　　---&gt;　　OnetoOne指定了一对一的关联关系，一对一中随便指定一方来维护映射关系，这里选择IDCard来进行维护</span><br><span class="line">    @JoinColumn(name=<span class="string">"pid"</span>)　　---&gt;　　指定外键的名字 pid</span><br><span class="line">    public Person getPerson()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> person;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setPerson(Person person)</span><br><span class="line">    &#123;</span><br><span class="line">        this.person = person;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>在判断到底是谁维护关联关系时，可以通过查看外键，哪个实体类定义了外键，哪个类就负责维护关联关系。</strong></p>
</blockquote>
<h4 id="Many-to-Many映射-多对多映射关系"><a href="#Many-to-Many映射-多对多映射关系" class="headerlink" title="Many-to-Many映射(多对多映射关系)"></a>Many-to-Many映射(多对多映射关系)</h4><p>通过中间表由任一一个多的一方来维护关联关系</p>
<blockquote>
<p>Teacher</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">@Table(name=<span class="string">"t_teacher"</span>)</span><br><span class="line">public class Teacher</span><br><span class="line">&#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private Set&lt;Course&gt; courses;</span><br><span class="line">    </span><br><span class="line">    public Teacher()</span><br><span class="line">    &#123;</span><br><span class="line">        courses = new HashSet&lt;Course&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    public void addCourse(Course course)</span><br><span class="line">    &#123;</span><br><span class="line">        courses.add(course);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    public int getId()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setId(int id)</span><br><span class="line">    &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getName()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setName(String name)</span><br><span class="line">    &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    @ManyToMany(mappedBy=<span class="string">"teachers"</span>)　　---&gt;　　表示由Course那一方来进行维护</span><br><span class="line">    public Set&lt;Course&gt; getCourses()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> courses;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setCourses(Set&lt;Course&gt; courses)</span><br><span class="line">    &#123;</span><br><span class="line">        this.courses = courses;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Course类</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">@Table(name=<span class="string">"t_course"</span>)</span><br><span class="line">public class Course</span><br><span class="line">&#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private Set&lt;Teacher&gt; teachers;</span><br><span class="line">    </span><br><span class="line">    public Course()</span><br><span class="line">    &#123;</span><br><span class="line">        teachers = new HashSet&lt;Teacher&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    public void addTeacher(Teacher teacher)</span><br><span class="line">    &#123;</span><br><span class="line">        teachers.add(teacher);</span><br><span class="line">    &#125;</span><br><span class="line">    @ManyToMany　　　---&gt;　ManyToMany指定多对多的关联关系</span><br><span class="line">    @JoinTable(name=<span class="string">"t_teacher_course"</span>, joinColumns=&#123; @JoinColumn(name=<span class="string">"cid"</span>)&#125;, </span><br><span class="line">    inverseJoinColumns=&#123; @JoinColumn(name = <span class="string">"tid"</span>) &#125;)　　---&gt;　　因为多对多之间会通过一张中间表来维护两表直接的关系，所以通过 JoinTable 这个注解来声明，name就是指定了中间表的名字，JoinColumns是一个 @JoinColumn类型的数组，表示的是我这方在对方中的外键名称，我方是Course，所以在对方外键的名称就是 rid，inverseJoinColumns也是一个 @JoinColumn类型的数组，表示的是对方在我这放中的外键名称，对方是Teacher，所以在我方外键的名称就是 tid</span><br><span class="line">    public Set&lt;Teacher&gt; getTeachers()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> teachers;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setTeachers(Set&lt;Teacher&gt; teachers)</span><br><span class="line">    &#123;</span><br><span class="line">        this.teachers = teachers;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    public int getId()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(int id)</span><br><span class="line">    &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name)</span><br><span class="line">    &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>通过hibernate来进行插入操作的时候，不管是一对多、一对一还是多对多，都只需要记住一点，在哪个实体类声明了外键，就由哪个类来维护关系，在保存数据时，总是先保存的是没有维护关联关系的那一方的数据，后保存维护了关联关系的那一方的数据</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/19/HQL连接查询和注解/" data-id="cjrabl6mf0000vkdqz9z1jxrv" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Oracle主键自增实现" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/16/Oracle主键自增实现/" class="article-date">
  <time datetime="2018-11-16T07:16:41.000Z" itemprop="datePublished">2018-11-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Oracle/">Oracle</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/16/Oracle主键自增实现/">Oracle主键自增实现</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Oracle没有这个”auto_increment”属性，所以它没法像MySQL般在表内定义自增主键。<br>但是，Oracle里的序列（SEQUENCE），可间接实现自增主键的作用。</p>
<p>序列（Sequence），又叫序列生成器，用于提供一系列的数字，开发人员使用序列生成唯一键。每次访问序列，序列按照一定的规律增加或者减少。<br>序列的定义存储在SYSTEM表空间中，序列不像表，它不会占用磁盘空间。<br>序列独立于事务，每次事务的提交和回滚都不会影响序列。</p>
<h3 id="创建用户数据表"><a href="#创建用户数据表" class="headerlink" title="创建用户数据表"></a>创建用户数据表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 创建用户数据表</span><br><span class="line">DROP TABLE DECTUSER;</span><br><span class="line">CREATE TABLE DECTUSER(</span><br><span class="line">       USERID INTEGER PRIMARY KEY,</span><br><span class="line">       NAME VARCHAR2(20),</span><br><span class="line">       SEX VARCHAR2(2)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="创建自动增长序列"><a href="#创建自动增长序列" class="headerlink" title="创建自动增长序列"></a>创建自动增长序列</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 创建自动增长序列</span><br><span class="line">DROP SEQUENCE DECTUSER_tb_seq;</span><br><span class="line">CREATE SEQUENCE DECTUSER_tb_seq MINVALUE 1 MAXVALUE 99999999</span><br><span class="line">INCREMENT BY 1</span><br><span class="line">START WITH 1;</span><br></pre></td></tr></table></figure>
<h3 id="创建触发器"><a href="#创建触发器" class="headerlink" title="创建触发器"></a>创建触发器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 创建触发器</span><br><span class="line">CREATE OR REPLACE TRIGGER DECTUSER_tb_tri</span><br><span class="line">BEFORE INSERT ON DECTUSER </span><br><span class="line">FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">SELECT DECTUSER_tb_seq.nextval INTO :NEW.USERID FROM DUAL;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>
<h3 id="尝试添加数据"><a href="#尝试添加数据" class="headerlink" title="尝试添加数据"></a>尝试添加数据</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 尝试添加数据</span><br><span class="line">INSERT INTO DECTUSER(NAME,SEX) VALUES(<span class="string">'憨八龟'</span>,<span class="string">'男'</span>)</span><br><span class="line">INSERT INTO DECTUSER(NAME,SEX) VALUES(<span class="string">'小火龙'</span>,<span class="string">'男'</span>)</span><br><span class="line">INSERT INTO DECTUSER(NAME,SEX) VALUES(<span class="string">'杰尼龟'</span>,<span class="string">'女'</span>)</span><br><span class="line">commit</span><br></pre></td></tr></table></figure>
<h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    USERID NAME                                     SEX</span><br><span class="line">---------- ---------------------------------------- ----------</span><br><span class="line">         1 憨八龟                                   男</span><br><span class="line">         2 小火龙                                   男</span><br><span class="line">         3 杰尼龟                                   女</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/16/Oracle主键自增实现/" data-id="cjrabl6nj000vvkdqs8c44g9p" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-镜花水月" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/14/镜花水月/" class="article-date">
  <time datetime="2018-11-14T15:00:24.000Z" itemprop="datePublished">2018-11-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/14/镜花水月/">镜花水月</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>只要是人都是依靠自己的知识与认知并且被之束缚生活着的，那就叫做现实。但是知识与认知是模糊不清的东西，现实也许只是镜中花水中月，人都是活在自己的执念中的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/14/镜花水月/" data-id="cjrabl6rt0047vkdqbep45b5v" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分享/">分享</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-SSM基础案例文件" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/11/SSM基础案例文件/" class="article-date">
  <time datetime="2018-11-11T14:25:11.000Z" itemprop="datePublished">2018-11-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SSM/">SSM</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/11/SSM基础案例文件/">SSM基础案例文件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="BaseController-java-这个基类用来设置继承他的子类的持久化类的date属性"><a href="#BaseController-java-这个基类用来设置继承他的子类的持久化类的date属性" class="headerlink" title="BaseController.java(这个基类用来设置继承他的子类的持久化类的date属性)"></a>BaseController.java(这个基类用来设置继承他的子类的持久化类的date属性)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@InitBinder</span><br><span class="line">	public void initBinder(WebDataBinder dataBinder)&#123;</span><br><span class="line">		System.out.println(<span class="string">"initBinder======================="</span>);</span><br><span class="line">		dataBinder.registerCustomEditor(Date.class, new CustomDateEditor(new SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>), <span class="literal">true</span>));</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="dao层接口与xml"><a href="#dao层接口与xml" class="headerlink" title="dao层接口与xml"></a>dao层接口与xml</h3><h4 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// 增加</span><br><span class="line">public int insertUser(User user);</span><br><span class="line"></span><br><span class="line">// 修改</span><br><span class="line">public int updateUser(User user);</span><br><span class="line"></span><br><span class="line">// 删除</span><br><span class="line">public int deleteUser(@Param(<span class="string">"uid"</span>) int uid);</span><br><span class="line"></span><br><span class="line">//删除地址</span><br><span class="line">public int deleteAddress(@Param(<span class="string">"uid"</span>) int uid);</span><br><span class="line"></span><br><span class="line">// 根据用户id查询地址信息</span><br><span class="line">public List&lt;User&gt; selectUser(@Param(<span class="string">"uid"</span>) int uid);</span><br><span class="line"></span><br><span class="line">// 根据地址id查询用户信息</span><br><span class="line">public List&lt;Address&gt; selectAddress(@Param(<span class="string">"addressid"</span>) int addressid);</span><br><span class="line"></span><br><span class="line">// 根据多个用户查询</span><br><span class="line">public List&lt;User&gt; selectUsers(UserVo vo);</span><br><span class="line"></span><br><span class="line">//动态trim模糊查询</span><br><span class="line">public List&lt;User&gt;seleteUserByUser(User user);</span><br><span class="line"></span><br><span class="line">//登录</span><br><span class="line">public User login(User user);</span><br><span class="line"></span><br><span class="line">//模糊查询</span><br><span class="line">public List&lt;User&gt;getUserList(User user);</span><br><span class="line"></span><br><span class="line">//根据id获取用户信息</span><br><span class="line">public User getUserById(@Param(<span class="string">"uid"</span>) int uid);</span><br><span class="line"></span><br><span class="line">//获取所有用户</span><br><span class="line">public List&lt;User&gt;getUsers();</span><br></pre></td></tr></table></figure>
<h4 id="xml-mapper映射"><a href="#xml-mapper映射" class="headerlink" title="xml(mapper映射)"></a>xml(mapper映射)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">PUBLIC <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">"cn.dao.UserMapper"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 增加 --&gt;</span><br><span class="line">	&lt;insert id=<span class="string">"insertUser"</span> parameterType=<span class="string">"User"</span>&gt;</span><br><span class="line">		INSERT INTO</span><br><span class="line">		user_info(user_name,user_pwd,user_birthday)VALUES(<span class="comment">#&#123;userName&#125;,#&#123;userPwd&#125;,#&#123;userBirthday&#125;)</span></span><br><span class="line">	&lt;/insert&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 动态trim修改 --&gt;</span><br><span class="line">	&lt;update id=<span class="string">"updateUser"</span> parameterType=<span class="string">"User"</span>&gt;</span><br><span class="line">		UPDATE user_info</span><br><span class="line">		&lt;trim prefix=<span class="string">"set"</span> suffixOverrides=<span class="string">","</span>&gt;</span><br><span class="line">			&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"userName!=null and userName!=''"</span>&gt;</span><br><span class="line">				user_name=<span class="comment">#&#123;userName&#125;,</span></span><br><span class="line">			&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">			&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"userPwd!=null and userPwd!=''"</span>&gt;</span><br><span class="line">				user_pwd=<span class="comment">#&#123;userPwd&#125;,</span></span><br><span class="line">			&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">			&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"userBirthday!=null and userBirthday!=''"</span>&gt;</span><br><span class="line">				user_birthday=<span class="comment">#&#123;userBirthday&#125;,</span></span><br><span class="line">			&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">		&lt;/trim&gt;</span><br><span class="line">		<span class="built_in">where</span> id=<span class="comment">#&#123;id&#125;</span></span><br><span class="line">	&lt;/update&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 删除 --&gt;</span><br><span class="line">	&lt;delete id=<span class="string">"deleteUser"</span> parameterType=<span class="string">"int"</span>&gt;</span><br><span class="line">		DELETE from user_info</span><br><span class="line">		WHERE id=<span class="comment">#&#123;uid&#125;</span></span><br><span class="line">	&lt;/delete&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 删除地址 --&gt;</span><br><span class="line">	&lt;delete id=<span class="string">"deleteAddress"</span> parameterType=<span class="string">"int"</span>&gt;</span><br><span class="line">		DELETE from</span><br><span class="line">		address_info WHERE user_id=<span class="comment">#&#123;uid&#125;</span></span><br><span class="line">	&lt;/delete&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- trim查询user --&gt;</span><br><span class="line">	&lt;select id=<span class="string">"seleteUserByUser"</span> resultMap=<span class="string">"UserList"</span></span><br><span class="line">		parameterType=<span class="string">"User"</span>&gt;</span><br><span class="line">		SELECT *FROM user_info WHERE user_name=<span class="comment">#&#123;userName&#125; and</span></span><br><span class="line">		user_pwd=<span class="comment">#&#123;userPwd&#125;</span></span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;resultMap <span class="built_in">type</span>=<span class="string">"User"</span> id=<span class="string">"UserList"</span>&gt;</span><br><span class="line">		&lt;result property=<span class="string">"id"</span> column=<span class="string">"id"</span> /&gt;</span><br><span class="line">		&lt;result property=<span class="string">"userName"</span> column=<span class="string">"user_name"</span> /&gt;</span><br><span class="line">		&lt;result property=<span class="string">"userPwd"</span> column=<span class="string">"user_pwd"</span> /&gt;</span><br><span class="line">		&lt;result property=<span class="string">"userBirthday"</span> column=<span class="string">"user_birthday"</span> /&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 根据用户id查询地址信息 --&gt;</span><br><span class="line">	&lt;select id=<span class="string">"selectUser"</span> parameterType=<span class="string">"User"</span> resultMap=<span class="string">"getAddress"</span>&gt;</span><br><span class="line">		SELECT *</span><br><span class="line">		FROM user_info u,address_info a WHERE a.user_id=u.id AND</span><br><span class="line">		u.id=<span class="comment">#&#123;uid&#125;</span></span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;resultMap <span class="built_in">type</span>=<span class="string">"User"</span> id=<span class="string">"getAddress"</span>&gt;</span><br><span class="line">		&lt;result property=<span class="string">"id"</span> column=<span class="string">"id"</span> /&gt;</span><br><span class="line">		&lt;result property=<span class="string">"userName"</span> column=<span class="string">"user_name"</span> /&gt;</span><br><span class="line">		&lt;result property=<span class="string">"userPwd"</span> column=<span class="string">"user_pwd"</span> /&gt;</span><br><span class="line">		&lt;result property=<span class="string">"userBirthday"</span> column=<span class="string">"user_birthday"</span> /&gt;</span><br><span class="line">		&lt;collection property=<span class="string">"addresses"</span> ofType=<span class="string">"Address"</span>&gt;</span><br><span class="line">			&lt;result property=<span class="string">"id"</span> column=<span class="string">"id"</span> /&gt;</span><br><span class="line">			&lt;result property=<span class="string">"addressName"</span> column=<span class="string">"address_name"</span> /&gt;</span><br><span class="line">			&lt;result property=<span class="string">"userId"</span> column=<span class="string">"user_id"</span> /&gt;</span><br><span class="line">		&lt;/collection&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 根据地址id查询用户信息 --&gt;</span><br><span class="line">	&lt;select id=<span class="string">"selectAddress"</span> resultMap=<span class="string">"getUser"</span>&gt;</span><br><span class="line">		SELECT * FROM user_info</span><br><span class="line">		u,address_info a WHERE a.user_id=u.id AND</span><br><span class="line">		a.id=<span class="comment">#&#123;addressid&#125;</span></span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;resultMap <span class="built_in">type</span>=<span class="string">"Address"</span> id=<span class="string">"getUser"</span>&gt;</span><br><span class="line">		&lt;result property=<span class="string">"id"</span> column=<span class="string">"id"</span> /&gt;</span><br><span class="line">		&lt;result property=<span class="string">"addressName"</span> column=<span class="string">"address_name"</span> /&gt;</span><br><span class="line">		&lt;result property=<span class="string">"userId"</span> column=<span class="string">"user_id"</span> /&gt;</span><br><span class="line">		&lt;association property=<span class="string">"user"</span> javaType=<span class="string">"User"</span>&gt;</span><br><span class="line">			&lt;result property=<span class="string">"id"</span> column=<span class="string">"id"</span> /&gt;</span><br><span class="line">			&lt;result property=<span class="string">"userName"</span> column=<span class="string">"user_name"</span> /&gt;</span><br><span class="line">			&lt;result property=<span class="string">"userPwd"</span> column=<span class="string">"user_pwd"</span> /&gt;</span><br><span class="line">			&lt;result property=<span class="string">"userBirthday"</span> column=<span class="string">"user_birthday"</span> /&gt;</span><br><span class="line">		&lt;/association&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 根据多个用户查询 --&gt;</span><br><span class="line">	&lt;select id=<span class="string">"selectUsers"</span> parameterType=<span class="string">"UserVo"</span> resultMap=<span class="string">"UserList"</span>&gt;</span><br><span class="line">		SELECT * FROM user_info</span><br><span class="line">		&lt;<span class="built_in">where</span>&gt;</span><br><span class="line">			&lt;foreach collection=<span class="string">"list"</span> item=<span class="string">"id"</span> open=<span class="string">"and ("</span> close=<span class="string">")"</span></span><br><span class="line">				separator=<span class="string">"or"</span>&gt;</span><br><span class="line">				id=<span class="comment">#&#123;id&#125;</span></span><br><span class="line">			&lt;/foreach&gt;</span><br><span class="line">		&lt;/<span class="built_in">where</span>&gt;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 登录 --&gt;</span><br><span class="line">	&lt;select id=<span class="string">"login"</span> resultMap=<span class="string">"UserList"</span> parameterType=<span class="string">"User"</span>&gt;</span><br><span class="line">		SELECT *</span><br><span class="line">		FROM user_info WHERE user_name=<span class="comment">#&#123;userName&#125; and user_pwd=#&#123;userPwd&#125;</span></span><br><span class="line">	&lt;/select&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 模糊查询 --&gt;</span><br><span class="line">	&lt;select id=<span class="string">"getUserList"</span> resultMap=<span class="string">"UserList"</span> parameterType=<span class="string">"User"</span>&gt;</span><br><span class="line">		SELECT * FROM user_info</span><br><span class="line">		&lt;trim prefix=<span class="string">"where"</span> prefixOverrides=<span class="string">"and | or"</span>&gt;</span><br><span class="line">			&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"userName!=null and userName!=''"</span>&gt;</span><br><span class="line">				and user_name like CONCAT(<span class="string">'%'</span>,<span class="comment">#&#123;userName&#125;,'%')</span></span><br><span class="line">			&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">			&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"id!=null and id!=''"</span>&gt;</span><br><span class="line">				and id=<span class="comment">#&#123;id&#125;</span></span><br><span class="line">			&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">		&lt;/trim&gt;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 根据id获取用户信息 --&gt;</span><br><span class="line">	&lt;select id=<span class="string">"getUserById"</span> resultMap=<span class="string">"UserList"</span>&gt;</span><br><span class="line">		select * from user_info <span class="built_in">where</span> id=<span class="comment">#&#123;uid&#125;</span></span><br><span class="line">	&lt;/select&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 获取所有用户 --&gt;</span><br><span class="line">	&lt;select id=<span class="string">"getUsers"</span> resultMap=<span class="string">"UserList"</span>&gt;</span><br><span class="line">		select * from user_info</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<h3 id="pojo类-持久化类包括JSR-303验证"><a href="#pojo类-持久化类包括JSR-303验证" class="headerlink" title="pojo类(持久化类包括JSR-303验证)"></a>pojo类(持久化类包括JSR-303验证)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//id</span><br><span class="line">	private int id;</span><br><span class="line">	</span><br><span class="line">	//name</span><br><span class="line">	@NotEmpty(message=<span class="string">"用户名称不能为空"</span>)</span><br><span class="line">	private String userName;</span><br><span class="line">	</span><br><span class="line">	//<span class="built_in">pwd</span></span><br><span class="line">	@NotEmpty(message=<span class="string">"用户密码不能为空"</span>)</span><br><span class="line">	private String userPwd;</span><br><span class="line">	</span><br><span class="line">	//birthday</span><br><span class="line">	@JSONField(format=<span class="string">"yyyy-MM-dd"</span>)</span><br><span class="line">	private Date userBirthday;</span><br></pre></td></tr></table></figure>
<h3 id="service层-实现类"><a href="#service层-实现类" class="headerlink" title="service层(实现类)"></a>service层(实现类)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">@Service(<span class="string">"userServiceImpl"</span>)</span><br><span class="line">public class UserServiceImpl implements UserService &#123;</span><br><span class="line">	</span><br><span class="line">	@Autowired</span><br><span class="line">	@Qualifier(<span class="string">"userMapper"</span>)</span><br><span class="line">	private UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">	public UserMapper <span class="function"><span class="title">getUserMapper</span></span>() &#123;</span><br><span class="line">		<span class="built_in">return</span> userMapper;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setUserMapper(UserMapper userMapper) &#123;</span><br><span class="line">		this.userMapper = userMapper;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public int addUser(User user) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.insertUser(user);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public int modifyUser(User user) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.updateUser(user);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public int removerUser(int uid) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		userMapper.deleteAddress(uid);</span><br><span class="line">		<span class="built_in">return</span> userMapper.deleteUser(uid);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;User&gt; findUser(int uid) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.selectUser(uid);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;Address&gt; findAddress(int addressid) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.selectAddress(addressid);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;User&gt; findUsers(UserVo vo) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.selectUsers(vo);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;User&gt; findUserByUser(User user) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.seleteUserByUser(user);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public int deleteAddress(int uid) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.deleteAddress(uid);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public User login(User user) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.login(user);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;User&gt; getUserList(User user) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.getUserList(user);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public User getUserById(int uid) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.getUserById(uid);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;User&gt; <span class="function"><span class="title">getUsers</span></span>() &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		<span class="built_in">return</span> userMapper.getUsers();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="logger-AOP"><a href="#logger-AOP" class="headerlink" title="logger(AOP)"></a>logger(AOP)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 定义切面</span><br><span class="line"> * @author F117</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">@Aspect</span><br><span class="line">public class logger &#123;</span><br><span class="line">	private static final Logger LOGGER=Logger.getLogger(logger.class);</span><br><span class="line">	@Pointcut(<span class="string">"execution(* cn.service..*.*(..))"</span>)</span><br><span class="line">	public void <span class="function"><span class="title">Pointcut</span></span>()&#123;&#125;</span><br><span class="line">	</span><br><span class="line">	@AfterReturning(pointcut=<span class="string">"Pointcut()"</span>,returning=<span class="string">"returnCalue"</span>)</span><br><span class="line">	public void afterReturning(JoinPoint jp,Object returnCalue)&#123;</span><br><span class="line">		LOGGER.info(<span class="string">"调用"</span>+jp.getTarget()+<span class="string">"的"</span>+jp.getSignature().getName()+<span class="string">"方法,返回值"</span>+returnCalue);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Around(<span class="string">"Pointcut()"</span>)</span><br><span class="line">	public Object aroundLogger(ProceedingJoinPoint jp) throws Throwable&#123;</span><br><span class="line">		LOGGER.info(<span class="string">"调用"</span>+jp.getTarget()+<span class="string">"的"</span>+jp.getSignature().getName()+<span class="string">"方法,方法入参"</span>+Arrays.toString(jp.getArgs()));</span><br><span class="line">		try &#123;</span><br><span class="line">			Object result=jp.proceed();</span><br><span class="line">			LOGGER.info(<span class="string">"调用"</span>+jp.getTarget()+<span class="string">"的"</span>+jp.getSignature().getName()+<span class="string">"方法,返回值"</span>+result);</span><br><span class="line">			<span class="built_in">return</span> result;</span><br><span class="line">		&#125; catch (Throwable e) &#123;</span><br><span class="line">			// TODO: handle exception</span><br><span class="line">			throw e;</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			LOGGER.info(<span class="string">"====&gt;"</span>+jp.getSignature().getName()+<span class="string">"方法结束"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="StringToDateConverter-自定义转换器"><a href="#StringToDateConverter-自定义转换器" class="headerlink" title="StringToDateConverter(自定义转换器)"></a>StringToDateConverter(自定义转换器)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public class StringToDateConverter implements Converter&lt;String, Date&gt; &#123;</span><br><span class="line"></span><br><span class="line">	private String dataPattern;</span><br><span class="line">	</span><br><span class="line">	public StringToDateConverter(String dataPattern) &#123;</span><br><span class="line">		System.out.println(<span class="string">"StringToDateConverter conver"</span>+dataPattern);</span><br><span class="line">		this.dataPattern=dataPattern;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Override</span><br><span class="line">	public Date convert(String s) &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		Date date=null;</span><br><span class="line">		try &#123;</span><br><span class="line">			date= new SimpleDateFormat(dataPattern).parse(s);</span><br><span class="line">			System.out.println(<span class="string">"convert date:"</span>+date);</span><br><span class="line">		&#125; catch (ParseException e) &#123;</span><br><span class="line">			// TODO Auto-generated catch block</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> date;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="applicationContextl-xml"><a href="#applicationContextl-xml" class="headerlink" title="applicationContextl.xml"></a>applicationContextl.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">"http://www.springframework.org/schema/beans"</span></span><br><span class="line">	xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> xmlns:p=<span class="string">"http://www.springframework.org/schema/p"</span></span><br><span class="line">	xmlns:aop=<span class="string">"http://www.springframework.org/schema/aop"</span> xmlns:tx=<span class="string">"http://www.springframework.org/schema/tx"</span></span><br><span class="line">	xmlns:context=<span class="string">"http://www.springframework.org/schema/context"</span></span><br><span class="line">	xsi:schemaLocation=<span class="string">"http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/aop</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/aop/spring-aop-3.2.xsd</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/tx</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/tx/spring-tx-3.2.xsd </span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/context/spring-context-3.2.xsd"</span>&gt;</span><br><span class="line"></span><br><span class="line">	&lt;context:component-scan base-package=<span class="string">"cn.service"</span>&gt;&lt;/context:component-scan&gt;</span><br><span class="line">	&lt;context:component-scan base-package=<span class="string">"cn.controller"</span>&gt;&lt;/context:component-scan&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</span><br><span class="line">	&lt;bean class=<span class="string">"cn.tool.logger"</span> /&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 读取数据库配置文件 --&gt;</span><br><span class="line">	&lt;context:property-placeholder location=<span class="string">"classpath:database.properties"</span> /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- JNDI获取数据源(使用dbcp连接池) --&gt;</span><br><span class="line">	&lt;bean class=<span class="string">"org.apache.commons.dbcp.BasicDataSource"</span></span><br><span class="line">		destroy-method=<span class="string">"close"</span> scope=<span class="string">"singleton"</span> id=<span class="string">"dataSource"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"driverClassName"</span> value=<span class="string">"<span class="variable">$&#123;driver&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"url"</span> value=<span class="string">"<span class="variable">$&#123;url&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"username"</span> value=<span class="string">"<span class="variable">$&#123;user&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"password"</span> value=<span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"initialSize"</span> value=<span class="string">"<span class="variable">$&#123;initialSize&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"maxActive"</span> value=<span class="string">"<span class="variable">$&#123;maxActive&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"maxIdle"</span> value=<span class="string">"<span class="variable">$&#123;maxIdle&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"minIdle"</span> value=<span class="string">"<span class="variable">$&#123;minIdle&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"maxWait"</span> value=<span class="string">"<span class="variable">$&#123;maxWait&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"removeAbandonedTimeout"</span> value=<span class="string">"<span class="variable">$&#123;removeAbandonedTimeout&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"removeAbandoned"</span> value=<span class="string">"<span class="variable">$&#123;removeAbandoned&#125;</span>"</span> /&gt;</span><br><span class="line">		&lt;!-- sql 心跳 --&gt;</span><br><span class="line">		&lt;property name=<span class="string">"testWhileIdle"</span> value=<span class="string">"true"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"testOnBorrow"</span> value=<span class="string">"false"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"testOnReturn"</span> value=<span class="string">"false"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"validationQuery"</span> value=<span class="string">"select 1"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"timeBetweenEvictionRunsMillis"</span> value=<span class="string">"60000"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"numTestsPerEvictionRun"</span> value=<span class="string">"<span class="variable">$&#123;maxActive&#125;</span>"</span> /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 配置SqlSessionFactoryBean --&gt;</span><br><span class="line">	&lt;bean id=<span class="string">"sqlSessionFactory"</span> class=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"dataSource"</span> ref=<span class="string">"dataSource"</span>&gt;&lt;/property&gt;</span><br><span class="line">		&lt;property name=<span class="string">"configLocation"</span> value=<span class="string">"classpath:mybatis-configl.xml"</span>&gt;&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 配置Dao --&gt;</span><br><span class="line">	&lt;bean class=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"basePackage"</span> value=<span class="string">"cn.dao"</span>&gt;&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 事务管理器 --&gt;</span><br><span class="line">	&lt;bean id=<span class="string">"txManager"</span></span><br><span class="line">		class=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"dataSource"</span> ref=<span class="string">"dataSource"</span>&gt;&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- 事务增强 --&gt;</span><br><span class="line">	&lt;tx:advice id=<span class="string">"txAdvice"</span> transaction-manager=<span class="string">"txManager"</span>&gt;</span><br><span class="line">		&lt;tx:attributes&gt;</span><br><span class="line">			&lt;tx:method name=<span class="string">"*"</span> propagation=<span class="string">"REQUIRED"</span> /&gt;</span><br><span class="line">		&lt;/tx:attributes&gt;</span><br><span class="line">	&lt;/tx:advice&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- 配置切面 --&gt;</span><br><span class="line">	&lt;aop:config&gt;</span><br><span class="line">		&lt;aop:pointcut expression=<span class="string">"execution(* cn.service..*.*(..))"</span></span><br><span class="line">			id=<span class="string">"myPoint"</span> /&gt;</span><br><span class="line">		&lt;aop:advisor advice-ref=<span class="string">"txAdvice"</span> pointcut-ref=<span class="string">"myPoint"</span> /&gt;</span><br><span class="line">	&lt;/aop:config&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<h3 id="database-properties"><a href="#database-properties" class="headerlink" title="database.properties"></a>database.properties</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">driver=com.mysql.jdbc.Driver</span><br><span class="line">url=jdbc:mysql://localhost:3306/sm_db?useUnicode=<span class="literal">true</span>&amp;characterEncoding=utf-8</span><br><span class="line">user=root</span><br><span class="line">password=root</span><br><span class="line">minIdle=45</span><br><span class="line">maxIdle=50</span><br><span class="line">initialSize=5</span><br><span class="line">maxActive=100</span><br><span class="line">maxWait=100</span><br><span class="line">removeAbandonedTimeout=180</span><br><span class="line">removeAbandoned=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="log4j-properties"><a href="#log4j-properties" class="headerlink" title="log4j.properties"></a>log4j.properties</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">log4j.rootLogger=DEBUG,CONSOLE,file</span><br><span class="line"><span class="comment">#log4j.rootLogger=ERROR,ROLLING_FILE</span></span><br><span class="line">log4j.logger.cn.smbms.dao=debug</span><br><span class="line">log4j.logger.com.ibatis=debug </span><br><span class="line">log4j.logger.com.ibatis.common.jdbc.SimpleDataSource=debug </span><br><span class="line">log4j.logger.com.ibatis.common.jdbc.ScriptRunner=debug </span><br><span class="line">log4j.logger.com.ibatis.sqlmap.engine.impl.SqlMapClientDelegate=debug </span><br><span class="line">log4j.logger.java.sql.Connection=debug </span><br><span class="line">log4j.logger.java.sql.Statement=debug </span><br><span class="line">log4j.logger.java.sql.PreparedStatement=debug </span><br><span class="line">log4j.logger.java.sql.ResultSet=debug </span><br><span class="line">log4j.logger.org.tuckey.web.filters.urlrewrite.UrlRewriteFilter=debug</span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################################################</span></span><br><span class="line"><span class="comment"># Console Appender  \u65e5\u5fd7\u5728\u63a7\u5236\u8f93\u51fa\u914d\u7f6e</span></span><br><span class="line"><span class="comment">######################################################################################</span></span><br><span class="line">log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.Threshold=error</span><br><span class="line">log4j.appender.CONSOLE.Target=System.out</span><br><span class="line">log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.CONSOLE.layout.ConversionPattern= [%p] %d %c - %m%n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################################################</span></span><br><span class="line"><span class="comment"># DailyRolling File  \u6bcf\u5929\u4ea7\u751f\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u683c\u5f0f:log2009-09-11</span></span><br><span class="line"><span class="comment">######################################################################################</span></span><br><span class="line">log4j.appender.file=org.apache.log4j.DailyRollingFileAppender</span><br><span class="line">log4j.appender.file.DatePattern=yyyy-MM-dd</span><br><span class="line">log4j.appender.file.File=log.log</span><br><span class="line">log4j.appender.file.Append=<span class="literal">true</span></span><br><span class="line">log4j.appender.file.Threshold=error</span><br><span class="line">log4j.appender.file.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.file.layout.ConversionPattern=%d&#123;yyyy-M<span class="_">-d</span> HH:mm:ss&#125;%x[%5p](%F:%L) %m%n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">log4j.logger.com.opensymphony.xwork2=error</span><br></pre></td></tr></table></figure>
<h3 id="mybatis-configl-xml"><a href="#mybatis-configl-xml" class="headerlink" title="mybatis-configl.xml"></a>mybatis-configl.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">PUBLIC <span class="string">"-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;!-- 配置mybatis的<span class="built_in">log</span>实现为LOG4J --&gt;</span><br><span class="line">	&lt;settings&gt;</span><br><span class="line">		&lt;!-- &lt;setting name=<span class="string">"logImpl"</span> value=<span class="string">"LOG4J"</span> /&gt; --&gt;</span><br><span class="line">		&lt;setting name=<span class="string">"lazyLoadingEnabled"</span> value=<span class="string">"false"</span>/&gt;</span><br><span class="line">		&lt;setting name=<span class="string">"autoMappingBehavior"</span> value=<span class="string">"FULL"</span>/&gt;</span><br><span class="line">	&lt;/settings&gt;</span><br><span class="line">	&lt;typeAliases&gt;</span><br><span class="line">	&lt;package name=<span class="string">"cn.pojo"</span>/&gt;</span><br><span class="line">	&lt;/typeAliases&gt;</span><br><span class="line"></span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h3 id="springmvc-servlet-xml"><a href="#springmvc-servlet-xml" class="headerlink" title="springmvc-servlet.xml"></a>springmvc-servlet.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">"http://www.springframework.org/schema/beans"</span></span><br><span class="line">	xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> xmlns:mvc=<span class="string">"http://www.springframework.org/schema/mvc"</span></span><br><span class="line">	xmlns:p=<span class="string">"http://www.springframework.org/schema/p"</span> xmlns:context=<span class="string">"http://www.springframework.org/schema/context"</span></span><br><span class="line">	xsi:schemaLocation=<span class="string">"</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/mvc</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 配置处理器映射 HandlerMapping --&gt;</span><br><span class="line">	&lt;!-- &lt;bean name=<span class="string">"/index.html"</span> class=<span class="string">"cn.smbms.controller.IndexController"</span> </span><br><span class="line">		/&gt; --&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- &lt;bean name=<span class="string">"/welcome"</span> class=<span class="string">"cn.smbms.controller.IndexController"</span> /&gt; --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- &lt;bean id=<span class="string">"conversionService"</span> class=<span class="string">"org.springframework.context.support.ConversionServiceFactoryBean"</span>&gt; </span><br><span class="line">		&lt;/bean&gt; --&gt;</span><br><span class="line">	&lt;context:component-scan base-package=<span class="string">"cn.controller"</span> /&gt;</span><br><span class="line">	&lt;!-- 自定义转换器 --&gt;</span><br><span class="line">	&lt;bean id=<span class="string">"myConversionService"</span> class=<span class="string">"org.springframework.context.support.ConversionServiceFactoryBean"</span>&gt; </span><br><span class="line">		&lt;property name=<span class="string">"converters"</span>&gt; &lt;list&gt; &lt;bean class=<span class="string">"cn.tool.StringToDateConverter"</span>&gt; </span><br><span class="line">		&lt;constructor-arg <span class="built_in">type</span>=<span class="string">"java.lang.String"</span> value=<span class="string">"yyyy-MM-dd"</span> /&gt; &lt;/bean&gt; &lt;/list&gt; </span><br><span class="line">		&lt;/property&gt; &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;mvc:annotation-driven&gt;</span><br><span class="line">		&lt;!-- 消息转换器 --&gt;</span><br><span class="line">		&lt;mvc:message-converters&gt;</span><br><span class="line">			&lt;bean class=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>&gt;</span><br><span class="line">				&lt;property name=<span class="string">"supportedMediaTypes"</span>&gt;</span><br><span class="line">					&lt;list&gt;</span><br><span class="line">						&lt;value&gt;application/json;charset=UTF-8&lt;/value&gt;</span><br><span class="line">					&lt;/list&gt;</span><br><span class="line">				&lt;/property&gt;</span><br><span class="line">			&lt;/bean&gt;</span><br><span class="line">			&lt;bean</span><br><span class="line">				class=<span class="string">"com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter"</span>&gt;</span><br><span class="line">				&lt;property name=<span class="string">"supportedMediaTypes"</span>&gt;</span><br><span class="line">					&lt;list&gt;</span><br><span class="line">						&lt;value&gt;application/json;charset=UTF-8&lt;/value&gt;</span><br><span class="line">					&lt;/list&gt;</span><br><span class="line">				&lt;/property&gt;</span><br><span class="line">				&lt;property name=<span class="string">"features"</span>&gt;</span><br><span class="line">					&lt;list&gt;</span><br><span class="line">						&lt;value&gt;WriteDateUseDateFormat&lt;/value&gt;</span><br><span class="line">					&lt;/list&gt;</span><br><span class="line">				&lt;/property&gt;</span><br><span class="line">			&lt;/bean&gt;</span><br><span class="line">		&lt;/mvc:message-converters&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/mvc:annotation-driven&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 完成视图的对应 --&gt;</span><br><span class="line">	&lt;!-- 对转向页面的路径解析。prefix：前缀， suffix：后缀 --&gt;</span><br><span class="line">	&lt;!-- &lt;bean class=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt; </span><br><span class="line">		&lt;property name=<span class="string">"prefix"</span> value=<span class="string">"/WEB-INF/jsp/"</span> /&gt; &lt;property name=<span class="string">"suffix"</span> </span><br><span class="line">		value=<span class="string">".jsp"</span> /&gt; &lt;/bean&gt; --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!-- 配置多视图解析器 ：允许统一的内容数据呈现在不同的view中 --&gt;</span><br><span class="line">	&lt;bean</span><br><span class="line">		class=<span class="string">"org.springframework.web.servlet.view.ContentNegotiatingViewResolver"</span>&gt;</span><br><span class="line">		&lt;!-- 支持参数匹配 --&gt;</span><br><span class="line">		&lt;property name=<span class="string">"favorParameter"</span> value=<span class="string">"true"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"mediaTypes"</span>&gt;</span><br><span class="line">			&lt;map&gt;</span><br><span class="line">				&lt;entry key=<span class="string">"html"</span> value=<span class="string">"text/html;charset=UTF-8"</span>&gt;&lt;/entry&gt;</span><br><span class="line">				&lt;entry key=<span class="string">"json"</span> value=<span class="string">"application/json;charset=UTF-8"</span>&gt;&lt;/entry&gt;</span><br><span class="line">				&lt;entry key=<span class="string">"xml"</span> value=<span class="string">"application/xml;charset=UTF-8"</span>&gt;&lt;/entry&gt;</span><br><span class="line">			&lt;/map&gt;</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line">		&lt;!-- 网页视图解析器 --&gt;</span><br><span class="line">		&lt;property name=<span class="string">"viewResolvers"</span>&gt;</span><br><span class="line">			&lt;list&gt;</span><br><span class="line">				&lt;bean</span><br><span class="line">					class=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span><br><span class="line">					&lt;property name=<span class="string">"prefix"</span> value=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span><br><span class="line">					&lt;property name=<span class="string">"suffix"</span> value=<span class="string">".jsp"</span> /&gt;</span><br><span class="line">				&lt;/bean&gt;</span><br><span class="line">			&lt;/list&gt;</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;mvc:resources location=<span class="string">"/statics/"</span> mapping=<span class="string">"/statics/**"</span>&gt;&lt;/mvc:resources&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- 全局异常的配置 --&gt;</span><br><span class="line">	&lt;bean</span><br><span class="line">		class=<span class="string">"org.springframework.web.servlet.handler.SimpleMappingExceptionResolver"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"exceptionMappings"</span>&gt;</span><br><span class="line">			&lt;props&gt;</span><br><span class="line">				&lt;prop key=<span class="string">"java.lang.RuntimeException"</span>&gt;error&lt;/prop&gt;</span><br><span class="line">			&lt;/props&gt;</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- 配置MulitpartResolver，用于文件上传 --&gt;</span><br><span class="line">	&lt;bean id=<span class="string">"multipartResolver"</span></span><br><span class="line">		class=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">"maxUploadSize"</span> value=<span class="string">"5000000"</span> /&gt;</span><br><span class="line">		&lt;property name=<span class="string">"defaultEncoding"</span> value=<span class="string">"utf-8"</span> /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<h3 id="web-xml"><a href="#web-xml" class="headerlink" title="web.xml"></a>web.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;web-app xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> xmlns=<span class="string">"http://java.sun.com/xml/ns/javaee"</span> xsi:schemaLocation=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> id=<span class="string">"WebApp_ID"</span> version=<span class="string">"3.0"</span>&gt;</span><br><span class="line">  &lt;display-name&gt;CG09&lt;/display-name&gt;</span><br><span class="line">   &lt;!-- 配置环境参数，指定spring配置文件的所在目录--&gt;</span><br><span class="line">  &lt;context-param&gt;</span><br><span class="line">    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;classpath:applicationContextl.xml&lt;/param-value&gt;</span><br><span class="line">  &lt;/context-param&gt;</span><br><span class="line">  &lt;!-- 配置spring的ContextLoaderListener监听器，初始化spring容器--&gt;</span><br><span class="line">  &lt;listener&gt;</span><br><span class="line">    &lt;listener-class&gt;</span><br><span class="line">   		org.springframework.web.context.ContextLoaderListener</span><br><span class="line">  	&lt;/listener-class&gt;</span><br><span class="line">  &lt;/listener&gt;</span><br><span class="line">  &lt;welcome-file-list&gt;</span><br><span class="line">    &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;index.htm&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;default.html&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;default.htm&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;default.jsp&lt;/welcome-file&gt;</span><br><span class="line">  &lt;/welcome-file-list&gt;</span><br><span class="line">  &lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-class&gt;</span><br><span class="line">  		org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">  	&lt;/servlet-class&gt;</span><br><span class="line">    &lt;init-param&gt;</span><br><span class="line">      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</span><br><span class="line">      &lt;param-value&gt;classpath:springmvc-servlet.xml&lt;/param-value&gt;</span><br><span class="line">    &lt;/init-param&gt;</span><br><span class="line">    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line">  &lt;/servlet&gt;</span><br><span class="line">  &lt;servlet-mapping&gt;</span><br><span class="line">    &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span><br><span class="line">  &lt;/servlet-mapping&gt;</span><br><span class="line">  &lt;filter&gt;</span><br><span class="line">    &lt;filter-name&gt;characterEncoding&lt;/filter-name&gt;</span><br><span class="line">    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter &lt;/filter-class&gt;</span><br><span class="line">    &lt;init-param&gt;</span><br><span class="line">      &lt;param-name&gt;encoding&lt;/param-name&gt;</span><br><span class="line">      &lt;param-value&gt;UTF-8&lt;/param-value&gt;</span><br><span class="line">    &lt;/init-param&gt;</span><br><span class="line">  &lt;/filter&gt;</span><br><span class="line">  &lt;filter-mapping&gt;</span><br><span class="line">    &lt;filter-name&gt;characterEncoding&lt;/filter-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">  &lt;/filter-mapping&gt;</span><br><span class="line">  &lt;context-param&gt;</span><br><span class="line">    &lt;param-name&gt;log4jConfigLocation&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;classpath:log4j.properties&lt;/param-value&gt;</span><br><span class="line">  &lt;/context-param&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;listener&gt;</span><br><span class="line">    &lt;listener-class&gt;</span><br><span class="line">			org.springframework.web.util.Log4jConfigListener</span><br><span class="line">		&lt;/listener-class&gt;</span><br><span class="line">  &lt;/listener&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;context-param&gt;</span><br><span class="line"></span><br><span class="line">&lt;param-name&gt;webAppRootKey&lt;/param-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;param-value&gt; app.root &lt;/param-value&gt;</span><br><span class="line"></span><br><span class="line">&lt;/context-param&gt;</span><br><span class="line">  </span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>
<h3 id="UserController-核心"><a href="#UserController-核心" class="headerlink" title="UserController(核心)"></a>UserController(核心)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">@RequestMapping(<span class="string">"/user"</span>)</span><br><span class="line">public class UserController extends BaseController &#123;</span><br><span class="line"></span><br><span class="line">	public UserService <span class="function"><span class="title">getUserService</span></span>() &#123;</span><br><span class="line">		<span class="built_in">return</span> userService;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setUserService(UserService userService) &#123;</span><br><span class="line">		this.userService = userService;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	private Logger logger = Logger.getLogger(UserController.class);</span><br><span class="line"></span><br><span class="line">	@Autowired</span><br><span class="line">	@Qualifier(<span class="string">"userServiceImpl"</span>)</span><br><span class="line">	private UserService userService;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	// 实现跳转到登录页</span><br><span class="line">	@RequestMapping(value = <span class="string">"/login.html"</span>)</span><br><span class="line">	public String <span class="function"><span class="title">login</span></span>() &#123;</span><br><span class="line">		logger.info(<span class="string">"用户跳转到登录页====================&gt;"</span>);</span><br><span class="line">		<span class="built_in">return</span> <span class="string">"login"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	// 主页面</span><br><span class="line">		@RequestMapping(value = <span class="string">"main.html"</span>)</span><br><span class="line">		public String <span class="function"><span class="title">hetmain</span></span>() &#123;</span><br><span class="line">			logger.info(<span class="string">"用户跳转到主页面====================&gt;"</span>);</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"main"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	// 实现登录</span><br><span class="line">	@RequestMapping(value = <span class="string">"dologin.html"</span>, method = RequestMethod.POST)</span><br><span class="line">	public String doLogin(String userName, String userPwd, HttpSession session,</span><br><span class="line">			HttpServletRequest request,RedirectAttributes attr) throws Exception &#123;</span><br><span class="line">		logger.info(<span class="string">"登录中======================&gt;"</span>);</span><br><span class="line">		// 调用service方法进行用户匹配</span><br><span class="line">		User user=new User();</span><br><span class="line">		user.setUserName(userName);</span><br><span class="line">		user.setUserPwd(userPwd);</span><br><span class="line">		User user2=new User();</span><br><span class="line">		user2 = userService.login(user);</span><br><span class="line">		<span class="keyword">if</span>(null!=user2)&#123;//登陆成功 </span><br><span class="line">			 attr.addFlashAttribute(<span class="string">"u1"</span>, user2);</span><br><span class="line">   			 <span class="built_in">return</span> <span class="string">"redirect:/user/main.html"</span>;</span><br><span class="line">   		 </span><br><span class="line">   		 //response.sendRedirect(<span class="string">"jsp/frame.jsp"</span>)</span><br><span class="line">   	 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   		 request.setAttribute(<span class="string">"error"</span>,<span class="string">"用户名密码不正确"</span>);</span><br><span class="line">   		 <span class="built_in">return</span> <span class="string">"login"</span>;</span><br><span class="line">   	 &#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//根据用户id获取用户信息</span><br><span class="line">		@RequestMapping(value=<span class="string">"usermodify.html"</span>,method = RequestMethod.GET)</span><br><span class="line">		public String getUserByID(@RequestParam int id,Model model)&#123;</span><br><span class="line">			User user=new User();</span><br><span class="line">			user=userService.getUserById(id);</span><br><span class="line">			model.addAttribute(<span class="string">"user"</span>, user);</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"toEditUserView"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		@RequestMapping(value=<span class="string">"usermodifysave.html"</span>,method=RequestMethod.POST)</span><br><span class="line">		public String modifyUserSave(User user,HttpSession session)&#123;</span><br><span class="line">			<span class="keyword">if</span>(userService.modifyUser(user)&gt;0)&#123;</span><br><span class="line">				<span class="built_in">return</span> <span class="string">"redirect:/user/userlist.html"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"toEditUserView"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		@RequestMapping(value=<span class="string">"userlist.html"</span>,method = RequestMethod.GET)</span><br><span class="line">		public String getUserList(Model model)&#123;</span><br><span class="line">			List&lt;User&gt;userList=new ArrayList&lt;User&gt;();</span><br><span class="line">			userList=userService.getUsers();</span><br><span class="line">			model.addAttribute(<span class="string">"userList"</span>, userList);</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"userInfoList"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">		</span><br><span class="line">		//添加</span><br><span class="line">		@RequestMapping(value=<span class="string">"addUser.html"</span>,method=RequestMethod.GET)</span><br><span class="line">		public String add(@ModelAttribute(<span class="string">"user"</span>) User user,Model model)&#123;</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"doSaveUserInfo"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		@RequestMapping(value=<span class="string">"addUsersave.html"</span>,method=RequestMethod.POST)</span><br><span class="line">		public String addSave(@Valid User user, BindingResult bindingResult, HttpSession session)&#123;</span><br><span class="line">			<span class="keyword">if</span>(bindingResult.hasErrors())&#123;</span><br><span class="line">				<span class="built_in">return</span> <span class="string">"doSaveUserInfo"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			int num=userService.addUser(user);</span><br><span class="line">			System.out.println(<span class="string">"==================="</span>+num);</span><br><span class="line">			<span class="keyword">if</span>(num&gt;0)&#123;</span><br><span class="line">				<span class="built_in">return</span> <span class="string">"redirect:/user/userlist.html"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"doSaveUserInfo"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		@RequestMapping(value = <span class="string">"/error.html"</span>)</span><br><span class="line">		public String <span class="function"><span class="title">error</span></span>() &#123;</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"error"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		@RequestMapping(value=<span class="string">"userdelete.html"</span>,method = RequestMethod.GET)</span><br><span class="line">		public String getUserByIDs(@RequestParam int id,Model model)&#123;</span><br><span class="line">			User user=new User();</span><br><span class="line">			user=userService.getUserById(id);</span><br><span class="line">			model.addAttribute(<span class="string">"user"</span>, user);</span><br><span class="line">			<span class="built_in">return</span> <span class="string">"deleteUserInfo"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		//删除</span><br><span class="line">		@RequestMapping(value=<span class="string">"/deleteUser.html"</span>,method=RequestMethod.POST)</span><br><span class="line">		public String deleteUser(@RequestParam int id)&#123;</span><br><span class="line">				int nums=userService.removerUser(id);</span><br><span class="line">				System.out.println(<span class="string">"===================&gt;"</span>+nums);</span><br><span class="line">				<span class="keyword">if</span>(nums&gt;=1)&#123;</span><br><span class="line">					<span class="built_in">return</span> <span class="string">"redirect:/user/userlist.html"</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="built_in">return</span> <span class="string">"error"</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="保存文件"><a href="#保存文件" class="headerlink" title="保存文件"></a>保存文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">//跳转到新增appinfo页面</span><br><span class="line">	@RequestMapping(value=<span class="string">"/appinfoadd"</span>,method=RequestMethod.GET)</span><br><span class="line">	public String add(@ModelAttribute(<span class="string">"appInfo"</span>) AppInfo appInfo)&#123;</span><br><span class="line">		<span class="built_in">return</span> <span class="string">"developer/appinfoadd"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//保存appinfo数据</span><br><span class="line">	@RequestMapping(value=<span class="string">"/appinfoaddsave"</span>,method=RequestMethod.POST)</span><br><span class="line">	public String addSave(AppInfo appInfo,HttpSession session,HttpServletRequest request,</span><br><span class="line">					@RequestParam(value=<span class="string">"a_logoPicPath"</span>,required= <span class="literal">false</span>) MultipartFile attach)&#123;		</span><br><span class="line">		</span><br><span class="line">		String logoPicPath =  null;</span><br><span class="line">		String logoLocPath =  null;</span><br><span class="line">		<span class="keyword">if</span>(!attach.isEmpty())&#123;</span><br><span class="line">			String path = request.getSession().getServletContext().getRealPath(<span class="string">"statics"</span>+java.io.File.separator+<span class="string">"uploadfiles"</span>);</span><br><span class="line">			logger.info(<span class="string">"uploadFile path: "</span> + path);</span><br><span class="line">			String oldFileName = attach.getOriginalFilename();//原文件名</span><br><span class="line">			String prefix = FilenameUtils.getExtension(oldFileName);//原文件后缀</span><br><span class="line">			int filesize = 500000;</span><br><span class="line">			<span class="keyword">if</span>(attach.getSize() &gt; filesize)&#123;//上传大小不得超过 50k</span><br><span class="line">				request.setAttribute(<span class="string">"fileUploadError"</span>, Constants.FILEUPLOAD_ERROR_4);</span><br><span class="line">				<span class="built_in">return</span> <span class="string">"developer/appinfoadd"</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(prefix.equalsIgnoreCase(<span class="string">"jpg"</span>) || prefix.equalsIgnoreCase(<span class="string">"png"</span>) </span><br><span class="line">			   ||prefix.equalsIgnoreCase(<span class="string">"jepg"</span>) || prefix.equalsIgnoreCase(<span class="string">"pneg"</span>))&#123;//上传图片格式</span><br><span class="line">				 String fileName = appInfo.getAPKName() + <span class="string">".jpg"</span>;//上传LOGO图片命名:apk名称.apk</span><br><span class="line">				 File targetFile = new File(path,fileName);</span><br><span class="line">				 <span class="keyword">if</span>(!targetFile.exists())&#123;</span><br><span class="line">					 targetFile.mkdirs();</span><br><span class="line">				 &#125;</span><br><span class="line">				 try &#123;</span><br><span class="line">					attach.transferTo(targetFile);</span><br><span class="line">				&#125; catch (Exception e) &#123;</span><br><span class="line">					// TODO Auto-generated catch block</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">					request.setAttribute(<span class="string">"fileUploadError"</span>, Constants.FILEUPLOAD_ERROR_2);</span><br><span class="line">					<span class="built_in">return</span> <span class="string">"developer/appinfoadd"</span>;</span><br><span class="line">				&#125; </span><br><span class="line">				 logoPicPath = request.getContextPath()+<span class="string">"/statics/uploadfiles/"</span>+fileName; //绝对路径</span><br><span class="line">				 logoLocPath = path+File.separator+fileName; //相对路径</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				request.setAttribute(<span class="string">"fileUploadError"</span>, Constants.FILEUPLOAD_ERROR_3);</span><br><span class="line">				<span class="built_in">return</span> <span class="string">"developer/appinfoadd"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		appInfo.setCreatedBy(((DevUser)session.getAttribute(Constants.DEV_USER_SESSION)).getId());</span><br><span class="line">		appInfo.setCreationDate(new Date());</span><br><span class="line">		appInfo.setLogoPicPath(logoPicPath);</span><br><span class="line">		appInfo.setLogoLocPath(logoLocPath);</span><br><span class="line">		appInfo.setDevId(((DevUser)session.getAttribute(Constants.DEV_USER_SESSION)).getId());</span><br><span class="line">		appInfo.setStatus(1);</span><br><span class="line">		try &#123;</span><br><span class="line">			<span class="keyword">if</span>(appInfoService.add(appInfo))&#123;</span><br><span class="line">				<span class="built_in">return</span> <span class="string">"redirect:/dev/flatform/app/list"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			// TODO Auto-generated catch block</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> <span class="string">"developer/appinfoadd"</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="JSP页面"><a href="#JSP页面" class="headerlink" title="JSP页面"></a>JSP页面</h3><h4 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> import=<span class="string">"java.util.*"</span> pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	String path = request.getContextPath();</span><br><span class="line">	String basePath = request.getScheme() + <span class="string">"://"</span> + request.getServerName() + <span class="string">":"</span> + request.getServerPort()</span><br><span class="line">			+ path + <span class="string">"/"</span>;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;base href=<span class="string">"&lt;%=basePath%&gt;"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;My JSP <span class="string">'userInfoList.jsp'</span> starting page&lt;/title&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;a href=<span class="string">"user/addUser.html"</span>&gt;添加用户&lt;/a&gt;</span><br><span class="line">	&lt;h2&gt;用户列表&lt;/h2&gt;</span><br><span class="line">	&lt;table class=<span class="string">"providerTable"</span> cellpadding=<span class="string">"0"</span> cellspacing=<span class="string">"0"</span>&gt;</span><br><span class="line">		&lt;tr class=<span class="string">"firstTr"</span>&gt;</span><br><span class="line">			&lt;th width=<span class="string">"10%"</span>&gt;用户id&lt;/th&gt;</span><br><span class="line">			&lt;th width=<span class="string">"20%"</span>&gt;用户名称&lt;/th&gt;</span><br><span class="line">			&lt;th width=<span class="string">"10%"</span>&gt;用户密码&lt;/th&gt;</span><br><span class="line">			&lt;th width=<span class="string">"10%"</span>&gt;生日日期&lt;/th&gt;</span><br><span class="line">			&lt;th width=<span class="string">"10%"</span>&gt;操作&lt;/th&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;c:forEach var=<span class="string">"user"</span> items=<span class="string">"<span class="variable">$&#123;userList &#125;</span>"</span> varStatus=<span class="string">"status"</span></span><br><span class="line">			begin=<span class="string">"0"</span>&gt;</span><br><span class="line">			&lt;tr&gt;</span><br><span class="line">				&lt;td&gt;&lt;span&gt;<span class="variable">$&#123;user.id &#125;</span>&lt;/span&gt;&lt;/td&gt;</span><br><span class="line">				&lt;td&gt;&lt;span&gt;<span class="variable">$&#123;user.userName &#125;</span>&lt;/span&gt;&lt;/td&gt;</span><br><span class="line">				&lt;td&gt;&lt;span&gt;<span class="variable">$&#123;user.userPwd&#125;</span>&lt;/span&gt;&lt;/td&gt;</span><br><span class="line">				&lt;td&gt;&lt;span&gt;<span class="variable">$&#123;user.userBirthday.year+1900&#125;</span>-&lt;c:<span class="keyword">if</span></span><br><span class="line">							<span class="built_in">test</span>=<span class="string">"<span class="variable">$&#123;user.userBirthday.month+1 &lt; 10&#125;</span>"</span>&gt;0&lt;/c:<span class="keyword">if</span>&gt;<span class="variable">$&#123;user.userBirthday.month+1&#125;</span>-&lt;c:<span class="keyword">if</span></span><br><span class="line">							<span class="built_in">test</span>=<span class="string">"<span class="variable">$&#123;user.userBirthday.date &lt; 10&#125;</span>"</span>&gt;0&lt;/c:<span class="keyword">if</span>&gt;<span class="variable">$&#123;user.userBirthday.date&#125;</span>&lt;/span&gt;</span><br><span class="line">				&lt;/td&gt;</span><br><span class="line">				&lt;td&gt;&lt;a</span><br><span class="line">					href=<span class="string">"<span class="variable">$&#123;pageContext.request.contextPath&#125;</span>/user/usermodify.html?id=<span class="variable">$&#123;user.id &#125;</span>"</span>&gt;修改&lt;/a&gt;</span><br><span class="line">					&lt;a href=<span class="string">"<span class="variable">$&#123;pageContext.request.contextPath&#125;</span>/user/userdelete.html?id=<span class="variable">$&#123;user.id &#125;</span>"</span>&gt;删除&lt;/a&gt;&lt;/td&gt;</span><br><span class="line"></span><br><span class="line">			&lt;/tr&gt;</span><br><span class="line">		&lt;/c:forEach&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="添加"><a href="#添加" class="headerlink" title="添加"></a>添加</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> import=<span class="string">"java.util.*"</span> pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;%@taglib prefix=<span class="string">"fm"</span> uri=<span class="string">"http://www.springframework.org/tags/form"</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">String path = request.getContextPath();</span><br><span class="line">String basePath = request.getScheme()+<span class="string">"://"</span>+request.getServerName()+<span class="string">":"</span>+request.getServerPort()+path+<span class="string">"/"</span>;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;base href=<span class="string">"&lt;%=basePath%&gt;"</span>&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;title&gt;My JSP <span class="string">'doSaveUserInfo.jsp'</span> starting page&lt;/title&gt;</span><br><span class="line">    </span><br><span class="line">	&lt;meta http-equiv=<span class="string">"pragma"</span> content=<span class="string">"no-cache"</span>&gt;</span><br><span class="line">	&lt;meta http-equiv=<span class="string">"cache-control"</span> content=<span class="string">"no-cache"</span>&gt;</span><br><span class="line">	&lt;meta http-equiv=<span class="string">"expires"</span> content=<span class="string">"0"</span>&gt;    </span><br><span class="line">	&lt;meta http-equiv=<span class="string">"keywords"</span> content=<span class="string">"keyword1,keyword2,keyword3"</span>&gt;</span><br><span class="line">	&lt;meta http-equiv=<span class="string">"description"</span> content=<span class="string">"This is my page"</span>&gt;</span><br><span class="line">	&lt;!--</span><br><span class="line">	&lt;link rel=<span class="string">"stylesheet"</span> <span class="built_in">type</span>=<span class="string">"text/css"</span> href=<span class="string">"styles.css"</span>&gt;</span><br><span class="line">	--&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;h2&gt;新增用户&lt;/h2&gt;</span><br><span class="line">    </span><br><span class="line">     &lt;fm:form method=<span class="string">"post"</span> modelAttribute=<span class="string">"user"</span> action=<span class="string">"<span class="variable">$&#123;pageContext.request.contextPath&#125;</span>/user/addUsersave.html"</span>&gt;</span><br><span class="line">    	&lt;fm:errors path=<span class="string">"userName"</span>/&gt;&lt;br/&gt;</span><br><span class="line">    	用户名称：&lt;fm:input path=<span class="string">"userName"</span>/&gt;&lt;br/&gt;</span><br><span class="line">    	&lt;fm:errors path=<span class="string">"userPwd"</span>/&gt;&lt;br/&gt;</span><br><span class="line">    	用户密码：&lt;fm:password path=<span class="string">"userPwd"</span>/&gt;&lt;br/&gt;</span><br><span class="line">    	&lt;fm:errors path=<span class="string">"userBirthday"</span>/&gt;&lt;br/&gt;</span><br><span class="line">    	用户生日：&lt;fm:input path=<span class="string">"userBirthday"</span> Class=<span class="string">"Wdate"</span> id=<span class="string">"birthday"</span> name=<span class="string">"userBirthday"</span> <span class="built_in">readonly</span>=<span class="string">"readonly"</span> /&gt;&lt;br/&gt;</span><br><span class="line">    	</span><br><span class="line">    	&lt;input <span class="built_in">type</span>=<span class="string">"submit"</span> value=<span class="string">"保存"</span>&gt;</span><br><span class="line">    &lt;/fm:form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> &lt;body&gt;</span><br><span class="line">    &lt;h2&gt;用户修改页面&lt;/h2&gt;</span><br><span class="line">    &lt;form action=<span class="string">"<span class="variable">$&#123;pageContext.request.contextPath&#125;</span>/user/usermodifysave.html"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"id"</span> value=<span class="string">"<span class="variable">$&#123;user.id &#125;</span>"</span>&gt;&lt;br/&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">"text"</span> name=<span class="string">"userName"</span> value=<span class="string">"<span class="variable">$&#123;user.userName &#125;</span>"</span>&gt;&lt;br/&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">"text"</span> name=<span class="string">"userPwd"</span> value=<span class="string">"<span class="variable">$&#123;user.userPwd &#125;</span>"</span>&gt;&lt;br/&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">"text"</span> name=<span class="string">"userBirthday"</span> value=<span class="string">"<span class="variable">$&#123;user.userBirthday &#125;</span>"</span>&gt;&lt;br/&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">"submit"</span> value=<span class="string">"修改"</span>&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">"button"</span> value=<span class="string">"返回主页面"</span>&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">  </span><br><span class="line"><span class="comment">### 有形的东西迟早会凋零，但只有回忆是永远不会凋零的</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/11/SSM基础案例文件/" data-id="cjrabl6q6001vvkdq40rsyp8p" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Hibernate关系映射" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/08/Hibernate关系映射/" class="article-date">
  <time datetime="2018-11-08T14:21:23.000Z" itemprop="datePublished">2018-11-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SSH/">SSH</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/08/Hibernate关系映射/">Hibernate关系映射</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="映射关系的形成"><a href="#映射关系的形成" class="headerlink" title="映射关系的形成"></a>映射关系的形成</h3><p> hibernate在实现ORM功能的时候主要用到的文件有：映射类（<em>.Java）、映射文件（</em>.hbm.xml）和数据库配置文件（<em>.properties/</em>.cfg.xml）</p>
<p> 映射类（*.java）：它是描述数据库表的结构，表中的字段在类中被描述成属性，将来就可以实现把表中的记录映射成为该类的对象了。</p>
<p>映射文件（*.hbm.xml）：它是指定数据库表和映射类之间的关系，包括映射类和数据库表的对应关系、表字段和类属性类型的对应关系以及表字段和类属性名称的对应关系等。</p>
<p>数据库配置文件（<em>.properties/</em>.cfg.xml）：它是指定与数据库连接时需要的连接信息，比如连接哪种数据库、登录数据库的用户名、登录密码以及连接字符串等。当然还可以把映射类的地址映射信息放在这里。</p>
<h3 id="hibernate中的关联关系有四种：一对一、一对多、多对一、多对多"><a href="#hibernate中的关联关系有四种：一对一、一对多、多对一、多对多" class="headerlink" title="hibernate中的关联关系有四种：一对一、一对多、多对一、多对多"></a>hibernate中的关联关系有四种：一对一、一对多、多对一、多对多</h3><h3 id="关联关系-是有方向的"><a href="#关联关系-是有方向的" class="headerlink" title="关联关系(是有方向的)"></a>关联关系(是有方向的)</h3><p>Dept(部门表)，Emp(员工表),一个部门下有多个员工，而一个员工只属于一个部门，所以Emp-&gt;Dept是多对一的关系，每个Emp对象只会引用一个Dept对象,而Dept-&gt;Emp是一对多的关系，表示每个Dept对象会引用一组Emp对象，因此在Emp类中应该定义一个Dept类型的属性，而在Dept类中需要定义一个集合类型的属性，来引用Emp所有关联的Emp对象，如果只配置一方被成为单向映射，两个都配置被称为双向</p>
<h4 id="单向关联"><a href="#单向关联" class="headerlink" title="单向关联"></a>单向关联</h4><p>单向关联是指只有一方有另一方的关联信息而另一方没有关联信息<br>A——&gt;B<br>A对象中有B对象的关联信息<br>B对象中没有A对象的关联信息<br>我们可以通过A对象中B的关联信息查询或修改B对象的信息但无法通过B对象来查询修改A对象的信息<br>同理A&lt;——B也是单向关联</p>
<h4 id="双向关联"><a href="#双向关联" class="headerlink" title="双向关联"></a>双向关联</h4><p>A&lt;——&gt;B<br>A对象中有B对象的关联信息<br>B对象中也有A对象的关联信息<br>我们可以通过A对象中B的关联信息查询或修改B对象的信息也可以通过B对象来查询修改A对象的信息</p>
<p> 单向关联一般在一方配置多方不进行配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">　　如：一对多 单向关联在“一”的一方配置文件里进行配置,<span class="string">"多"</span>的一方不进行配置</span><br><span class="line"></span><br><span class="line">双向关联两方都要配置</span><br><span class="line"></span><br><span class="line">　　如：一对多 双向关联在“一”的一方配置文件里需要配置，“多”的一方也需要进行配置</span><br></pre></td></tr></table></figure>
<h3 id="一对一关联映射"><a href="#一对一关联映射" class="headerlink" title="一对一关联映射"></a>一对一关联映射</h3><p>一对一是指一个对象对应一个对象  如：一个人只有一个身份证。</p>
<p>在两个数据表之间的一对一关系可以有两种实现方法，其中一种就是通过两个表的主键相关联，另一种是通过外键相关联</p>
<p>一个人（Person）对应一个地址（Address）</p>
<h4 id="一对一主键单向关联"><a href="#一对一主键单向关联" class="headerlink" title="一对一主键单向关联"></a>一对一主键单向关联</h4><p>pojo<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Person &#123;</span><br><span class="line">    private int personid;</span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line">    //在Person对象中有Address对象的关联信息</span><br><span class="line">    private Address address;</span><br><span class="line"> </span><br><span class="line">public class Address&#123;</span><br><span class="line">    //Address对象中没有Person对象的关联信息</span><br><span class="line">    private int addressid;</span><br><span class="line">    private String addressdetail;</span><br></pre></td></tr></table></figure></p>
<p>映射hbm.xml文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Person.hbm.xml</span><br><span class="line">&lt;hibernate-mapping&gt;</span><br><span class="line">    &lt;class name=<span class="string">"com.entity.Person"</span> table=<span class="string">"PERSON"</span>&gt;</span><br><span class="line">        &lt;id name=<span class="string">"personid"</span> column=<span class="string">"presonid"</span>&gt;</span><br><span class="line">            &lt;!--基于主键关联时，主键生成策略是foreign，表明根据关联类生成主键--&gt;</span><br><span class="line">            &lt;generator class=<span class="string">"foreign"</span>&gt;</span><br><span class="line">                &lt;!--关联持久化类的属性名--&gt;</span><br><span class="line">                &lt;param name=<span class="string">"property"</span>&gt;address&lt;/param&gt;</span><br><span class="line">            &lt;/generator&gt;</span><br><span class="line">        &lt;/id&gt;</span><br><span class="line">        &lt;property name=<span class="string">"name"</span>/&gt;</span><br><span class="line">        &lt;property name=<span class="string">"age"</span>/&gt;</span><br><span class="line">        &lt;!--constrained设定为<span class="literal">true</span>，表示的主键必须与Person中对应资料的主键相同。--&gt;</span><br><span class="line">        &lt;one-to-one name=<span class="string">"address"</span> constrained=<span class="string">"true"</span>/&gt;</span><br><span class="line">    &lt;/class&gt;</span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<p>Address.hbm.xml中不做任何配置</p>
<h4 id="一对一主键双向关联"><a href="#一对一主键双向关联" class="headerlink" title="一对一主键双向关联"></a>一对一主键双向关联</h4><p>Person&lt;——&gt;Address<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Person implements java.io.Serializable &#123; </span><br><span class="line"></span><br><span class="line">  private Long id; </span><br><span class="line">  private String name; </span><br><span class="line">  //双向关联中Person对象中有Adderss对象的关联信息  </span><br><span class="line">  private Address address;</span><br><span class="line"> </span><br><span class="line">public class Address implements java.io.Serializable &#123; </span><br><span class="line">  private Long id; </span><br><span class="line">  //Adderss对象中也有Person对象的关联信息  </span><br><span class="line">  private Person person; </span><br><span class="line">  private String detail;</span><br></pre></td></tr></table></figure></p>
<p>Person.hbm.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;hibernate-mapping&gt; </span><br><span class="line">  &lt;class name=<span class="string">"entity.Person"</span> table=<span class="string">"person"</span>&gt; </span><br><span class="line">    &lt;id name=<span class="string">"id"</span> <span class="built_in">type</span>=<span class="string">"java.lang.Long"</span>&gt; </span><br><span class="line">      &lt;column name=<span class="string">"id"</span> /&gt; </span><br><span class="line">      &lt;generator class=<span class="string">"identity"</span> /&gt; </span><br><span class="line">    &lt;/id&gt; </span><br><span class="line">    &lt;property name=<span class="string">"name"</span> <span class="built_in">type</span>=<span class="string">"java.lang.String"</span>&gt; </span><br><span class="line">      &lt;column name=<span class="string">"name"</span> length=<span class="string">"24"</span> not-null=<span class="string">"true"</span>&gt; </span><br><span class="line">        &lt;comment&gt;姓名&lt;/comment&gt; </span><br><span class="line">      &lt;/column&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">    &lt;one-to-one name=<span class="string">"address"</span>/&gt; </span><br><span class="line">  &lt;/class&gt; </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<p>Address.hbm.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;hibernate-mapping&gt; </span><br><span class="line">  &lt;class name=<span class="string">"entity.Address"</span> table=<span class="string">"address"</span> catalog=<span class="string">"mydb"</span>&gt; </span><br><span class="line">    &lt;id name=<span class="string">"id"</span> <span class="built_in">type</span>=<span class="string">"java.lang.Long"</span>&gt; </span><br><span class="line">      &lt;column name=<span class="string">"id"</span> /&gt; </span><br><span class="line">      &lt;!-- class=<span class="string">"foreign"</span>: 一对一主键映射中，使用另外一个相关联的对象的标识符 --&gt; </span><br><span class="line">      &lt;generator class=<span class="string">"foreign"</span>&gt; //表明id的生成方式是引用表people的主键</span><br><span class="line">        &lt;param name=<span class="string">"property"</span>&gt;person&lt;/param&gt; </span><br><span class="line">      &lt;/generator&gt; </span><br><span class="line">    &lt;/id&gt; </span><br><span class="line">    &lt;property name=<span class="string">"detail"</span> <span class="built_in">type</span>=<span class="string">"java.lang.String"</span>&gt; </span><br><span class="line">      &lt;column name=<span class="string">"detail"</span> length=<span class="string">"120"</span> not-null=<span class="string">"true"</span>&gt; </span><br><span class="line">        &lt;comment&gt;详细地址&lt;/comment&gt; </span><br><span class="line">      &lt;/column&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">    &lt;!-- 表示在address表存在一个外键约束，外键参考相关联的表person --&gt; </span><br><span class="line">    &lt;one-to-one name=<span class="string">"person"</span> constrained=<span class="string">"true"</span> /&gt; </span><br><span class="line">  &lt;/class&gt; </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="一对一外键单向关联"><a href="#一对一外键单向关联" class="headerlink" title="一对一外键单向关联"></a>一对一外键单向关联</h4><p>Person——&gt;Address<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class Person &#123;</span><br><span class="line">    private int personid;</span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line">    private Address address;</span><br><span class="line"> </span><br><span class="line">public class Address&#123;</span><br><span class="line">    private int addressid;</span><br><span class="line">    private String addressdetail;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Address.hbm.xml</span><br><span class="line">&lt;!--address中不做任何配置所以我们省略--&gt;</span><br><span class="line"></span><br><span class="line">　　…………………………</span><br><span class="line"></span><br><span class="line">&lt;!--单向关联和双向关联的区别在于单向关联只在一方配置双向关联两方都要配置--&gt;</span><br><span class="line">Person.hbm.xml</span><br><span class="line">&lt;hibernate-mapping&gt; </span><br><span class="line">        &lt;class name=<span class="string">"com.entity.Person"</span> table=<span class="string">"PERSON"</span>&gt; </span><br><span class="line">                &lt;id name=<span class="string">"personid"</span>&gt; </span><br><span class="line">                        &lt;generator class=<span class="string">"identity"</span>/&gt; </span><br><span class="line">                &lt;/id&gt; </span><br><span class="line">                &lt;property name=<span class="string">"name"</span>/&gt; </span><br><span class="line">                &lt;property name=<span class="string">"age"</span>/&gt; </span><br><span class="line">                &lt;!--用来映射关联PO column是Address在该表中的外键列名,增加unique变成唯一的--&gt; </span><br><span class="line">                &lt;many-to-one name=<span class="string">"address"</span> unique=<span class="string">"true"</span>/&gt; </span><br><span class="line">        &lt;/class&gt; </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>外键关联和主键关联不同的地方是采用<many-to-one>标签来映射，一对一唯一外键关联映射其实是多对一的特例。<many-to-one>指定多的一端unique为true，这样就限制了多的一端的多重性为一，就是这样来映射的。</many-to-one></many-to-one></p>
<h4 id="一对一外键双向关联"><a href="#一对一外键双向关联" class="headerlink" title="一对一外键双向关联"></a>一对一外键双向关联</h4><p>Person&lt;——&gt;Address<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class Person implements java.io.Serializable &#123; </span><br><span class="line"></span><br><span class="line">  private Long id; </span><br><span class="line">  private String name; </span><br><span class="line">  private Address address;</span><br><span class="line"> </span><br><span class="line">public class Address implements java.io.Serializable &#123; </span><br><span class="line">  private Long id; </span><br><span class="line">  private Person person; </span><br><span class="line">  private String detail;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Person.hbm.xml</span><br><span class="line">&lt;hibernate-mapping&gt; </span><br><span class="line">  &lt;class name=<span class="string">"com.entity.Person"</span> table=<span class="string">"person"</span>&gt; </span><br><span class="line">    &lt;id name=<span class="string">"personid"</span> <span class="built_in">type</span>=<span class="string">"java.lang.Long"</span>&gt; </span><br><span class="line">      &lt;column name=<span class="string">"personid"</span> /&gt; </span><br><span class="line">      &lt;generator class=<span class="string">"identity"</span> /&gt; </span><br><span class="line">    &lt;/id&gt; </span><br><span class="line">    &lt;property name=<span class="string">"name"</span> <span class="built_in">type</span>=<span class="string">"java.lang.String"</span>&gt; </span><br><span class="line">      &lt;column name=<span class="string">"name"</span> length=<span class="string">"24"</span> not-null=<span class="string">"true"</span>&gt; </span><br><span class="line">        &lt;comment&gt;姓名&lt;/comment&gt; </span><br><span class="line">      &lt;/column&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">　　&lt;!--双向关联配置--&gt;</span><br><span class="line">    &lt;one-to-one name=<span class="string">"address"</span> /&gt; </span><br><span class="line">  &lt;/class&gt; </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br><span class="line"></span><br><span class="line">Address.hbm.xml</span><br><span class="line">&lt;hibernate-mapping&gt; </span><br><span class="line">  &lt;class name=<span class="string">"com.entity.Address"</span> table=<span class="string">"address"</span> catalog=<span class="string">"testdb"</span>&gt; </span><br><span class="line">    &lt;id name=<span class="string">"addressid"</span> <span class="built_in">type</span>=<span class="string">"java.lang.Long"</span>&gt; </span><br><span class="line">      &lt;column name=<span class="string">"addressid"</span> /&gt; </span><br><span class="line">      &lt;generator class=<span class="string">"identity"</span> /&gt; </span><br><span class="line">    &lt;/id&gt; </span><br><span class="line">    &lt;property name=<span class="string">"detail"</span> <span class="built_in">type</span>=<span class="string">"java.lang.String"</span>&gt; </span><br><span class="line">      &lt;column name=<span class="string">"detail"</span> length=<span class="string">"120"</span> not-null=<span class="string">"true"</span>&gt; </span><br><span class="line">        &lt;comment&gt;详细地址&lt;/comment&gt; </span><br><span class="line">      &lt;/column&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">    &lt;many-to-one name=<span class="string">"person"</span> class=<span class="string">"entity.Person"</span> unique=<span class="string">"true"</span>&gt; </span><br><span class="line">      &lt;column name=<span class="string">"personid"</span>&gt; </span><br><span class="line">        &lt;comment&gt;人的ID&lt;/comment&gt; </span><br><span class="line">      &lt;/column&gt; </span><br><span class="line">    &lt;/many-to-one&gt; </span><br><span class="line">  &lt;/class&gt; </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure>
<h3 id="一对多关联映射"><a href="#一对多关联映射" class="headerlink" title="一对多关联映射"></a>一对多关联映射</h3><h4 id="一对多单向关联"><a href="#一对多单向关联" class="headerlink" title="一对多单向关联"></a>一对多单向关联</h4><p>Classes——&gt;Student<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class Classes &#123;  </span><br><span class="line">    private int id;  </span><br><span class="line">    private String name;     </span><br><span class="line">    //Set支持延迟加载因为多个学生所以我们用Set集合关联 </span><br><span class="line">    private Set students;  </span><br><span class="line">&#125;  </span><br><span class="line">public class Student &#123;  </span><br><span class="line">    private int id;  </span><br><span class="line">    private String name;      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Classes对象中使用了set属性，但是只是说明了延迟加载的属性，并没有为属性配置对应的对象，属性的对象是要在映射文件中来配置的，需要添加set标签，并在set标签中添加<one-to-many>标签<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;hibernate-mapping&gt;  </span><br><span class="line">    &lt;class name=<span class="string">"com.hibernate.Classes"</span> table=<span class="string">"t_classes"</span>&gt;  </span><br><span class="line">        &lt;id name=<span class="string">"id"</span>&gt;  </span><br><span class="line">            &lt;generator class=<span class="string">"native"</span>/&gt;  </span><br><span class="line">        &lt;/id&gt;  </span><br><span class="line">        &lt;property name=<span class="string">"name"</span>/&gt;  </span><br><span class="line">        &lt;<span class="built_in">set</span> name=<span class="string">"students"</span>&gt;  </span><br><span class="line">            &lt;key column=<span class="string">"classesid"</span>&gt;&lt;/key&gt;  </span><br><span class="line">            &lt;one-to-many class=<span class="string">"com.hibernate.Student"</span>&gt;&lt;/one-to-many&gt;  </span><br><span class="line">        &lt;/<span class="built_in">set</span>&gt;  </span><br><span class="line">    &lt;/class&gt;  </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></one-to-many></p>
<p>Student.hbm.xml不做任何改变</p>
<h4 id="一对多双向关联"><a href="#一对多双向关联" class="headerlink" title="一对多双向关联"></a>一对多双向关联</h4><p>Classes&lt;——&gt;Student<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Classes &#123;  </span><br><span class="line">    private int id;  </span><br><span class="line">    private String name;     </span><br><span class="line">    //Set支持延迟加载  </span><br><span class="line">    private Set&lt;Student&gt; students;  </span><br><span class="line">&#125;  </span><br><span class="line">public class Student &#123;  </span><br><span class="line">    private int id;  </span><br><span class="line">    private String name; </span><br><span class="line">    //添加class对象关联信息因为是一方所以我们用一个对象关联</span><br><span class="line">    private Classes classes;     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Student.hbm.xml</span><br><span class="line">&lt;hibernate-mapping&gt;  </span><br><span class="line">    &lt;class name=<span class="string">"com.hibernate.Student"</span> table=<span class="string">"t_student"</span>&gt;  </span><br><span class="line">        &lt;id name=<span class="string">"id"</span>&gt;  </span><br><span class="line">            &lt;generator class=<span class="string">"native"</span>/&gt;  </span><br><span class="line">        &lt;/id&gt;  </span><br><span class="line">        &lt;property name=<span class="string">"name"</span>/&gt;  </span><br><span class="line">        &lt;!-- 在多的一端Student中添加一行新的Classes列 ,并且列的名称要和Classes.hbm.xml的列明相同--&gt;  </span><br><span class="line">        &lt;many-to-one name=<span class="string">"classes"</span> column=<span class="string">"classesid"</span>&gt;&lt;/many-to-one&gt;  </span><br><span class="line">    &lt;/class&gt;  </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure>
<h3 id="多对多关联映射"><a href="#多对多关联映射" class="headerlink" title="多对多关联映射"></a>多对多关联映射</h3><p>多对多关联是指多个对象对应多个对象 如：老师可以有多个学生，学生也可以有多个老师</p>
<h4 id="多对多单向关联"><a href="#多对多单向关联" class="headerlink" title="多对多单向关联"></a>多对多单向关联</h4><p>Teacher——&gt;Student<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Teacher &#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private Set&lt;Student&gt; students = new HashSet&lt;Student&gt;();</span><br><span class="line">｝</span><br><span class="line"></span><br><span class="line">public class Student &#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private String title;</span><br><span class="line">｝</span><br></pre></td></tr></table></figure></p>
<p>Teacher.hbm.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;hibernate-mapping&gt;  </span><br><span class="line">    &lt;class name=<span class="string">"com.hibernate.Teacher"</span> table=<span class="string">"t_teacher"</span>&gt;  </span><br><span class="line">        &lt;id name=<span class="string">"id"</span>&gt;  </span><br><span class="line">            &lt;generator class=<span class="string">"native"</span>/&gt;  </span><br><span class="line">        &lt;/id&gt;  </span><br><span class="line">        &lt;property name=<span class="string">"name"</span>/&gt;  </span><br><span class="line">　　　　　&lt;!--生成一张新表存放两个关联对象的ID--&gt;</span><br><span class="line">        &lt;<span class="built_in">set</span> name=<span class="string">"students"</span> table=<span class="string">"Teacher_Sutdent"</span>&gt;  </span><br><span class="line">　　　　　　　&lt;!--将Teacher表的外键关联 注意不是对象的属性是表中的字段--&gt;</span><br><span class="line">            &lt;key column=<span class="string">"teacher_id"</span>&gt;&lt;/key&gt;  </span><br><span class="line">　　　　　　　&lt;!--将Student表的外键关联 注意不是对象的属性是表中的字段--&gt; </span><br><span class="line">　　　　　　　&lt;many-to-many class=<span class="string">"com.hibernate.Student"</span> column=<span class="string">"student_id"</span>&gt;&lt;/many-to-many&gt; </span><br><span class="line">　　　　  &lt;/<span class="built_in">set</span>&gt; </span><br><span class="line">　　　&lt;/class&gt; </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="多对多双向关联"><a href="#多对多双向关联" class="headerlink" title="多对多双向关联"></a>多对多双向关联</h4><p>Teacher&lt;——&gt;Student<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Teacher &#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private Set&lt;Student&gt; students = new HashSet&lt;Student&gt;();</span><br><span class="line">｝</span><br><span class="line"></span><br><span class="line">public class Student &#123;</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private String title;</span><br><span class="line">    private Set&lt;Teacher&gt; teachers = new HashSet&lt;Teacher&gt;();</span><br><span class="line">｝</span><br></pre></td></tr></table></figure></p>
<p>Student.hbm.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;hibernate-mapping&gt;  </span><br><span class="line">    &lt;class name=<span class="string">"com.hibernate.Student"</span> table=<span class="string">"t_student"</span>&gt;  </span><br><span class="line">        &lt;id name=<span class="string">"id"</span>&gt;  </span><br><span class="line">            &lt;generator class=<span class="string">"native"</span>/&gt;  </span><br><span class="line">        &lt;/id&gt;  </span><br><span class="line">        &lt;property name=<span class="string">"name"</span>/&gt;  </span><br><span class="line">　　　　　&lt;!--生成一张新表存放两个表的Id--&gt;</span><br><span class="line">        &lt;<span class="built_in">set</span> name=<span class="string">"teachers"</span> table=<span class="string">"Teacher_Student"</span>&gt;  </span><br><span class="line">　　　　　　　&lt;!--将Teacher表的外键关联 注意不是对象的属性是表中的字段--&gt;</span><br><span class="line">            &lt;key column=<span class="string">"student_id"</span>&gt;&lt;/key&gt;  </span><br><span class="line">　　　　　　　&lt;!--将Student表的外键关联 注意不是对象的属性是表中的字段--&gt; </span><br><span class="line">　　　　　　　&lt;many-to-many class=<span class="string">"com.hibernate.Teacher"</span> column=<span class="string">"teacher_id"</span>&gt;&lt;/many-to-many&gt; </span><br><span class="line">　　　　  &lt;/<span class="built_in">set</span>&gt; </span><br><span class="line">　　　&lt;/class&gt; </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<p>Teacher.hbm.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;hibernate-mapping&gt;  </span><br><span class="line">    &lt;class name=<span class="string">"com.hibernate.Teacher"</span> table=<span class="string">"t_teacher"</span>&gt;  </span><br><span class="line">        &lt;id name=<span class="string">"id"</span>&gt;  </span><br><span class="line">            &lt;generator class=<span class="string">"native"</span>/&gt;  </span><br><span class="line">        &lt;/id&gt;  </span><br><span class="line">        &lt;property name=<span class="string">"name"</span>/&gt;  </span><br><span class="line">　　　　　&lt;!--生成一张新表存放两个关联对象的ID--&gt;</span><br><span class="line">        &lt;<span class="built_in">set</span> name=<span class="string">"students"</span> table=<span class="string">"Teacher_Sutdent"</span>&gt;  </span><br><span class="line">　　　　　　　&lt;!--将Teacher表的外键关联 注意不是对象的属性是表中的字段--&gt;</span><br><span class="line">            &lt;key column=<span class="string">"teacher_id"</span>&gt;&lt;/key&gt;  </span><br><span class="line">　　　　　　　&lt;!--将Student表的外键关联 注意不是对象的属性是表中的字段--&gt; </span><br><span class="line">　　　　　　　&lt;many-to-many class=<span class="string">"com.hibernate.Student"</span> column=<span class="string">"student_id"</span>&gt;&lt;/many-to-many&gt; </span><br><span class="line">　　　　  &lt;/<span class="built_in">set</span>&gt; </span><br><span class="line">　　　&lt;/class&gt; </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="多对一关联"><a href="#多对一关联" class="headerlink" title="多对一关联"></a>多对一关联</h3><p>对比一对一关联映射和多对一唯一外键关联映射，其实它们两个都是使用了<many-to-one>本质上都是外键约束，只不过一对一的是唯一映射，需要添加unique=”true”的属性，其它的它们两个是相同的</many-to-one></p>
<p>多对一关联是指多个对象对应一个对象 如：多个员工对应一个部门</p>
<h4 id="多对一单向关联"><a href="#多对一单向关联" class="headerlink" title="多对一单向关联"></a>多对一单向关联</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class Department &#123;  </span><br><span class="line">    private int id;  </span><br><span class="line">    private String name;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">public class Employee &#123;  </span><br><span class="line">    private int id;  </span><br><span class="line">    private String name;  </span><br><span class="line">    private Department depart;//注意这里是以部门的对象来作为员工的属性的</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Employee.hbm.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;hibernate-mapping package=<span class="string">"com.suo.domain"</span>&gt;  </span><br><span class="line">      </span><br><span class="line">    &lt;class name=<span class="string">"Employee"</span>&gt;  </span><br><span class="line">        &lt;id name=<span class="string">"id"</span>&gt;  </span><br><span class="line">            &lt;generator class=<span class="string">"native"</span>/&gt;  </span><br><span class="line">        &lt;/id&gt;  </span><br><span class="line">        &lt;property name=<span class="string">"name"</span>/&gt;  </span><br><span class="line">        &lt;many-to-one name=<span class="string">"depart"</span>&gt;&lt;/many-to-one&gt;  </span><br><span class="line">        &lt;!-- many-to-one指明了外键 ，会根据反射机制，找到要和Employee建立多对一关系的类，该列默认的是可以为空的--&gt;  </span><br><span class="line">    &lt;/class&gt;  </span><br><span class="line">      </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="多对一双向关联"><a href="#多对一双向关联" class="headerlink" title="多对一双向关联"></a>多对一双向关联</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Department &#123;  </span><br><span class="line">    private int id;  </span><br><span class="line">    private String name;</span><br><span class="line">    private Set&lt;Employee&gt; emps;//用集合来存储员工     </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">public class Employee &#123;  </span><br><span class="line">    private int id;  </span><br><span class="line">    private String name;  </span><br><span class="line">    private Department depart;//注意这里是以部门的对象来作为员工的属性的，这个思想很关键，是建立起部门和员工关联的关键  </span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Departement .hbm.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;hibernate-mapping package=<span class="string">"com.suo.domain"</span>&gt;  </span><br><span class="line"></span><br><span class="line">    &lt;class name=<span class="string">"Department"</span>&gt;  </span><br><span class="line">        &lt;id name=<span class="string">"id"</span>&gt;  </span><br><span class="line">            &lt;generator class=<span class="string">"native"</span>/&gt;  </span><br><span class="line">        &lt;/id&gt;  </span><br><span class="line">        &lt;property name=<span class="string">"name"</span>/&gt;  </span><br><span class="line">          </span><br><span class="line">        &lt;<span class="built_in">set</span> name=<span class="string">"emps"</span>&gt;  </span><br><span class="line">            &lt;key column=<span class="string">"depart_id"</span>/&gt;&lt;!-- key指明了员工表中的外键--&gt;  </span><br><span class="line">            &lt;one-to-many class=<span class="string">"Employee"</span>/&gt;&lt;!-- one-to-many指明了和哪个类进行一对多的映射 --&gt;  </span><br><span class="line">        &lt;/<span class="built_in">set</span>&gt;  </span><br><span class="line">        &lt;!--   </span><br><span class="line">            用<span class="built_in">set</span>标签表示Department中的员工集合的属性，这个属性并没有映射到数据库中的部门表中，  </span><br><span class="line">            即部门表中，并没有emps这样的一个列。  </span><br><span class="line">         --&gt;  </span><br><span class="line">    &lt;/class&gt;  </span><br><span class="line">      </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<p>Employee.hbm.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;hibernate-mapping package=<span class="string">"com.suo.domain"</span>&gt;  </span><br><span class="line">      </span><br><span class="line">    &lt;class name=<span class="string">"Employee"</span>&gt;  </span><br><span class="line">        &lt;id name=<span class="string">"id"</span>&gt;  </span><br><span class="line">            &lt;generator class=<span class="string">"native"</span>/&gt;  </span><br><span class="line">        &lt;/id&gt;  </span><br><span class="line">        &lt;property name=<span class="string">"name"</span>/&gt;  </span><br><span class="line">        &lt;many-to-one name=<span class="string">"depart"</span>&gt;&lt;/many-to-one&gt;  </span><br><span class="line">        &lt;!-- many-to-one指明了外键 ，会根据反射机制，找到要和Employee建立多对一关系的类，该列默认的是可以为空的--&gt;  </span><br><span class="line">    &lt;/class&gt;  </span><br><span class="line">      </span><br><span class="line">&lt;/hibernate-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="级联操作"><a href="#级联操作" class="headerlink" title="级联操作"></a>级联操作</h3><h4 id="Casade"><a href="#Casade" class="headerlink" title="Casade"></a>Casade</h4><p>Casade用来说明当对主对象进行某种操作时是否对其关联的从对象也作类似的操作，常用的cascade:none,all,save-update,delete</p>
<p>一般对many-to-one,many-to-many不设置级联，在<one-to-one>和<one-to-many>中设置级联</one-to-many></one-to-one></p>
<h4 id="inverse"><a href="#inverse" class="headerlink" title="inverse"></a>inverse</h4><p>inverse表“是否放弃维护关联关系”(在Java里两个对象产生关联时，对数据库表的影响)，在one-to-many和many-to-many的集合定义中使用，inverse=”true”表示该对象不维护关联关系</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/08/Hibernate关系映射/" data-id="cjrabl6mw000avkdqbn12tslh" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-HQL实用技术" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/08/HQL实用技术/" class="article-date">
  <time datetime="2018-11-08T13:24:14.000Z" itemprop="datePublished">2018-11-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SSH/">SSH</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/08/HQL实用技术/">HQL实用技术</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天来学习HQL语句</p>
<h3 id="编写HQL语句"><a href="#编写HQL语句" class="headerlink" title="编写HQL语句"></a>编写HQL语句</h3><h4 id="from子句"><a href="#from子句" class="headerlink" title="from子句"></a>from子句</h4><p>  例：from com.entity.Dept;<br>                    from Dept dept;–为持久化类Dept指定了别名dept；可省略包名</p>
<h4 id="select子句"><a href="#select子句" class="headerlink" title="select子句"></a>select子句</h4><p> 例：select dept from Dept as dept;<br>                    select dept.DeptName from Dept as dept;–选取单个属性，可选择多个</p>
<h4 id="where子句"><a href="#where子句" class="headerlink" title="where子句"></a>where子句</h4><p>例：from Dept where DeptName=’SALES’;<br>                    from Dept dept where dept.DeptName=’SALES’;<br>                    from Dept dept where dept.location is not null;–查询地址不为空的部门</p>
<h4 id="使用表达式"><a href="#使用表达式" class="headerlink" title="使用表达式"></a>使用表达式</h4><p> 例：from Dept dept where lower(dept.DeptName)=’sales’;–lower()把字符串中的字母转换成小写<br>                    from Emp where year(hireDate)=1980;–year()用于获取日期字段的年份</p>
<h4 id="order-by子句"><a href="#order-by子句" class="headerlink" title="order by子句"></a>order by子句</h4><p> 例：from Emp order by hireDate asc<br>                    from Emp order by hireDate,salary desc;</p>
<h3 id="执行HQL语句"><a href="#执行HQL语句" class="headerlink" title="执行HQL语句"></a>执行HQL语句</h3><p> 执行HQL语句步骤<br>                    1、获取session对象<br>                    2、编写HQL语句<br>                    3、创建Query对象<br>                    4、执行查询</p>
<p>先给大家看一些简单的例子吧</p>
<h4 id="DAO层"><a href="#DAO层" class="headerlink" title="DAO层"></a>DAO层</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">// 查询</span><br><span class="line">public List&lt;User&gt; <span class="function"><span class="title">findAllUser</span></span>() &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User"</span>).list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Iterator返回</span><br><span class="line">public Iterator&lt;User&gt; <span class="function"><span class="title">findAllUser_iterate</span></span>() &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User"</span>).iterate();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 根据姓名查询</span><br><span class="line">public Iterator&lt;User&gt; <span class="function"><span class="title">findAllUserByName</span></span>() &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User where name='李钰洋'"</span>).iterate();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 获取唯一结果</span><br><span class="line">public Long <span class="function"><span class="title">countUser</span></span>() &#123;</span><br><span class="line">	<span class="built_in">return</span> (Long) this.currentSession().createQuery(<span class="string">"select count(id) from User"</span>).uniqueResult();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 参数查询,位置从0开始</span><br><span class="line">public List&lt;User&gt; findUserByName(String name) &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User where name=?"</span>).setString(0, name).list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 按参数名绑定</span><br><span class="line">public List&lt;User&gt; findUserByName1(String name) &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User where name=:name1"</span>).setString(<span class="string">"name1"</span>, name).list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 多参数查询 +结合位置</span><br><span class="line">public List&lt;User&gt; findByCoditions(Object[] param) &#123;</span><br><span class="line">	Query query = this.currentSession().createQuery(<span class="string">"from User where name=? and telephone=?"</span>);</span><br><span class="line">	<span class="keyword">if</span> (param != null &amp;&amp; param.length != 0) &#123;</span><br><span class="line">		<span class="keyword">for</span> (int i = 0; i &lt; param.length; i++) &#123;</span><br><span class="line">			query.setParameter(i, param[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> query.list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 多参数查询 +结合名称 赛高</span><br><span class="line">public List&lt;User&gt; findByCoditions(User param) &#123;</span><br><span class="line">	Query query = this.currentSession().createQuery(<span class="string">"from User where name=:name and telephone=:telephone"</span>);</span><br><span class="line">	query.setProperties(param); // 赛高</span><br><span class="line">	<span class="built_in">return</span> query.list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 多参数查询 +结合名称 赛高 动态hql</span><br><span class="line">public List&lt;User&gt; findByCoditions(String hql, User param) &#123;</span><br><span class="line">	Query query = this.currentSession().createQuery(hql);</span><br><span class="line">	query.setProperties(param); // 赛高</span><br><span class="line">	<span class="built_in">return</span> query.list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 多参数查询 +结合名称 赛高 动态hql map</span><br><span class="line">public List&lt;User&gt; findByCoditions(String hql, Map&lt;String, Object&gt; param) &#123;</span><br><span class="line">	Query query = this.currentSession().createQuery(hql);</span><br><span class="line">	query.setProperties(param); // 赛高</span><br><span class="line">	<span class="built_in">return</span> query.list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 分页</span><br><span class="line">public List&lt;User&gt; findByPage(int pageNo, int pageSize) &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User order by id"</span>).setFirstResult((pageNo - 1) * pageSize)</span><br><span class="line">			.setMaxResults(pageSize).list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 根据id降序获取前3</span><br><span class="line">public List&lt;User&gt; findByOrder(int topSize) &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User order by id"</span>).setMaxResults(topSize).list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 投影查询</span><br><span class="line">public List <span class="function"><span class="title">findByProjection</span></span>() &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"select name from User"</span>).list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 投影查询 查多列</span><br><span class="line">public List&lt;Object[]&gt; <span class="function"><span class="title">findByProjection2</span></span>() &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"select name,telephone from User"</span>).list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//构造函数封装对象</span><br><span class="line">public List&lt;User&gt; <span class="function"><span class="title">findByProjection3</span></span>() &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"select new User(name,telephone) from User"</span>).list();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="SERVICE层"><a href="#SERVICE层" class="headerlink" title="SERVICE层"></a>SERVICE层</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br></pre></td><td class="code"><pre><span class="line">// 查询</span><br><span class="line">public List&lt;User&gt; <span class="function"><span class="title">findAllUser</span></span>() &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findAllUser();</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Iterator返回</span><br><span class="line">public Iterator&lt;User&gt; <span class="function"><span class="title">findAllUser_Iterator</span></span>() &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	Iterator&lt;User&gt; list = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findAllUser_iterate();</span><br><span class="line">		User u = new User();</span><br><span class="line">		<span class="keyword">while</span> (list.hasNext()) &#123;</span><br><span class="line">			u = list.next();</span><br><span class="line">			System.out.println(u.getName() + <span class="string">"艸"</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 根据姓名Iterator返回</span><br><span class="line">public Iterator&lt;User&gt; <span class="function"><span class="title">findAllUser_IteratorByName</span></span>() &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	Iterator&lt;User&gt; list = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findAllUserByName();</span><br><span class="line">		User u = new User();</span><br><span class="line">		<span class="keyword">while</span> (list.hasNext()) &#123;</span><br><span class="line">			u = list.next();</span><br><span class="line">			System.out.println(u.getName() + <span class="string">"\\"</span> + u.getTelephone());</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 返回唯一结果</span><br><span class="line">public Long <span class="function"><span class="title">findAllUser_count</span></span>() &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	Long count = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		count = userDao.countUser();</span><br><span class="line"></span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 查询+参数</span><br><span class="line">public List&lt;User&gt; findAllUser_Name(String name) &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findUserByName(name);</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 查询+名称参数</span><br><span class="line">public List&lt;User&gt; findAllUser_Name1(String name) &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findUserByName1(name);</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 查询+多参数</span><br><span class="line">public List&lt;User&gt; findAllbyCondinitions(Object[] param) &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findByCoditions(param);</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 查询+多参数</span><br><span class="line">public List&lt;User&gt; findAllbyCondinitions(User param) &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findByCoditions(param);</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 查询+多参数 动态hql</span><br><span class="line">public List&lt;User&gt; findAllbyCondinitions1(User param) &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		StringBuilder hql = new StringBuilder(<span class="string">"from User where 1=1"</span>);</span><br><span class="line">		<span class="keyword">if</span> (param.getName() != null &amp;&amp; param.getName().length() != 0) &#123;</span><br><span class="line">			hql.append(<span class="string">" and name=:name"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (param.getTelephone() != null &amp;&amp; param.getTelephone().length() != 0) &#123;</span><br><span class="line">			hql.append(<span class="string">" and telephone=:telephone"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		list = userDao.findByCoditions(hql.toString(), param);</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 查询+多参数 动态hql</span><br><span class="line">public List&lt;User&gt; findAllbyCondinitions2(Map&lt;String, Object&gt; param) &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		StringBuilder hql = new StringBuilder(<span class="string">"from User where 1=1"</span>);</span><br><span class="line">		<span class="keyword">if</span> (param.get(<span class="string">"name"</span>) != null &amp; ((String) param.get(<span class="string">"name"</span>)).length() != 0) &#123;</span><br><span class="line">			hql.append(<span class="string">" and name=:name"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (param.get(<span class="string">"telephone"</span>) != null &amp; ((String) param.get(<span class="string">"telephone"</span>)).length() != 0) &#123;</span><br><span class="line">			hql.append(<span class="string">" and telephone=:telephone"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		list = userDao.findByCoditions(hql.toString(), param);</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 查询分页</span><br><span class="line">public List&lt;User&gt; findAllbyCondinitions3(int pageNo, int pageSize) &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findByPage(pageNo, pageSize);</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 根据id降序查询</span><br><span class="line">public List&lt;User&gt; findAllbyCondinitions4(int topSize) &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findByOrder(topSize);</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 投影查询</span><br><span class="line">public List&lt;Object&gt; <span class="function"><span class="title">findAllbyCondinitions5</span></span>() &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;Object&gt; list = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findByProjection();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 投影查询 object数组</span><br><span class="line">public List&lt;Object[]&gt; <span class="function"><span class="title">findAllbyCondinitions6</span></span>() &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;Object[]&gt; list = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findByProjection2();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 投影查询 构造函数对象</span><br><span class="line">public List&lt;User&gt; <span class="function"><span class="title">findAllbyCondinitions7</span></span>() &#123;</span><br><span class="line">	Transaction tx = null;</span><br><span class="line">	List&lt;User&gt; list = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		UserDao userDao = new UserDao();</span><br><span class="line">		tx = userDao.currentSession().beginTransaction();</span><br><span class="line">		list = userDao.findByProjection3();</span><br><span class="line">	&#125; catch (HibernateException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="参数绑定形式"><a href="#参数绑定形式" class="headerlink" title="参数绑定形式"></a>参数绑定形式</h3><h4 id="按参数位置绑定"><a href="#按参数位置绑定" class="headerlink" title="按参数位置绑定"></a>按参数位置绑定</h4><p>例：Query query = session.createQuery（”from Emp where job=? and salary&gt;?”）；<br>                query.setString(0,job);–第一个参数位置为零<br>                query.setDouble(1,salary);</p>
<h4 id="按参数名称绑定"><a href="#按参数名称绑定" class="headerlink" title="按参数名称绑定"></a>按参数名称绑定</h4><p> 例：Query query = session.createQuery(“from Emp where job=:empJob and salary&gt;:empSalary”);<br>                query.setString(“empJob”,empJob);<br>                query.setDouble(“empSalary”,empSalary);</p>
<p>//注意这里的所有属性包括表名都是.hbm.xml文件映射来的持久化类属性</p>
<h4 id="绑定各种类型的参数"><a href="#绑定各种类型的参数" class="headerlink" title="绑定各种类型的参数"></a>绑定各种类型的参数</h4><p> setBoolean():绑定类型为Boolean的参数<br>            setByte():绑定类型为Byte的参数<br>            setDouble():绑定类型为Double的参数<br>            setDate():绑定类型为Date的参数<br>            setString():绑定类型为String的参数<br>            以上方法都有两种重载方式 如：<br>                setString(int position,String val);–按位置绑定参数<br>                setString(String name,String val);–按名称绑定参数</p>
<h4 id="setParameter-方法：绑定任意类型参数"><a href="#setParameter-方法：绑定任意类型参数" class="headerlink" title="setParameter()方法：绑定任意类型参数"></a>setParameter()方法：绑定任意类型参数</h4><p>该方法使用object类型作为HQL参数的类型，当不便指定参数的类型师，使用setParameter()方法</p>
<h4 id="setProperties-直接放入一个对象-赛高"><a href="#setProperties-直接放入一个对象-赛高" class="headerlink" title="setProperties(直接放入一个对象)赛高"></a>setProperties(直接放入一个对象)赛高</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;User&gt; findByCoditions(User param) &#123;</span><br><span class="line">		Query query = this.currentSession().createQuery(<span class="string">"from User where name=:name and telephone=:telephone"</span>);</span><br><span class="line">		query.setProperties(param); // 赛高</span><br><span class="line">		<span class="built_in">return</span> query.list();</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    -----</span><br><span class="line">    </span><br><span class="line">    public List&lt;User&gt; findAllbyCondinitions(User param) &#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">		try &#123;</span><br><span class="line">			UserDao userDao = new UserDao();</span><br><span class="line">			tx = userDao.currentSession().beginTransaction();</span><br><span class="line">			list = userDao.findByCoditions(param);</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (HibernateException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> list;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>//前提是字段一致，并且不为空（动态hql除外）</p>
<h4 id="使用uniqueResult-方法获取唯一结果"><a href="#使用uniqueResult-方法获取唯一结果" class="headerlink" title="使用uniqueResult()方法获取唯一结果"></a>使用uniqueResult()方法获取唯一结果</h4><p>当查询结果不唯一时，不能使用query.uniqueResult()方法，否则会报错</p>
<h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><h4 id="LIST"><a href="#LIST" class="headerlink" title="LIST()"></a>LIST()</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;User&gt; <span class="function"><span class="title">findAllUser</span></span>() &#123;</span><br><span class="line">	<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User"</span>).list();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--service使用list集合</span><br><span class="line"></span><br><span class="line">public List&lt;User&gt; <span class="function"><span class="title">findAllUser</span></span>() &#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">		try &#123;</span><br><span class="line">			UserDao userDao = new UserDao();</span><br><span class="line">			tx = userDao.currentSession().beginTransaction();</span><br><span class="line">			list = userDao.findAllUser();</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (HibernateException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> list;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ITERATE"><a href="#ITERATE" class="headerlink" title="ITERATE()"></a>ITERATE()</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public Iterator&lt;User&gt; <span class="function"><span class="title">findAllUser_iterate</span></span>() &#123;</span><br><span class="line">		<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User"</span>).iterate();</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">--service使用Iterator&lt;&gt;</span><br><span class="line"></span><br><span class="line">	public Iterator&lt;User&gt; <span class="function"><span class="title">findAllUser_Iterator</span></span>() &#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		Iterator&lt;User&gt; list = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			UserDao userDao = new UserDao();</span><br><span class="line">			tx = userDao.currentSession().beginTransaction();</span><br><span class="line">			list = userDao.findAllUser_iterate();</span><br><span class="line">			User u = new User();</span><br><span class="line">			<span class="keyword">while</span> (list.hasNext()) &#123;</span><br><span class="line">				u = list.next();</span><br><span class="line">				System.out.println(u.getName() + <span class="string">"艸"</span>);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (HibernateException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> list;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>//ITERATE()要比LIST()效率好，但是ITERATE必须在service层输出或赋值，它是先查主键id，再去查找数据</p>
<h4 id="动态查询"><a href="#动态查询" class="headerlink" title="动态查询"></a>动态查询</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;User&gt; findByCoditions(String hql, User param) &#123;</span><br><span class="line">		Query query = this.currentSession().createQuery(hql);</span><br><span class="line">		query.setProperties(param); // 赛高</span><br><span class="line">		<span class="built_in">return</span> query.list();</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    ---主要的service</span><br><span class="line">    public List&lt;User&gt; findAllbyCondinitions1(User param) &#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">		try &#123;</span><br><span class="line">			UserDao userDao = new UserDao();</span><br><span class="line">			tx = userDao.currentSession().beginTransaction();</span><br><span class="line">			StringBuilder hql = new StringBuilder(<span class="string">"from User where 1=1"</span>);</span><br><span class="line">			<span class="keyword">if</span> (param.getName() != null &amp;&amp; param.getName().length() != 0) &#123;</span><br><span class="line">				hql.append(<span class="string">" and name=:name"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (param.getTelephone() != null &amp;&amp; param.getTelephone().length() != 0) &#123;</span><br><span class="line">				hql.append(<span class="string">" and telephone=:telephone"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			list = userDao.findByCoditions(hql.toString(), param);</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (HibernateException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> list;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="动态查询-map参数"><a href="#动态查询-map参数" class="headerlink" title="动态查询 map参数"></a>动态查询 map参数</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;User&gt; findByCoditions(String hql, Map&lt;String, Object&gt; param) &#123;</span><br><span class="line">		Query query = this.currentSession().createQuery(hql);</span><br><span class="line">		query.setProperties(param); // 赛高</span><br><span class="line">		<span class="built_in">return</span> query.list();</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    ---service</span><br><span class="line">    </span><br><span class="line">    public List&lt;User&gt; findAllbyCondinitions2(Map&lt;String, Object&gt; param) &#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		List&lt;User&gt; list = new ArrayList&lt;User&gt;();</span><br><span class="line">		try &#123;</span><br><span class="line">			UserDao userDao = new UserDao();</span><br><span class="line">			tx = userDao.currentSession().beginTransaction();</span><br><span class="line">			StringBuilder hql = new StringBuilder(<span class="string">"from User where 1=1"</span>);</span><br><span class="line">			<span class="keyword">if</span> (param.get(<span class="string">"name"</span>) != null &amp; ((String) param.get(<span class="string">"name"</span>)).length() != 0) &#123;</span><br><span class="line">				hql.append(<span class="string">" and name=:name"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (param.get(<span class="string">"telephone"</span>) != null &amp; ((String) param.get(<span class="string">"telephone"</span>)).length() != 0) &#123;</span><br><span class="line">				hql.append(<span class="string">" and telephone=:telephone"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			list = userDao.findByCoditions(hql.toString(), param);</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125; catch (HibernateException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> list;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h4><p>主要的是setFirstResult()与setMaxResults()<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;User&gt; findByPage(int pageNo, int pageSize) &#123;</span><br><span class="line">		<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User order by id"</span>).setFirstResult((pageNo - 1) * pageSize)</span><br><span class="line">				.setMaxResults(pageSize).list();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="获取前几个数据"><a href="#获取前几个数据" class="headerlink" title="获取前几个数据"></a>获取前几个数据</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;User&gt; findByOrder(int topSize) &#123;</span><br><span class="line">		<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"from User order by id"</span>).setMaxResults(topSize).list();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="投影查询-只获取单个"><a href="#投影查询-只获取单个" class="headerlink" title="投影查询(只获取单个)"></a>投影查询(只获取单个)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public List <span class="function"><span class="title">findByProjection</span></span>() &#123;</span><br><span class="line">		<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"select name from User"</span>).list();</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    ---service</span><br><span class="line">    </span><br><span class="line">    public List&lt;Object&gt; <span class="function"><span class="title">findAllbyCondinitions5</span></span>() &#123;</span><br><span class="line">		Transaction tx = null;</span><br><span class="line">		List&lt;Object&gt; list = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			UserDao userDao = new UserDao();</span><br><span class="line">			tx = userDao.currentSession().beginTransaction();</span><br><span class="line">			list = userDao.findByProjection();</span><br><span class="line">		&#125; catch (HibernateException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">if</span> (tx != null) &#123;</span><br><span class="line">				tx.rollback();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> list;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="投影查询-多个字段"><a href="#投影查询-多个字段" class="headerlink" title="投影查询(多个字段)"></a>投影查询(多个字段)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;Object[]&gt; <span class="function"><span class="title">findByProjection2</span></span>() &#123;</span><br><span class="line">		<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"select name,telephone from User"</span>).list();</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    ---<span class="built_in">test</span></span><br><span class="line">    </span><br><span class="line">    public void <span class="function"><span class="title">findPro2</span></span>() &#123;</span><br><span class="line">		List&lt;Object[]&gt; list = new UserBiz().findAllbyCondinitions6();</span><br><span class="line">		<span class="keyword">for</span> (Object[] object : list) &#123;</span><br><span class="line">			System.out.println(object[0] + <span class="string">"\t"</span> + object[1]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="将查询结果通过构造函数封装为对象"><a href="#将查询结果通过构造函数封装为对象" class="headerlink" title="将查询结果通过构造函数封装为对象"></a>将查询结果通过构造函数封装为对象</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;User&gt; <span class="function"><span class="title">findByProjection3</span></span>() &#123;</span><br><span class="line">		<span class="built_in">return</span> this.currentSession().createQuery(<span class="string">"select new User(name,telephone) from User"</span>).list();</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    --构造方法</span><br><span class="line">    </span><br><span class="line">    public User(String name,String telephone)&#123;</span><br><span class="line">		this.name=name;</span><br><span class="line">		this.telephone=telephone;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/08/HQL实用技术/" data-id="cjrabl6mq0005vkdqcf5bxsz6" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-面试26问" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/08/面试26问/" class="article-date">
  <time datetime="2018-11-08T00:05:15.000Z" itemprop="datePublished">2018-11-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/08/面试26问/">面试26问</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="请你自我介绍一下自己好吗"><a href="#请你自我介绍一下自己好吗" class="headerlink" title="请你自我介绍一下自己好吗"></a>请你自我介绍一下自己好吗</h4><p>一般人回答这个问题过于平常，只说姓名、年龄、爱好、工作经验，这些在简历上都有。其实，企业最希望知道的是求职者能否胜任工作，包括：最强的技能、最深入研究的知识领域、个性中最积极的部分、做过的最成功的事，主要的成就等，这些都可以和学习无关，也可以和学习有关，但要突出积极的个性和做事的能力，说得合情合理企业才会相信。企业很重视一个人的礼貌，求职者要尊重考官，在回答每个问题之后都说一句“谢谢”，企业喜欢有礼貌的求职者。</p>
<h4 id="你觉得你个性上最大的优点是什么"><a href="#你觉得你个性上最大的优点是什么" class="headerlink" title="你觉得你个性上最大的优点是什么"></a>你觉得你个性上最大的优点是什么</h4><p>沉着冷静、条理清楚、立场坚定、顽强向上、乐于助人和关心他人、适应能力和幽默感、乐观和友爱。我在xxx经过一到两年的项目实战，加上实习工作，使我适合这份工作</p>
<h4 id="说说你最大的缺点"><a href="#说说你最大的缺点" class="headerlink" title="说说你最大的缺点"></a>说说你最大的缺点</h4><p>这个问题企业问的概率很大，通常不希望听到直接回答的缺点是什么等，如果求职者说自己小心眼、爱忌妒人、非常懒、脾气大、工作效率低，企业肯定不会录用你。绝对不要自作聪明地回答“我最大的缺点是过于追求完美”，有的人以为这样回答会显得自己比较出色，但事实上，他已经岌岌可危了。企业喜欢求职者从自己的优点说起，中间加一些小缺点，最后再把问题转回到优点上，突出优点的部分，企业喜欢聪明的求职者</p>
<h4 id="你对薪资的要求"><a href="#你对薪资的要求" class="headerlink" title="你对薪资的要求"></a>你对薪资的要求</h4><p>如果你对薪酬的要求太低，那显然贬低自己的能力；如果你对薪酬的要求太高，那又会显得你分量过重，公司受用不起。一些雇主通常都事先对求聘的职位定下开支预算，因而他们第一次提出的价钱往往是他们所能给予的最高价钱，他们问你只不过想证实一下这笔钱是否足以引起你对该工作的兴趣</p>
<p>回答样本一：我对工资没有硬性要求，我相信贵公司在处理我的问题上会友善合理。我注重的是找对工作机会，所以只要条件公平，我则不会计较太多。</p>
<p>回答样本二：我受过系统的软件编程的训练，不需要进行大量的培训，而且我本人也对编程特别感兴趣。因此，我希望公司能根据我的情况和市场标准的水平，给我合理的薪水。</p>
<h4 id="你对加班的看法"><a href="#你对加班的看法" class="headerlink" title="你对加班的看法"></a>你对加班的看法</h4><p>实际上好多公司问这个问题，并不证明一定要加班，只是想测试你是否愿意为公司奉献</p>
<p>回答样本：如果工作需要我会义不容辞加班，我现在单身，没有任何家庭负担，可以全身心的投入工作。但同时我也会提高工作效率，减少不必要的加班</p>
<h4 id="如果通过这次面试我们录用了你，但工作一段时间却发现你根本不适合这个职位，你怎么办"><a href="#如果通过这次面试我们录用了你，但工作一段时间却发现你根本不适合这个职位，你怎么办" class="headerlink" title="如果通过这次面试我们录用了你，但工作一段时间却发现你根本不适合这个职位，你怎么办"></a>如果通过这次面试我们录用了你，但工作一段时间却发现你根本不适合这个职位，你怎么办</h4><p>一段时间发现工作不适合我，有两种情况：①如果你确实热爱这个职业，那你就要不断学习，虚心向领导和同事学习业务知识和处事经验，了解这个职业的精神内涵和职业要求，力争减少差距；②你觉得这个职业可有可无，那还是趁早换个职业，去发现适合你的，你热爱的职业，那样你的发展前途也会大点，对单位和个人都有好处</p>
<h4 id="谈谈你对跳槽的看法"><a href="#谈谈你对跳槽的看法" class="headerlink" title="谈谈你对跳槽的看法"></a>谈谈你对跳槽的看法</h4><p>①正常的“跳槽”能促进人才合理流动，应该支持。②频繁的跳槽对单位和个人双方都不利，应该反对</p>
<h4 id="工作中难以和同事、上司相处，你该怎么办"><a href="#工作中难以和同事、上司相处，你该怎么办" class="headerlink" title="工作中难以和同事、上司相处，你该怎么办"></a>工作中难以和同事、上司相处，你该怎么办</h4><p>①我会服从领导的指挥，配合同事的工作。②我会从自身找原因，仔细分析是不是自己工作做得不好让领导不满意，同事看不惯。还要看看是不是为人处世方面做得不好，如果是这样的话我会努力改正。③如果我找不到原因，我会找机会跟他们沟通，请他们指出我的不足，有问题就及时改正。④作为优秀的员工，应该时刻以大局为重，即使在一段时间内，领导和同事对我不理解，我也会做好本职工作，虚心向他们学习，我相信，他们会看见我在努力，总有一天会对我微笑的</p>
<h4 id="你对于我们公司了解多少"><a href="#你对于我们公司了解多少" class="headerlink" title="你对于我们公司了解多少"></a>你对于我们公司了解多少</h4><p>在去公司面试前上网查一下该公司主营业务。如回答：贵公司有意改变策略，加强与国外大厂的OEM合作，自有品牌的部分则透过海外经销商</p>
<h4 id="最能概括你自己的三个词是什么"><a href="#最能概括你自己的三个词是什么" class="headerlink" title="最能概括你自己的三个词是什么"></a>最能概括你自己的三个词是什么</h4><p>适应能力强，有责任心和做事有始终，结合具体例子向主考官解释</p>
<h4 id="你的业余爱好是什么"><a href="#你的业余爱好是什么" class="headerlink" title="你的业余爱好是什么"></a>你的业余爱好是什么</h4><p>找一些富于团体合作精神的，这里有一个真实的故事：有人被否决掉，因为他的爱好是深海潜水。主考官说：因为这是一项单人活动，我不敢肯定他能否适应团体工作</p>
<h4 id="作为被面试者给我打一下分"><a href="#作为被面试者给我打一下分" class="headerlink" title="作为被面试者给我打一下分"></a>作为被面试者给我打一下分</h4><p>试着列出四个优点和一个非常非常非常小的缺点（可以抱怨一下设施，没有明确责任人的缺点是不会有人介意的）</p>
<h4 id="你为什么要离开原来的公司"><a href="#你为什么要离开原来的公司" class="headerlink" title="你为什么要离开原来的公司"></a>你为什么要离开原来的公司</h4><p>①回答这个问题时一定要小心，就算在前一个工作受到再大的委屈，对公司有多少的怨言，都千万不要表现出来，尤其要避免对公司本身主管的批评，避免面试官的负面情绪及印象。建议此时最好的回答方式是将问题归咎在自己身上，例如觉得工作没有学习发展的空间，自己想在面试工作的相关产业中多加学习，或是前一份工作与自己的生涯规划不合等等，回答的答案最好是积极正面的。②我希望能获得一份更好的工作，如果机会来临，我会抓住。我觉得目前的工作，已经达到顶峰，即没有升迁机会</p>
<h4 id="你欣赏哪种性格的人"><a href="#你欣赏哪种性格的人" class="headerlink" title="你欣赏哪种性格的人"></a>你欣赏哪种性格的人</h4><p>诚实、不死板而且容易相处的人、有“实际行动”的人</p>
<h4 id="你通常如何对待别人的批评"><a href="#你通常如何对待别人的批评" class="headerlink" title="你通常如何对待别人的批评"></a>你通常如何对待别人的批评</h4><p>①沈默是金，不必说什么，否则情况更糟，不过我会接受建设性的批评。②我会等大家冷静下来再讨论</p>
<h4 id="怎样对待自己的失败"><a href="#怎样对待自己的失败" class="headerlink" title="怎样对待自己的失败"></a>怎样对待自己的失败</h4><p>我们大家生来都不是十全十美的，我相信我有第二个机会改正我的错误</p>
<h4 id="你为什么愿意到我们公司来工作"><a href="#你为什么愿意到我们公司来工作" class="headerlink" title="你为什么愿意到我们公司来工作"></a>你为什么愿意到我们公司来工作</h4><p>对于这个问题，你要格外小心，如果你已经对该单位作了研究，你可以回答一些详细的原因，像“公司本身的高技术开发环境很吸引我。”、“我同公司出生在同样的时代，我希望能够进入一家与我共同成长的公司。”、“你们公司一直都稳定发展，在近几年来在市场上很有竞争力。”、“我认为贵公司能够给我提供一个与众不同的发展道路。”这都显示出你已经做了一些调查，也说明你对自己的未来有了较为具体的远景规划</p>
<h4 id="对这项工作，你有哪些可预见的困难"><a href="#对这项工作，你有哪些可预见的困难" class="headerlink" title="对这项工作，你有哪些可预见的困难"></a>对这项工作，你有哪些可预见的困难</h4><p>①不宜直接说出具体的困难，否则可能令对方怀疑应聘者不行。②可以尝试迂回战术，说出应聘者对困难所持有的态度——工作中出现一些困难是正常的，也是难免的，但是只要有坚忍不拔的毅力、良好的合作精神以及事前周密而充分的准备，任何困难都是可以克服</p>
<h4 id="如果录用了你，你将怎样开展工作"><a href="#如果录用了你，你将怎样开展工作" class="headerlink" title="如果录用了你，你将怎样开展工作"></a>如果录用了你，你将怎样开展工作</h4><p> ①如果应聘者对于应聘的职位缺乏足够的了解，最好不要直接说出自己开展工作的具体办法。②可以尝试采用迂回战术来回答，如“首先听取领导的指示和要求，然后就有关情况进行了解和熟悉，接下来制定一份近期的工作计划并报领导批准，最后根据计划开展工作。”。<br>分析：这个问题的主要目的也是了解应聘者的工作能力和计划性、条理性，而且重点想要知道细节。如果向思路中所讲的迂回战术，面试官会认为回避问题，如果引导了几次仍然是回避的话，此人绝对不会录用了</p>
<h4 id="你希望与什么样的上级共事"><a href="#你希望与什么样的上级共事" class="headerlink" title="你希望与什么样的上级共事"></a>你希望与什么样的上级共事</h4><p>①通过应聘者对上级的“希望”可以判断出应聘者对自我要求的意识，这既上一个陷阱，又是一次机会。②最好回避对上级具体的希望，多谈对自己的要求。③如“做为刚步入社会的新人，我应该多要求自己尽快熟悉环境、适应环境，而不应该对环境提出什么要求，只要能发挥我的专长就可以了。<br>分析：这个问题比较好的回答是，希望我的上级能够在工作中对我多指导，对我工作中的错误能够立即指出。总之，从上级指导这个方面谈，不会有大的纰漏</p>
<h4 id="与上级意见不一时，你将怎么办"><a href="#与上级意见不一时，你将怎么办" class="headerlink" title="与上级意见不一时，你将怎么办"></a>与上级意见不一时，你将怎么办</h4><p>①一般可以这样回答“我会给上级以必要的解释和提醒，在这种情况下，我会服从上级的意见。”②如果面试你的是总经理，而你所应聘的职位另有一位经理，且这位经理当时不在场，可以这样回答：“对于非原则性问题，我会服从上级的意见，对于涉及公司利益的重大问题，我希望能向更高层领导反映</p>
<h4 id="谈谈如何适应办公室工作的新环境"><a href="#谈谈如何适应办公室工作的新环境" class="headerlink" title="谈谈如何适应办公室工作的新环境"></a>谈谈如何适应办公室工作的新环境</h4><p>①办公室里每个人有各自的岗位与职责，不得擅离岗位。②根据领导指示和工作安排，制定工作计划，提前预备，并按计划完成。③多请示并及时汇报，遇到不明白的要虚心请教。④抓间隙时间，多学习，努力提高自己的政治素质和业务水平</p>
<h4 id="除了本公司外，还应聘了哪些公司"><a href="#除了本公司外，还应聘了哪些公司" class="headerlink" title="除了本公司外，还应聘了哪些公司"></a>除了本公司外，还应聘了哪些公司</h4><p>很奇怪，这是相当多公司会问的问题，其用意是要概略知道应徵者的求职志向，所以这并非绝对是负面答案，就算不便说出公司名称，也应回答“销售同种产品的公司”，如果应聘的其他公司是不同业界，容易让人产生无法信任的感觉</p>
<h4 id="你还有什么问题要问吗"><a href="#你还有什么问题要问吗" class="headerlink" title="你还有什么问题要问吗"></a>你还有什么问题要问吗</h4><p>企业的这个问题看上去可有可无，其实很关键，企业不喜欢说“没问题”的人，因为其很注重员工的个性和创新能力。企业不喜欢求职者问个人福利之类的问题，如果有人这样问：贵公司对新入公司的员工有没有什么培训项目，我可以参加吗？或者说贵公司的晋升机制是什么样的？企业将很欢迎，因为体现出你对学习的热情和对公司的忠诚度以及你的上进心</p>
<h4 id="如果你被录用，何时可以到职"><a href="#如果你被录用，何时可以到职" class="headerlink" title="如果你被录用，何时可以到职"></a>如果你被录用，何时可以到职</h4><p>大多数企业会关心就职时间，最好是回答“如果被录用的话，到职日可按公司规定上班”，但如果还未辞去上一个工作、上班时间又太近，似乎有些强人所难，因为交接至少要一个月的时间，应进一步说明原因，录取公司应该会通融的</p>
<h4 id="为什么选择我们公司"><a href="#为什么选择我们公司" class="headerlink" title="为什么选择我们公司"></a>为什么选择我们公司</h4><p>曾经在报章杂志看过关于贵公司的报道，与自己所追求的理念有志一同。而贵公司在业界的成绩也是有目共睹的，而且对员工的教育训练、升迁等也都很有制度</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://fankekeke.club/2018/11/08/面试26问/" data-id="cjrabl6rv004avkdq3vmuw94z" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分享/">分享</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/4/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/6/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java工具与中间件/">Java工具与中间件</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Oracle/">Oracle</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SSH/">SSH</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SSM/">SSM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringBoot/">SpringBoot</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringData/">SpringData</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/消息队列/">消息队列</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/面试题/">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/API/">API</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分享/">分享</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/导航/">导航</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/API/" style="font-size: 10px;">API</a> <a href="/tags/分享/" style="font-size: 20px;">分享</a> <a href="/tags/导航/" style="font-size: 10px;">导航</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/01/21/Rabbit交换器/">Rabbit交换器</a>
          </li>
        
          <li>
            <a href="/2019/01/16/监控SpringBoot健康状况/">监控SpringBoot健康状况</a>
          </li>
        
          <li>
            <a href="/2019/01/14/Java获取当前计算机信息/">Java获取当前计算机信息</a>
          </li>
        
          <li>
            <a href="/2019/01/14/三网短信验证码API/">三网短信验证码API</a>
          </li>
        
          <li>
            <a href="/2019/01/11/Quartz/">Quartz</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 樊可<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>